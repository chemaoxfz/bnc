
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../examples/usage_v0_1_0/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>API - Binding and Catalysis Networks (BCN) Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#welcome-to-binding-and-catalysis-networks-bcn-docs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Binding and Catalysis Networks (BCN) Docs" class="md-header__button md-logo" aria-label="Binding and Catalysis Networks (BCN) Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Binding and Catalysis Networks (BCN) Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Tutorial

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../examples/usage_v0_1_0/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Binding and Catalysis Networks (BCN) Docs" class="md-nav__button md-logo" aria-label="Binding and Catalysis Networks (BCN) Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Binding and Catalysis Networks (BCN) Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#project-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Project overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Project overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#binding-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Binding Networks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network" class="md-nav__link">
    <span class="md-ellipsis">
      binding_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network" class="md-nav__link">
    <span class="md-ellipsis">
      binding_network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binding_network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.l_from_n" class="md-nav__link">
    <span class="md-ellipsis">
      l_from_n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_activity_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_activity_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_sym" class="md-nav__link">
    <span class="md-ellipsis">
      logder_sym
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_sym_activity" class="md-nav__link">
    <span class="md-ellipsis">
      logder_sym_activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_tk2x_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_tk2x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_tk2x_x_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_tk2x_x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_tk_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_tk_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_x_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_xak_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_xak_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.sampling_over_activity_regime_hull" class="md-nav__link">
    <span class="md-ellipsis">
      sampling_over_activity_regime_hull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.sampling_over_vertex_hull" class="md-nav__link">
    <span class="md-ellipsis">
      sampling_over_vertex_hull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.t2x_sym" class="md-nav__link">
    <span class="md-ellipsis">
      t2x_sym
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.tk2x_num" class="md-nav__link">
    <span class="md-ellipsis">
      tk2x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.vertex_constrained_construct" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_constrained_construct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.vertex_construct" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_construct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.vertex_construct_direct" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_construct_direct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.vertex_list_feasibility_test" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_list_feasibility_test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.x2tk_num" class="md-nav__link">
    <span class="md-ellipsis">
      x2tk_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.xak2x_num" class="md-nav__link">
    <span class="md-ellipsis">
      xak2x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.xc2xak_sym" class="md-nav__link">
    <span class="md-ellipsis">
      xc2xak_sym
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_dom_regime" class="md-nav__link">
    <span class="md-ellipsis">
      rop_dom_regime
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rop_dom_regime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_dom_regime.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_dom_regime.hull_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      hull_sampling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_ld_regime" class="md-nav__link">
    <span class="md-ellipsis">
      rop_ld_regime
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rop_ld_regime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_ld_regime.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex" class="md-nav__link">
    <span class="md-ellipsis">
      rop_vertex
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rop_vertex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.__dist_in_hull" class="md-nav__link">
    <span class="md-ellipsis">
      __dist_in_hull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.chart_check" class="md-nav__link">
    <span class="md-ellipsis">
      chart_check
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.j_func" class="md-nav__link">
    <span class="md-ellipsis">
      j_func
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.vertex_feasibility_test" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_feasibility_test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.vertex_hull_of_validity" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_hull_of_validity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.vertex_hull_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_hull_sampling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.vertex_print_validity_condition" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_print_validity_condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalysis-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Catalysis Networks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.catalysis_network" class="md-nav__link">
    <span class="md-ellipsis">
      catalysis_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.catalysis_network.binding_and_catalysis" class="md-nav__link">
    <span class="md-ellipsis">
      binding_and_catalysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binding_and_catalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.catalysis_network.binding_and_catalysis.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.catalysis_network.binding_and_catalysis.dlogxcatdt" class="md-nav__link">
    <span class="md-ellipsis">
      dlogxcatdt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.catalysis_network.catalysis_network" class="md-nav__link">
    <span class="md-ellipsis">
      catalysis_network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="catalysis_network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.catalysis_network.catalysis_network.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/usage_v0_1_0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#project-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Project overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Project overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#binding-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Binding Networks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network" class="md-nav__link">
    <span class="md-ellipsis">
      binding_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network" class="md-nav__link">
    <span class="md-ellipsis">
      binding_network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binding_network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.l_from_n" class="md-nav__link">
    <span class="md-ellipsis">
      l_from_n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_activity_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_activity_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_sym" class="md-nav__link">
    <span class="md-ellipsis">
      logder_sym
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_sym_activity" class="md-nav__link">
    <span class="md-ellipsis">
      logder_sym_activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_tk2x_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_tk2x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_tk2x_x_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_tk2x_x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_tk_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_tk_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_x_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.logder_xak_num" class="md-nav__link">
    <span class="md-ellipsis">
      logder_xak_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.sampling_over_activity_regime_hull" class="md-nav__link">
    <span class="md-ellipsis">
      sampling_over_activity_regime_hull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.sampling_over_vertex_hull" class="md-nav__link">
    <span class="md-ellipsis">
      sampling_over_vertex_hull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.t2x_sym" class="md-nav__link">
    <span class="md-ellipsis">
      t2x_sym
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.tk2x_num" class="md-nav__link">
    <span class="md-ellipsis">
      tk2x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.vertex_constrained_construct" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_constrained_construct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.vertex_construct" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_construct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.vertex_construct_direct" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_construct_direct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.vertex_list_feasibility_test" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_list_feasibility_test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.x2tk_num" class="md-nav__link">
    <span class="md-ellipsis">
      x2tk_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.xak2x_num" class="md-nav__link">
    <span class="md-ellipsis">
      xak2x_num
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.binding_network.xc2xak_sym" class="md-nav__link">
    <span class="md-ellipsis">
      xc2xak_sym
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_dom_regime" class="md-nav__link">
    <span class="md-ellipsis">
      rop_dom_regime
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rop_dom_regime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_dom_regime.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_dom_regime.hull_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      hull_sampling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_ld_regime" class="md-nav__link">
    <span class="md-ellipsis">
      rop_ld_regime
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rop_ld_regime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_ld_regime.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex" class="md-nav__link">
    <span class="md-ellipsis">
      rop_vertex
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rop_vertex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.__dist_in_hull" class="md-nav__link">
    <span class="md-ellipsis">
      __dist_in_hull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.chart_check" class="md-nav__link">
    <span class="md-ellipsis">
      chart_check
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.j_func" class="md-nav__link">
    <span class="md-ellipsis">
      j_func
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.vertex_feasibility_test" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_feasibility_test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.vertex_hull_of_validity" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_hull_of_validity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.vertex_hull_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_hull_sampling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.binding_network.rop_vertex.vertex_print_validity_condition" class="md-nav__link">
    <span class="md-ellipsis">
      vertex_print_validity_condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalysis-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Catalysis Networks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.catalysis_network" class="md-nav__link">
    <span class="md-ellipsis">
      catalysis_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.catalysis_network.binding_and_catalysis" class="md-nav__link">
    <span class="md-ellipsis">
      binding_and_catalysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binding_and_catalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.catalysis_network.binding_and_catalysis.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bcn.catalysis_network.binding_and_catalysis.dlogxcatdt" class="md-nav__link">
    <span class="md-ellipsis">
      dlogxcatdt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bcn.catalysis_network.catalysis_network" class="md-nav__link">
    <span class="md-ellipsis">
      catalysis_network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="catalysis_network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bcn.catalysis_network.catalysis_network.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="welcome-to-binding-and-catalysis-networks-bcn-docs">Welcome to Binding and Catalysis Networks (BCN) Docs</h1>
<h2 id="project-overview">Project overview</h2>
<h3 id="binding-networks">Binding Networks</h3>


<div class="doc doc-object doc-module">



<a id="bcn.binding_network"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="bcn.binding_network.binding_network" class="doc doc-heading">
            <code>binding_network</code>


</h2>


    <div class="doc doc-contents ">








              <details class="quote">
                <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1068"><a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="k">class</span><span class="w"> </span><span class="nc">binding_network</span><span class="p">:</span>
</span><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>               <span class="n">n_mat</span><span class="p">,</span>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>               <span class="n">l_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>               <span class="n">is_atomic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>               <span class="n">x_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>               <span class="n">t_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>               <span class="n">k_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">    Initiate a binding network.</span>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">        n_mat (numpy array): The stoichiometry matrix defining the binding network.</span>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">        is_atomic (bool, optional): Is the binding network atomic or not. Defaults to None.</span>
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">        l_mat (numpy array, optional): The conservation law matrix defining the conserved total quantities.</span>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">            If not given, and is_atomic is True, then it will be computed from n_mat. Defaults to None.</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">        x_sym (list of symbols, optional): An ordered list of symbols for the chemical species, denoting columns of the n_mat and l_mat. Defaults to None.</span>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        t_sym (list of symbols, optional): An ordered list of symbols for the total or conserved quantities, denoting rows of the l_mat. Defaults to None.</span>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">        k_sym (list of symbols, optional): An ordered list of symbols for the binding constants in the dissociation direction, denoting rows of the n_mat. Defaults to None.</span>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="o">=</span><span class="n">is_atomic</span>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="o">=</span><span class="n">n_mat</span>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_mat_sym</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">n_mat</span><span class="p">)</span>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">l_mat</span><span class="p">):</span> <span class="c1">#no input l_mat</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>      <span class="n">l_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_from_n</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">)</span>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>      <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">l_mat</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>    <span class="c1"># if no input symbols for the x,t,k variables then give them default numerically ordered ones.</span>
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">x_sym</span><span class="p">):</span>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>      <span class="n">x_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">t_sym</span><span class="p">):</span>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>      <span class="n">t_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;t:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">))</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">k_sym</span><span class="p">):</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>      <span class="n">k_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;k:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span><span class="p">))</span>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="o">=</span><span class="n">l_mat</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">l_mat_sym</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">l_mat</span><span class="p">)</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="o">=</span><span class="n">x_sym</span>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">t_sym</span><span class="o">=</span><span class="n">t_sym</span>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">k_sym</span><span class="o">=</span><span class="n">k_sym</span>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tk_sym</span><span class="o">=</span><span class="n">t_sym</span><span class="o">+</span><span class="n">k_sym</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">opt_var</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">)</span>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span><span class="p">))</span>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ld_sym_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">activity_regime_constrained_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_constrained_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">l_from_n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_mat</span><span class="p">):</span>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">    If the network is atomic, compute the L matrix from the N matrix.</span>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">        n_mat (numpy array): The stoichiometry matrix defining the binding network.</span>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">            Assumes the columns are ordered so that the atomic species come first.</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">        numpy array: The conservation law or totals matrix.</span>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>    <span class="n">r</span><span class="o">=</span><span class="n">n_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>    <span class="n">d</span><span class="o">=</span><span class="n">n_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">r</span>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>    <span class="n">n1_mat</span><span class="o">=</span><span class="n">n_mat</span><span class="p">[:,:</span><span class="n">d</span><span class="p">]</span>
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>    <span class="n">n2_mat</span><span class="o">=</span><span class="n">n_mat</span><span class="p">[:,</span><span class="o">-</span><span class="n">r</span><span class="p">:]</span>
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>    <span class="n">l2_mat</span><span class="o">=-</span><span class="p">(</span><span class="n">n1_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">n2_mat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>    <span class="n">l_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="n">l2_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>    <span class="k">return</span> <span class="n">l_mat</span>
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logvar</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">    Compute the numerical log derivative of the binding network at points specified by logvar in the specified chart and dominance a_mat.</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">        logvar (ndarray): Array of the points to evaluate the log derivatives at, in base-10 log. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">            In chart &#39;x&#39;, for example, this is logx.</span>
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">        chart (str): Specifying the chart that logvar is specified in. Could be &#39;x&#39;, &#39;xak&#39;, or &#39;tk&#39;.</span>
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">        a_mat (numpy array, optional): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">            Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">            Optional, defaults to l_mat of the binding network.</span>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">        logder (ndarray): Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">            Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">        logx (ndarray): Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">            This is returned since all input variables, regardless of chart, are mapped to the logx chart first.</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">            Returned for convenience.</span>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>    <span class="c1"># first check a_mat makes sense.</span>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1"># no a_mat argument is given</span>
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>      <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>      <span class="k">assert</span> <span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;the shape of L matrix should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="si">}</span><span class="s2"> by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>      <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;all entries of A matrix should be non-negative.&quot;</span>
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>      <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;each row of A matrix should have at least one positive entry.&quot;</span>
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>    <span class="c1"># for different charts, use different functions to evaluate</span>
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>    <span class="n">npts</span><span class="o">=</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>    <span class="k">assert</span> <span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span> <span class="s1">&#39;shape of logvar should be num_points-by-dim_n&#39;</span>
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>    <span class="n">logders</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>    <span class="k">if</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>        <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>      <span class="n">logx</span><span class="o">=</span><span class="n">logvar</span>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>    <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;xak&#39;</span><span class="p">:</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>      <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="p">,</span> <span class="s1">&#39;the binding network is not atomic, cannot use xak chart&#39;</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>      <span class="n">logx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_xak_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>    <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;tk&#39;</span><span class="p">:</span>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>      <span class="n">logx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>        <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_tk_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="k">else</span><span class="p">:</span> 
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;chart that is not one of &quot;x,xak,tk&quot; is not implemented yet&#39;</span><span class="p">)</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="k">return</span> <span class="n">logders</span><span class="p">,</span><span class="n">logx</span>
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">    Compute the numerical log derivative of the binding network at one point in chart x.</span>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">        logx (numpy vector): Vector of concentrations for all the species in log, base-10.</span>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">        a_mat (numpy array): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="sd">            Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">        ndarray: Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">            Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>    <span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">logx</span>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>    <span class="n">t_inv</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>    <span class="n">temp</span><span class="o">=</span><span class="n">a_mat</span><span class="o">*</span><span class="n">x</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>    <span class="n">upper</span><span class="o">=</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">t_inv</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>    <span class="n">logder_inv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">upper</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>      <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">logder_inv</span><span class="p">)</span>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>      <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>      <span class="nb">print</span><span class="p">(</span><span class="n">t_inv</span><span class="p">)</span>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>      <span class="nb">print</span><span class="p">(</span><span class="n">logder_inv</span><span class="p">)</span>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">logder_inv</span><span class="p">)</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_xak_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logxak</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">    Compute the numerical log derivative of dlog(x)/dlog(a_mat * x, k) at a point specified by log(xa, k), where xa is the concentration of atomic species, and k is the binding constants. log is base 10.</span>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">        Assumes the network is atomic, and n_mat, a_mat have atomic species coming first.</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">        logxak (numpy vector): Vector numerical value for atomic species concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).</span>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">            log is base 10.</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">        a_mat (numpy array): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">            Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">        logder (ndarray): Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">            Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">        logx (ndarray): Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">            This is returned since all input variables, regardless of chart, are mapped to the logx chart first.</span>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">            Returned for convenience.</span>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>    <span class="c1">## commented out are old code that directly calculate logx, now we use stored map.</span>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>    <span class="c1"># d=self.dim_d</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>    <span class="c1"># logxa=logxak[:d]</span>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>    <span class="c1"># logk=logxak[d:]</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>    <span class="c1"># temp1=(a_mat.T).dot(logxa)</span>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>    <span class="c1"># n2_mat=self.n_mat[:,d:]</span>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>    <span class="c1"># temp2=np.linalg.inv(n2_mat).dot(logk)</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>    <span class="c1"># logx=temp1 + np.pad(temp2,(d,0),mode=&#39;constant&#39;,constant_values=(0,0))</span>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>    <span class="n">logx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xak2x_num</span><span class="p">(</span><span class="n">logxak</span><span class="p">)</span>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">),</span><span class="n">logx</span>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>
</span><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_tk_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logtk</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">    Compute the numerical log derivative of dlog(x)/dlog(a_mat @ x, k) at a point specified by log(t, k), where t = a_mat @ x is the concentration of atomic species, and k is the binding constants. log is base 10.</span>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">        logtk (numpy vector): Vector numerical value for total concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).</span>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">            log is base 10.</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">        a_mat (numpy array): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">            Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">        logder (ndarray): Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">            Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">        logx (ndarray): Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">            This is returned since all input variables, regardless of chart, are mapped to the logx chart first.</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">            Returned for convenience.</span>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>    <span class="n">logx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk2x_num</span><span class="p">(</span><span class="n">logtk</span><span class="p">,</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">),</span><span class="n">logx</span>
</span><span id="__span-0-1264"><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
</span><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_activity_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">logx_array</span><span class="p">,</span><span class="n">ld_mat_array</span><span class="p">):</span>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1267"><a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">    Given a logder matrix, compute the logder of b^T x.</span>
</span><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">        b_vec (numpy vector): Vector indicating which species are included in the catalytic activity. Shape is (dim_n,).</span>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">            All entries are non-negative, with at least one nonzero.</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">        logx_array (ndarray): Array of logx-vector indicating the point at which the logder is evaluated. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1273"><a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">            log is base 10.</span>
</span><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">        ld_mat_array (ndarray): Array of n x n matrix for dlogx/dlog(t, k) at point x on the manifold. Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">        ndarray: Array of vectors for dlog(b^T x)/dlog(t, k). Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1279"><a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">b_vec</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;all entries of b_vec should be non-negative.&quot;</span>
</span><span id="__span-0-1280"><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;there should be at least one nonzero entry in b_vec.&quot;</span>
</span><span id="__span-0-1281"><a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>    <span class="n">x_array</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">logx_array</span> <span class="c1"># shape (n_points,dim_n)</span>
</span><span id="__span-0-1282"><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>    <span class="n">bx_array</span><span class="o">=</span><span class="n">x_array</span><span class="o">*</span><span class="n">b_vec</span> <span class="c1"># each row element-wise product with b_vec</span>
</span><span id="__span-0-1283"><a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>    <span class="c1"># so bx_array has shape (n_points,dim_n)</span>
</span><span id="__span-0-1284"><a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>    <span class="n">coeff</span><span class="o">=</span><span class="p">(</span><span class="n">bx_array</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">bx_array</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span> <span class="c1"># shape (n_points,dim_n)</span>
</span><span id="__span-0-1285"><a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>    <span class="n">npts</span><span class="o">=</span><span class="n">logx_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1286"><a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>
</span><span id="__span-0-1287"><a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>    <span class="c1"># One implementation is iterate and sum, this is slow (not really?).</span>
</span><span id="__span-0-1288"><a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>    <span class="n">ld_activity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">npts</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-1289"><a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1290"><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>      <span class="n">ld_activity</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">coeff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ld_mat_array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-0-1291"><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
</span><span id="__span-0-1292"><a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>    <span class="c1"># Another implementation is directly writing out the product</span>
</span><span id="__span-0-1293"><a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>    <span class="c1"># coeff_temp=np.repeat(coeff[:,:,np.newaxis],self.dim_n,axis=2)</span>
</span><span id="__span-0-1294"><a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>    <span class="c1"># ld_activity=(ld_mat_array*coeff_temp).sum(-1)</span>
</span><span id="__span-0-1295"><a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>
</span><span id="__span-0-1296"><a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>    <span class="c1"># Yet another way is to use einsum. Will do these if speed is a problem.</span>
</span><span id="__span-0-1297"><a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
</span><span id="__span-0-1298"><a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>    <span class="k">return</span> <span class="n">ld_activity</span>
</span><span id="__span-0-1299"><a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>
</span><span id="__span-0-1300"><a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">x2tk_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logx</span><span class="p">):</span>
</span><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">    Compute the (logt, logk) value given logx.</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">        logx (numpy vector): Vector numerical value for total variables that define the x point.</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>
</span><span id="__span-0-1307"><a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1308"><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">        tuple: A tuple containing two numpy vectors:</span>
</span><span id="__span-0-1309"><a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">            - logt: The numerical value of total concentration at this point. log is base 10.</span>
</span><span id="__span-0-1310"><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">            - logk: The numerical value of binding constants at this point. log is base 10.</span>
</span><span id="__span-0-1311"><a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1312"><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>    <span class="n">logt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logx</span><span class="p">))</span>
</span><span id="__span-0-1313"><a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>    <span class="n">logk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">logx</span><span class="p">)</span>
</span><span id="__span-0-1314"><a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>    <span class="k">return</span> <span class="n">logt</span><span class="p">,</span><span class="n">logk</span>
</span><span id="__span-0-1315"><a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>
</span><span id="__span-0-1316"><a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">xak2x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logxak</span><span class="p">):</span>
</span><span id="__span-0-1317"><a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1318"><a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">    Compute the logx value given logxak = (logxa, logk).</span>
</span><span id="__span-0-1319"><a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
</span><span id="__span-0-1320"><a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1321"><a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">        logxak (numpy vector): Vector numerical value for atomic species concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).</span>
</span><span id="__span-0-1322"><a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">            log is base 10.</span>
</span><span id="__span-0-1323"><a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
</span><span id="__span-0-1324"><a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1325"><a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">        numpy vector: The numerical value of logx at this point.</span>
</span><span id="__span-0-1326"><a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1327"><a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">xak2x_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xak2x_map</span>
</span><span id="__span-0-1328"><a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-1329"><a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">calc_xak2x_map</span><span class="p">()</span> <span class="c1"># if doesn&#39;t exist, calculate it</span>
</span><span id="__span-0-1330"><a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>      <span class="n">xak2x_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xak2x_map</span>
</span><span id="__span-0-1331"><a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>    <span class="k">return</span> <span class="n">xak2x_map</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">logxak</span><span class="p">)</span>
</span><span id="__span-0-1332"><a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
</span><span id="__span-0-1333"><a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">calc_xak2x_map</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-1334"><a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>    <span class="c1"># Defines the matrix (linear map) that takes log(xa,k) to log(x)</span>
</span><span id="__span-0-1335"><a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>    <span class="c1"># and stores it in self.xak2x_map</span>
</span><span id="__span-0-1336"><a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>    <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span>
</span><span id="__span-0-1337"><a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>    <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span>
</span><span id="__span-0-1338"><a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>    <span class="n">l2_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="p">[:,</span><span class="n">d</span><span class="p">:]</span>
</span><span id="__span-0-1339"><a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>    <span class="n">n2_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">[:,</span><span class="n">d</span><span class="p">:]</span>
</span><span id="__span-0-1340"><a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>    <span class="n">upper</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">d</span><span class="p">,</span><span class="n">r</span><span class="p">))),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1341"><a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>    <span class="n">lower</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">l2_mat</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">n2_mat</span><span class="p">)),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1342"><a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>    <span class="n">temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">upper</span><span class="p">,</span><span class="n">lower</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1343"><a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">xak2x_map</span><span class="o">=</span><span class="n">temp</span>
</span><span id="__span-0-1344"><a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>
</span><span id="__span-0-1345"><a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">tk2x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logtk</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1346"><a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1347"><a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">    Compute the logx value by numerical integration along the equilibrium manifold using log derivatives. The point on the manifold defined by logtk = (logt, logk) is the same as that defined by logx.</span>
</span><span id="__span-0-1348"><a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>
</span><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="sd">        logtk (numpy vector): Vector numerical value for total variables (in first dim_d entries) and the binding reaction constants (in last dim_r entries) that define the point. </span>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a><span class="sd">            p_(logx) = p_(logt, logk). Shape is (dim_n,). log is base 10.</span>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><span class="sd">        a_mat (numpy array): The matrix defining the total variables t = a_mat @ x that the log derivatives are taken with respect to.</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="sd">            Default should be specified to be self.l_mat.</span>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">        numpy vector: The numerical value of x at this point. log is base 10.</span>
</span><span id="__span-0-1357"><a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>    <span class="c1"># the initial point is always x=1, (t,k) = (A*1, 1)</span>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>    <span class="c1"># or, in log, logx=0, (logt,logk) = (log(A*1),0)</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>    <span class="n">logt0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a_mat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>    <span class="n">logk0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span><span class="p">)</span>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>    <span class="n">y0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">logt0</span><span class="p">,</span><span class="n">logk0</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>    <span class="n">y1</span><span class="o">=</span><span class="n">logtk</span>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>    <span class="n">logx0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">)</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>    <span class="c1"># The time is pseudo time, parameterizing trajectory from y0 to y1,</span>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>    <span class="c1"># where y0=(logt0,logk0) = (log(A*1),0), and y1=(logt,logk) the input.</span>
</span><span id="__span-0-1369"><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>    <span class="c1"># So a point on the trajectory is gamma(tau) = tau*(y1-y0)+y0, 0&lt;=tau&lt;=1.</span>
</span><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>    <span class="c1"># The time derivative is therefore</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>    <span class="c1"># dlogx/dtau (x0) = dlogx/dlog(t,k) (x0) * dlog(t,k)/dtau (x0)</span>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>    <span class="c1">#                 = dlogx/dlog(t,k) (x0) * (y1-y0)</span>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>    <span class="c1"># dlogx/dlog(t,k) (x0) is log derivative matrix evaluated at x0.</span>
</span><span id="__span-0-1374"><a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>    <span class="n">time_derivative_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tau</span><span class="p">,</span><span class="n">logx</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span>
</span><span id="__span-0-1375"><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>    <span class="n">sol</span><span class="o">=</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">time_derivative_func</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">logx0</span><span class="p">)</span>
</span><span id="__span-0-1376"><a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>    <span class="n">logx</span><span class="o">=</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>    <span class="k">return</span> <span class="n">logx</span>
</span><span id="__span-0-1378"><a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>
</span><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_tk2x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logvar</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">    Compute the numerical dlog(t, k)/dlog(x) log derivative of the binding network at points specified by logvar in the specified chart and dominance a_mat.</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">        logvar (ndarray): Array of the points to evaluate the log derivatives at, in base-10 log. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">            In chart &#39;x&#39;, for example, this is logx.</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">        chart (str): Specifying the chart that logvar is specified in. Could be &#39;x&#39;, &#39;xak&#39;, or &#39;tk&#39;.</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">        a_mat (numpy array, optional): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">            Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">            Optional, defaults to l_mat of the binding network.</span>
</span><span id="__span-0-1390"><a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>
</span><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">        logder (ndarray): Array of n-by-n matrix of log derivative of (t, k) to x, where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">            Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1394"><a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><span class="sd">        logx (ndarray): Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1395"><a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">            This is returned since all input variables, regardless of chart, are mapped to the logx chart first.</span>
</span><span id="__span-0-1396"><a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">            Returned for convenience.</span>
</span><span id="__span-0-1397"><a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1398"><a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>    <span class="c1"># first check a_mat makes sense.</span>
</span><span id="__span-0-1399"><a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1"># no a_mat argument is given</span>
</span><span id="__span-0-1400"><a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>      <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-1401"><a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1402"><a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>      <span class="k">assert</span> <span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;the shape of L matrix should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="si">}</span><span class="s2"> by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-0-1403"><a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>      <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;all entries of A matrix should be non-negative.&quot;</span>
</span><span id="__span-0-1404"><a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>      <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;each row of A matrix should have at least one positive entry.&quot;</span>
</span><span id="__span-0-1405"><a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>    <span class="c1"># for different charts, use different functions to evaluate</span>
</span><span id="__span-0-1406"><a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>    <span class="n">npts</span><span class="o">=</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1407"><a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>    <span class="k">assert</span> <span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span> <span class="s1">&#39;shape of logvar should be num_points-by-dim_n&#39;</span>
</span><span id="__span-0-1408"><a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>    <span class="n">logders</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-1409"><a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>    <span class="k">if</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="__span-0-1410"><a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1411"><a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>        <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_tk2x_x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1412"><a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>      <span class="n">logx</span><span class="o">=</span><span class="n">logvar</span>
</span><span id="__span-0-1413"><a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>    <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;xak&#39;</span><span class="p">:</span>
</span><span id="__span-0-1414"><a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>      <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="p">,</span> <span class="s1">&#39;the binding network is not atomic, cannot use xak chart&#39;</span>
</span><span id="__span-0-1415"><a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>      <span class="n">logx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-1416"><a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1417"><a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>        <span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xak2x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-0-1418"><a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>        <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_tk2x_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1419"><a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>    <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;tk&#39;</span><span class="p">:</span>
</span><span id="__span-0-1420"><a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>      <span class="n">logx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-1421"><a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1422"><a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>        <span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk2x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1423"><a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>        <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_tk2x_x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1424"><a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>    <span class="k">else</span><span class="p">:</span> 
</span><span id="__span-0-1425"><a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;chart that is not one of &quot;x,xak,tk&quot; is not implemented yet&#39;</span><span class="p">)</span>
</span><span id="__span-0-1426"><a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>    <span class="k">return</span> <span class="n">logders</span><span class="p">,</span><span class="n">logx</span>
</span><span id="__span-0-1427"><a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>
</span><span id="__span-0-1428"><a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_tk2x_x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1429"><a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1430"><a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="sd">    Compute the numerical dlog(t, k)/dlog(x) log derivative of the binding network at one point in chart x.</span>
</span><span id="__span-0-1431"><a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>
</span><span id="__span-0-1432"><a id="__codelineno-0-1432" name="__codelineno-0-1432"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1433"><a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="sd">        logx (numpy vector): Vector of concentrations for all the species in log, base-10.</span>
</span><span id="__span-0-1434"><a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">        a_mat (numpy array): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1435"><a id="__codelineno-0-1435" name="__codelineno-0-1435"></a><span class="sd">            Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1436"><a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>
</span><span id="__span-0-1437"><a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1438"><a id="__codelineno-0-1438" name="__codelineno-0-1438"></a><span class="sd">        ndarray: Array of n-by-n matrix of log derivative of (t, k) to x, where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1439"><a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">            Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1440"><a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1441"><a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>    <span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">logx</span>
</span><span id="__span-0-1442"><a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>    <span class="n">t_inv</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-0-1443"><a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>    <span class="n">temp</span><span class="o">=</span><span class="n">a_mat</span><span class="o">*</span><span class="n">x</span>
</span><span id="__span-0-1444"><a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>    <span class="n">upper</span><span class="o">=</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">t_inv</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="__span-0-1445"><a id="__codelineno-0-1445" name="__codelineno-0-1445"></a>    <span class="n">logder</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">upper</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1446"><a id="__codelineno-0-1446" name="__codelineno-0-1446"></a>    <span class="k">return</span> <span class="n">logder</span>
</span><span id="__span-0-1447"><a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>
</span><span id="__span-0-1448"><a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_complex_ss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logk</span><span class="p">,</span> <span class="n">logx</span><span class="p">):</span>
</span><span id="__span-0-1449"><a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>    <span class="n">n1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">[:,</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">logx</span><span class="p">)]</span>
</span><span id="__span-0-1450"><a id="__codelineno-0-1450" name="__codelineno-0-1450"></a>    <span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">[:,</span> <span class="nb">len</span><span class="p">(</span><span class="n">logx</span><span class="p">):</span> <span class="p">]</span>
</span><span id="__span-0-1451"><a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>    <span class="n">n2_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
</span><span id="__span-0-1452"><a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>    <span class="n">logx_complex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n2_inv</span><span class="p">,</span> <span class="p">(</span><span class="n">logk</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">logx</span><span class="p">)))</span>
</span><span id="__span-0-1453"><a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>
</span><span id="__span-0-1454"><a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>    <span class="k">return</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">logx_complex</span>
</span><span id="__span-0-1455"><a id="__codelineno-0-1455" name="__codelineno-0-1455"></a>
</span><span id="__span-0-1456"><a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>
</span><span id="__span-0-1457"><a id="__codelineno-0-1457" name="__codelineno-0-1457"></a>
</span><span id="__span-0-1458"><a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><span class="c1"># BELOW ARE VERTEX RELATED METHODS</span>
</span><span id="__span-0-1459"><a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>
</span><span id="__span-0-1460"><a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-1461"><a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1462"><a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">    Construct the rop_vertex objects that this binding network can have, compute their orientation and feasibility (without additional constraints), and store them in self.vertex_dict.</span>
</span><span id="__span-0-1463"><a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">    Then the vertices&#39; neighbors, log derivative, and c_mat_xak are computed and stored in these objects.</span>
</span><span id="__span-0-1464"><a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>
</span><span id="__span-0-1465"><a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1466"><a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><span class="sd">        None.</span>
</span><span id="__span-0-1467"><a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>
</span><span id="__span-0-1468"><a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1469"><a id="__codelineno-0-1469" name="__codelineno-0-1469"></a><span class="sd">        None. The vertices are recorded in self.vertex_dict and by updating the vertex objects.</span>
</span><span id="__span-0-1470"><a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1471"><a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>    <span class="c1"># Construct a dictionary of reachable vertices.</span>
</span><span id="__span-0-1472"><a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>    <span class="c1"># because l_mat tends to be sparse, we iterate through its rows to get nonzero indices,</span>
</span><span id="__span-0-1473"><a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>    <span class="c1"># then each vertex&#39;s dominance condition a_mat is choosen from the nonezro indices.</span>
</span><span id="__span-0-1474"><a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>
</span><span id="__span-0-1475"><a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Constructing vertex objects and test for feasibility...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1476"><a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>    <span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-1477"><a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>    <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span>
</span><span id="__span-0-1478"><a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>    <span class="n">nnz_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-1479"><a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
</span><span id="__span-0-1480"><a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>      <span class="n">nnz_list</span><span class="o">=</span><span class="n">nnz_list</span><span class="o">+</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,:])[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="__span-0-1481"><a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>    <span class="n">vertex_inf_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1482"><a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>    <span class="n">vertex_fin_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1483"><a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">nnz_list</span><span class="p">):</span>
</span><span id="__span-0-1484"><a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>      <span class="n">vertex</span><span class="o">=</span><span class="n">rop_vertex</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1485"><a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>      <span class="k">if</span> <span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1486"><a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>        <span class="c1"># this is possibly an infinite vertex</span>
</span><span id="__span-0-1487"><a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>        <span class="c1"># check for rank =1, meaning perm has exactly one repeat</span>
</span><span id="__span-0-1488"><a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>        <span class="n">perm_count</span><span class="o">=</span><span class="p">[</span><span class="n">perm</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>
</span><span id="__span-0-1489"><a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">perm_count</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-1490"><a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>          <span class="k">if</span> <span class="n">perm_count</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span> <span class="c1"># because that same value shows up twice, each with count 2.</span>
</span><span id="__span-0-1491"><a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>            <span class="c1"># after all that check, there still can be infinite vertices that are not reachable</span>
</span><span id="__span-0-1492"><a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>            <span class="c1"># so we do feasibility test.</span>
</span><span id="__span-0-1493"><a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>            <span class="n">is_feasible</span><span class="o">=</span><span class="n">vertex</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="p">[])</span>
</span><span id="__span-0-1494"><a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>            <span class="c1"># and then add to vertex_inf_dict.</span>
</span><span id="__span-0-1495"><a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>            <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1496"><a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>              <span class="n">vertex_inf_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1497"><a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>      <span class="k">elif</span> <span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="n">orientation</span><span class="p">:</span>
</span><span id="__span-0-1498"><a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>        <span class="c1"># this is a finite vertex with the right orientation</span>
</span><span id="__span-0-1499"><a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>        <span class="c1"># we test for feasibility</span>
</span><span id="__span-0-1500"><a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>        <span class="n">is_feasible</span><span class="o">=</span><span class="n">vertex</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="p">[])</span>
</span><span id="__span-0-1501"><a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>        <span class="c1"># and then add to vertex_fin_dict.</span>
</span><span id="__span-0-1502"><a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>        <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1503"><a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>          <span class="n">vertex_fin_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1504"><a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>    <span class="n">vertex_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">vertex_fin_dict</span><span class="p">,</span><span class="o">**</span><span class="n">vertex_inf_dict</span><span class="p">}</span>
</span><span id="__span-0-1505"><a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">vertex_dict</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">vertex_fin_dict</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">vertex_inf_dict</span><span class="p">}</span>
</span><span id="__span-0-1506"><a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>
</span><span id="__span-0-1507"><a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished vertex construction, now computing neighbors of vertices...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1508"><a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1509"><a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_find_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1510"><a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>
</span><span id="__span-0-1511"><a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished neighbors, now computing log derivatives...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1512"><a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>    <span class="c1"># first compute log der for finite vertices, since infinite ones rely on</span>
</span><span id="__span-0-1513"><a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>    <span class="c1"># finite neighbors to find orientation.</span>
</span><span id="__span-0-1514"><a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1515"><a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_ld_calc</span><span class="p">()</span>
</span><span id="__span-0-1516"><a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>
</span><span id="__span-0-1517"><a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished log derivatives, now computing c_mat_xak&#39;</span><span class="p">)</span>
</span><span id="__span-0-1518"><a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>    <span class="c1"># compute c_mat_xak for each vertex in preparation for feasibility tests.</span>
</span><span id="__span-0-1519"><a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1520"><a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_c_mat_xak_calc</span><span class="p">()</span>
</span><span id="__span-0-1521"><a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
</span><span id="__span-0-1522"><a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>
</span><span id="__span-0-1523"><a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">__get_dom_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">a_mat</span><span class="p">,</span><span class="n">not_dominated_col_idx</span><span class="p">,</span><span class="n">dominated_row_vec_prev</span><span class="p">,</span><span class="n">dom_tuple_prev</span><span class="p">):</span>
</span><span id="__span-0-1524"><a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>    <span class="n">perm_dict_add</span><span class="o">=</span><span class="p">{}</span> <span class="c1"># use dictionary to make sure repeated ones are combined.</span>
</span><span id="__span-0-1525"><a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">not_dominated_col_idx</span><span class="p">:</span>
</span><span id="__span-0-1526"><a id="__codelineno-0-1526" name="__codelineno-0-1526"></a>      <span class="n">dominated_row_j</span> <span class="o">=</span> <span class="n">a_mat</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span>
</span><span id="__span-0-1527"><a id="__codelineno-0-1527" name="__codelineno-0-1527"></a>      <span class="n">dominated_row_vec_new</span> <span class="o">=</span> <span class="n">dominated_row_j</span> <span class="o">-</span> <span class="n">dominated_row_j</span> <span class="o">*</span> <span class="n">dominated_row_vec_prev</span>
</span><span id="__span-0-1528"><a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>      <span class="n">dominated_row_idx_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dominated_row_vec_new</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1529"><a id="__codelineno-0-1529" name="__codelineno-0-1529"></a>      <span class="n">dom_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dom_tuple_prev</span><span class="p">)</span>
</span><span id="__span-0-1530"><a id="__codelineno-0-1530" name="__codelineno-0-1530"></a>      <span class="n">dom_vec</span><span class="p">[</span><span class="n">dominated_row_idx_new</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
</span><span id="__span-0-1531"><a id="__codelineno-0-1531" name="__codelineno-0-1531"></a>      <span class="n">dominated_row_vec_now</span> <span class="o">=</span> <span class="n">dominated_row_vec_prev</span> <span class="o">+</span> <span class="n">dominated_row_vec_new</span>
</span><span id="__span-0-1532"><a id="__codelineno-0-1532" name="__codelineno-0-1532"></a>      <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dominated_row_vec_now</span><span class="p">)</span><span class="o">&lt;</span><span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="__span-0-1533"><a id="__codelineno-0-1533" name="__codelineno-0-1533"></a>        <span class="c1"># there are rows not yet dominated</span>
</span><span id="__span-0-1534"><a id="__codelineno-0-1534" name="__codelineno-0-1534"></a>        <span class="n">not_dominated_row_idx_next</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">dominated_row_vec_now</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1535"><a id="__codelineno-0-1535" name="__codelineno-0-1535"></a>        <span class="c1"># then we combine all the rows not yet dominated to find the </span>
</span><span id="__span-0-1536"><a id="__codelineno-0-1536" name="__codelineno-0-1536"></a>        <span class="c1">#   columns not yet dominated. This could result in previously </span>
</span><span id="__span-0-1537"><a id="__codelineno-0-1537" name="__codelineno-0-1537"></a>        <span class="c1">#   already discovered dominance regimes to be counted again.</span>
</span><span id="__span-0-1538"><a id="__codelineno-0-1538" name="__codelineno-0-1538"></a>        <span class="n">not_dominated_col_idx_next</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a_mat</span><span class="p">[</span><span class="n">not_dominated_row_idx_next</span><span class="p">,:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1539"><a id="__codelineno-0-1539" name="__codelineno-0-1539"></a>        <span class="n">perm_dict_add_next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_dom_vec</span><span class="p">(</span><span class="n">a_mat</span><span class="p">,</span><span class="n">not_dominated_col_idx_next</span><span class="p">,</span><span class="n">dominated_row_vec_now</span><span class="p">,</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dom_vec</span><span class="p">))</span>
</span><span id="__span-0-1540"><a id="__codelineno-0-1540" name="__codelineno-0-1540"></a>        <span class="n">perm_dict_add</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">perm_dict_add_next</span><span class="p">)</span>
</span><span id="__span-0-1541"><a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># all rows are dominated</span>
</span><span id="__span-0-1542"><a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>        <span class="n">perm_dict_add</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dom_vec</span><span class="p">)]</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-1543"><a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>    <span class="k">return</span> <span class="n">perm_dict_add</span>
</span><span id="__span-0-1544"><a id="__codelineno-0-1544" name="__codelineno-0-1544"></a>
</span><span id="__span-0-1545"><a id="__codelineno-0-1545" name="__codelineno-0-1545"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_construct_direct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-1546"><a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1547"><a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">    Construct the rop_vertex objects that this binding network can have, directly, without feasibility test.</span>
</span><span id="__span-0-1548"><a id="__codelineno-0-1548" name="__codelineno-0-1548"></a>
</span><span id="__span-0-1549"><a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1550"><a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">        None.</span>
</span><span id="__span-0-1551"><a id="__codelineno-0-1551" name="__codelineno-0-1551"></a>
</span><span id="__span-0-1552"><a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1553"><a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="sd">        None. The vertices are recorded in self.vertex_dict and by updating the vertex objects.</span>
</span><span id="__span-0-1554"><a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1555"><a id="__codelineno-0-1555" name="__codelineno-0-1555"></a>    <span class="c1"># We construct the vertices by iteratively construct all the possible</span>
</span><span id="__span-0-1556"><a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>    <span class="c1"># dominance vector (perm).</span>
</span><span id="__span-0-1557"><a id="__codelineno-0-1557" name="__codelineno-0-1557"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Constructing vertex objects DIRECTLY...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1558"><a id="__codelineno-0-1558" name="__codelineno-0-1558"></a>    <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-1559"><a id="__codelineno-0-1559" name="__codelineno-0-1559"></a>    <span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-1560"><a id="__codelineno-0-1560" name="__codelineno-0-1560"></a>    <span class="n">not_dominated_col_idx</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="__span-0-1561"><a id="__codelineno-0-1561" name="__codelineno-0-1561"></a>    <span class="n">dominated_row_vec_prev</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-0-1562"><a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>    <span class="n">dom_tuple_prev</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</span><span id="__span-0-1563"><a id="__codelineno-0-1563" name="__codelineno-0-1563"></a>    <span class="n">perm_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_dom_vec</span><span class="p">(</span><span class="n">a_mat</span><span class="p">,</span><span class="n">not_dominated_col_idx</span><span class="p">,</span><span class="n">dominated_row_vec_prev</span><span class="p">,</span><span class="n">dom_tuple_prev</span><span class="p">)</span>
</span><span id="__span-0-1564"><a id="__codelineno-0-1564" name="__codelineno-0-1564"></a>    <span class="n">vertex_fin_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1565"><a id="__codelineno-0-1565" name="__codelineno-0-1565"></a>    <span class="n">vertex_inf_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1566"><a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>    <span class="n">vertex_infHO_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1567"><a id="__codelineno-0-1567" name="__codelineno-0-1567"></a>    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">perm_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="__span-0-1568"><a id="__codelineno-0-1568" name="__codelineno-0-1568"></a>      <span class="n">vertex</span><span class="o">=</span><span class="n">rop_vertex</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1569"><a id="__codelineno-0-1569" name="__codelineno-0-1569"></a>      <span class="n">repeat_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">p_mat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1570"><a id="__codelineno-0-1570" name="__codelineno-0-1570"></a>      <span class="k">if</span> <span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1571"><a id="__codelineno-0-1571" name="__codelineno-0-1571"></a>        <span class="n">vertex_fin_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1572"><a id="__codelineno-0-1572" name="__codelineno-0-1572"></a>      <span class="c1"># elif np.max(repeat_vec)&gt;2 or np.sum(repeat_vec&gt;1) &gt;=2:</span>
</span><span id="__span-0-1573"><a id="__codelineno-0-1573" name="__codelineno-0-1573"></a>        <span class="c1"># there is an index repeated 3 or more times, OR there are more than two indices repeated twice or above;</span>
</span><span id="__span-0-1574"><a id="__codelineno-0-1574" name="__codelineno-0-1574"></a>        <span class="c1"># So this is an infinite vertex of higher order.</span>
</span><span id="__span-0-1575"><a id="__codelineno-0-1575" name="__codelineno-0-1575"></a>      <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">repeat_vec</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">repeat_vec</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]])</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-1576"><a id="__codelineno-0-1576" name="__codelineno-0-1576"></a>        <span class="c1"># another way to test for higher order is the sum of repeated indices&#39; total repeated times is &gt;2.</span>
</span><span id="__span-0-1577"><a id="__codelineno-0-1577" name="__codelineno-0-1577"></a>        <span class="n">vertex_infHO_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1578"><a id="__codelineno-0-1578" name="__codelineno-0-1578"></a>      <span class="k">else</span><span class="p">:</span> <span class="c1">#infinite vertex of order one</span>
</span><span id="__span-0-1579"><a id="__codelineno-0-1579" name="__codelineno-0-1579"></a>        <span class="n">vertex_inf_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1580"><a id="__codelineno-0-1580" name="__codelineno-0-1580"></a>    <span class="n">vertex_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">vertex_fin_dict</span><span class="p">,</span><span class="o">**</span><span class="n">vertex_inf_dict</span><span class="p">}</span>
</span><span id="__span-0-1581"><a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">vertex_dict</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">vertex_fin_dict</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">vertex_inf_dict</span><span class="p">,</span><span class="s1">&#39;infiniteHO&#39;</span><span class="p">:</span><span class="n">vertex_infHO_dict</span><span class="p">}</span>
</span><span id="__span-0-1582"><a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>
</span><span id="__span-0-1583"><a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished vertex construction, now computing neighbors of vertices...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1584"><a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1585"><a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_find_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1586"><a id="__codelineno-0-1586" name="__codelineno-0-1586"></a>
</span><span id="__span-0-1587"><a id="__codelineno-0-1587" name="__codelineno-0-1587"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished neighbors, now computing log derivatives...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1588"><a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>    <span class="c1"># first compute log der for finite vertices, since infinite ones rely on</span>
</span><span id="__span-0-1589"><a id="__codelineno-0-1589" name="__codelineno-0-1589"></a>    <span class="c1"># finite neighbors to find orientation.</span>
</span><span id="__span-0-1590"><a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1591"><a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_ld_calc</span><span class="p">()</span>
</span><span id="__span-0-1592"><a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>
</span><span id="__span-0-1593"><a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished log derivatives, now computing c_mat_xak&#39;</span><span class="p">)</span>
</span><span id="__span-0-1594"><a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>    <span class="c1"># compute c_mat_xak for each vertex in preparation for feasibility tests.</span>
</span><span id="__span-0-1595"><a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1596"><a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_c_mat_xak_calc</span><span class="p">()</span>
</span><span id="__span-0-1597"><a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
</span><span id="__span-0-1598"><a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>
</span><span id="__span-0-1599"><a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_constrained_construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opt_constraints</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;xak&#39;</span><span class="p">):</span>
</span><span id="__span-0-1600"><a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1601"><a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="sd">    Assuming self.vertex_dict is already computed, for given opt_constraints, this function computes whether the vertices are feasible under these constraints, updates rop_vertex.is_feasible for each vertex, and updates each vertex&#39;s feasible neighbors (stored in vertex.neighbors_constrained_dict). It returns is_feasible_dict, a dictionary of {perm: is_feasible} pairs.</span>
</span><span id="__span-0-1602"><a id="__codelineno-0-1602" name="__codelineno-0-1602"></a><span class="sd">    This function calls vertex_list_feasibility_test.</span>
</span><span id="__span-0-1603"><a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>
</span><span id="__span-0-1604"><a id="__codelineno-0-1604" name="__codelineno-0-1604"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1605"><a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><span class="sd">        opt_constraints (list of cvxpy inequalities): List of constraints under which vertices are tested for feasibility.</span>
</span><span id="__span-0-1606"><a id="__codelineno-0-1606" name="__codelineno-0-1606"></a><span class="sd">        chart (str, optional): A string with value from {&#39;x&#39;, &#39;xak&#39;, &#39;tk&#39;} that specifies the chart that the opt_constraints are described in. Defaults to None.</span>
</span><span id="__span-0-1607"><a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>
</span><span id="__span-0-1608"><a id="__codelineno-0-1608" name="__codelineno-0-1608"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1609"><a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><span class="sd">        dict: A dictionary of {perm: is_feasible} pairs indicating whether a vertex is feasible.</span>
</span><span id="__span-0-1610"><a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1611"><a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>    <span class="c1"># for the given opt_constraints, test for each vertex whether it is feasible</span>
</span><span id="__span-0-1612"><a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>    <span class="c1"># under opt_constraints, and create a vertex dictionary for feasible vertices</span>
</span><span id="__span-0-1613"><a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>    <span class="c1"># under opt_constraints, stored in self.vertex_constrained_dict.</span>
</span><span id="__span-0-1614"><a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>    <span class="c1"># Also update each vertex&#39;s neighbors under constraints,</span>
</span><span id="__span-0-1615"><a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>    <span class="c1"># stored in each vertex.neighbors_constrained_dict.</span>
</span><span id="__span-0-1616"><a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>
</span><span id="__span-0-1617"><a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compute feasible vertices...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1618"><a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1619"><a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>      <span class="n">is_feasible</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span>
</span><span id="__span-0-1620"><a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1621"><a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>    <span class="n">vertex_feasible_all</span><span class="o">=</span><span class="p">{</span><span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-1622"><a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>    <span class="n">vertex_feasible_fin</span><span class="o">=</span><span class="p">{</span><span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-1623"><a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>    <span class="n">vertex_feasible_inf</span><span class="o">=</span><span class="p">{</span><span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-1624"><a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_constrained_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">vertex_feasible_all</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">vertex_feasible_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">vertex_feasible_inf</span><span class="p">}</span>
</span><span id="__span-0-1625"><a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>
</span><span id="__span-0-1626"><a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compute neighbors under opt_constraints...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1627"><a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1628"><a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>      <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1629"><a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>        <span class="c1"># if it is feasible, we want to look at its neighbors.</span>
</span><span id="__span-0-1630"><a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>        <span class="c1"># if a neighbor is feasible, it is still a neighbor under constraint.</span>
</span><span id="__span-0-1631"><a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>        <span class="c1"># if a neighbor is infeasible, we look at its neighbors to see whether</span>
</span><span id="__span-0-1632"><a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>        <span class="c1"># they are feasible. This recurses.</span>
</span><span id="__span-0-1633"><a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>        <span class="n">vv</span><span class="o">.</span><span class="n">vertex_update_constrained_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1634"><a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
</span><span id="__span-0-1635"><a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>
</span><span id="__span-0-1636"><a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_list_feasibility_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opt_constraints</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;xak&#39;</span><span class="p">):</span>
</span><span id="__span-0-1637"><a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1638"><a id="__codelineno-0-1638" name="__codelineno-0-1638"></a><span class="sd">    Given opt_constraints, test all the vertices for their feasibility and return is_feasible_dict.</span>
</span><span id="__span-0-1639"><a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><span class="sd">    This function is called by vertex_constrained_construct.</span>
</span><span id="__span-0-1640"><a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="sd">    It can also be directly called to test for feasibility without storing or finding feasible neighbors.</span>
</span><span id="__span-0-1641"><a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>
</span><span id="__span-0-1642"><a id="__codelineno-0-1642" name="__codelineno-0-1642"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1643"><a id="__codelineno-0-1643" name="__codelineno-0-1643"></a><span class="sd">        opt_constraints (list of cvxpy inequalities): List of constraints under which vertices are tested for feasibility.</span>
</span><span id="__span-0-1644"><a id="__codelineno-0-1644" name="__codelineno-0-1644"></a><span class="sd">        chart (str, optional): A string with value from {&#39;x&#39;, &#39;xak&#39;, &#39;tk&#39;} that specifies the chart that the opt_constraints are described in. Defaults to None.</span>
</span><span id="__span-0-1645"><a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>
</span><span id="__span-0-1646"><a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1647"><a id="__codelineno-0-1647" name="__codelineno-0-1647"></a><span class="sd">        dict: A dictionary of {perm: is_feasible} pairs indicating whether a vertex is feasible.</span>
</span><span id="__span-0-1648"><a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1649"><a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>    <span class="c1"># for the given opt_constraints, test each of the vertex whether it is feasible</span>
</span><span id="__span-0-1650"><a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>    <span class="n">is_feasible_fin</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1651"><a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>    <span class="n">is_feasible_inf</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1652"><a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1653"><a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>      <span class="n">is_feasible</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span>
</span><span id="__span-0-1654"><a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>      <span class="n">is_feasible_fin</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1655"><a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1656"><a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>      <span class="n">is_feasible</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span>
</span><span id="__span-0-1657"><a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>      <span class="n">is_feasible_inf</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1658"><a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>
</span><span id="__span-0-1659"><a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>    <span class="n">is_feasible_all</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">is_feasible_fin</span><span class="p">,</span><span class="o">**</span><span class="n">is_feasible_inf</span><span class="p">}</span>
</span><span id="__span-0-1660"><a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>    <span class="n">is_feasible_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">is_feasible_all</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">is_feasible_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">is_feasible_inf</span><span class="p">}</span>
</span><span id="__span-0-1661"><a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>    <span class="k">return</span> <span class="n">is_feasible_dict</span>
</span><span id="__span-0-1662"><a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>
</span><span id="__span-0-1663"><a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">sampling_over_vertex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">vertex_perm_list</span><span class="o">=</span><span class="p">[],</span><span class="n">is_finite_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-1664"><a id="__codelineno-0-1664" name="__codelineno-0-1664"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1665"><a id="__codelineno-0-1665" name="__codelineno-0-1665"></a><span class="sd">    Randomly sample points in the log space of chart variables, but instead of log-uniform, we first assign points to each vertex in an even fashion, then sample uniformly within each vertex.</span>
</span><span id="__span-0-1666"><a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>
</span><span id="__span-0-1667"><a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1668"><a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">        nsample (int): The number of points to be sampled in the space of chart variables.</span>
</span><span id="__span-0-1669"><a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">            This is divided evenly to all the vertices of this binding network.</span>
</span><span id="__span-0-1670"><a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">        is_finite_only (bool, optional): Useful only when vertex_perm_list=[], so that all vertices are sampled.</span>
</span><span id="__span-0-1671"><a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">            If True, only finite vertices are sampled. This also allows chart &#39;tk&#39; to work.</span>
</span><span id="__span-0-1672"><a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">            If False, both finite and infinite vertices are sampled. Defaults to False.</span>
</span><span id="__span-0-1673"><a id="__codelineno-0-1673" name="__codelineno-0-1673"></a><span class="sd">        vertex_perm_list (list of vertex&#39;s perm tuples, optional): The list of perms indexing the vertices to be sampled.</span>
</span><span id="__span-0-1674"><a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">            e.g. [(0,1,2), (0,1,3)]. Defaults to empty list []. If empty, sample all vertices.</span>
</span><span id="__span-0-1675"><a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="sd">        chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-1676"><a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="sd">            Choices are &#39;x&#39;, &#39;xak&#39;, and &#39;tk&#39;. Defaults to &#39;x&#39;.</span>
</span><span id="__span-0-1677"><a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">        margin (float, optional): The vertex&#39;s feasibility conditions are inequalities,</span>
</span><span id="__span-0-1678"><a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">            of the form c_mat * logx + c0_vec &gt; margin (e.g. in &#39;x&#39; chart),</span>
</span><span id="__span-0-1679"><a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">            where margin is the positive threshold used here. Defaults to 0.</span>
</span><span id="__span-0-1680"><a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="sd">            This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-1681"><a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">        logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to every variable.</span>
</span><span id="__span-0-1682"><a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-1683"><a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">        logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to every variable.</span>
</span><span id="__span-0-1684"><a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-1685"><a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>
</span><span id="__span-0-1686"><a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1687"><a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">        dict: A dictionary of ndarray with shape (nsample, dim_n).</span>
</span><span id="__span-0-1688"><a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">            Key is the perm of each vertex. Value is the sample for that vertex.</span>
</span><span id="__span-0-1689"><a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1690"><a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>
</span><span id="__span-0-1691"><a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>    <span class="c1"># calculate number of vertex to be plotted and the dictionary of vertices.</span>
</span><span id="__span-0-1692"><a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>    <span class="n">vertex_plot_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1693"><a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>    <span class="k">if</span> <span class="n">vertex_perm_list</span><span class="p">:</span> <span class="c1"># vertex_perm_list is not empty</span>
</span><span id="__span-0-1694"><a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>      <span class="n">nvertex</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vertex_perm_list</span><span class="p">)</span>
</span><span id="__span-0-1695"><a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>      <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">vertex_perm_list</span><span class="p">:</span>
</span><span id="__span-0-1696"><a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>        <span class="n">vertex_plot_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">perm</span><span class="p">]</span>
</span><span id="__span-0-1697"><a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>    <span class="k">else</span><span class="p">:</span> <span class="c1"># plot all vertices</span>
</span><span id="__span-0-1698"><a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>      <span class="k">if</span> <span class="n">is_finite_only</span><span class="p">:</span> 
</span><span id="__span-0-1699"><a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>        <span class="n">finite_key</span><span class="o">=</span><span class="s1">&#39;finite&#39;</span>
</span><span id="__span-0-1700"><a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>      <span class="k">else</span><span class="p">:</span> 
</span><span id="__span-0-1701"><a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>        <span class="n">finite_key</span><span class="o">=</span><span class="s1">&#39;all&#39;</span>
</span><span id="__span-0-1702"><a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>      <span class="n">nvertex</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="n">finite_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-0-1703"><a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>      <span class="n">vertex_plot_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="n">finite_key</span><span class="p">]</span>
</span><span id="__span-0-1704"><a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>    <span class="c1"># now sample each vertex.</span>
</span><span id="__span-0-1705"><a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>    <span class="n">nsample_per_vertex</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">nsample</span><span class="o">/</span><span class="n">nvertex</span><span class="p">)</span> <span class="c1"># take the floor for number of sample per vertex</span>
</span><span id="__span-0-1706"><a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>    <span class="n">sample_vertex_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1707"><a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_plot_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1708"><a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>      <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-1709"><a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>      <span class="n">sample_vertex_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_hull_sampling</span><span class="p">(</span><span class="n">nsample_per_vertex</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span><span class="n">logmin</span><span class="o">=</span><span class="n">logmin</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="n">logmax</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="n">c_mat_extra</span><span class="p">,</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="n">c0_vec_extra</span><span class="p">)</span>
</span><span id="__span-0-1710"><a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>    <span class="k">return</span> <span class="n">sample_vertex_dict</span>
</span><span id="__span-0-1711"><a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>
</span><span id="__span-0-1712"><a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">sampling_over_activity_regime_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">b_tuple</span><span class="p">,</span><span class="n">regime_key_list</span><span class="o">=</span><span class="p">[],</span><span class="n">is_finite_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">is_feasible_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-1713"><a id="__codelineno-0-1713" name="__codelineno-0-1713"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1714"><a id="__codelineno-0-1714" name="__codelineno-0-1714"></a><span class="sd">    Randomly sample points in the log space of chart variables for each dom_regime for a given activity, but instead of log-uniform, we first assign points to each vertex in an even fashion, then sample uniformly within each vertex.</span>
</span><span id="__span-0-1715"><a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>
</span><span id="__span-0-1716"><a id="__codelineno-0-1716" name="__codelineno-0-1716"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1717"><a id="__codelineno-0-1717" name="__codelineno-0-1717"></a><span class="sd">        nsample (int): The number of points to be sampled in the space of chart variables.</span>
</span><span id="__span-0-1718"><a id="__codelineno-0-1718" name="__codelineno-0-1718"></a><span class="sd">            This is divided evenly to all the vertices of this binding network.</span>
</span><span id="__span-0-1719"><a id="__codelineno-0-1719" name="__codelineno-0-1719"></a><span class="sd">        b_tuple (tuple of length dim_n): The b_tuple indicating the activity whose dom_regimes we are interested in sampling.</span>
</span><span id="__span-0-1720"><a id="__codelineno-0-1720" name="__codelineno-0-1720"></a><span class="sd">        is_finite_only (bool, optional): If True, only finite dom_regimes are sampled.</span>
</span><span id="__span-0-1721"><a id="__codelineno-0-1721" name="__codelineno-0-1721"></a><span class="sd">            If False, both finite and infinite dom_regimes are sampled. Defaults to False.</span>
</span><span id="__span-0-1722"><a id="__codelineno-0-1722" name="__codelineno-0-1722"></a><span class="sd">        regime_key_list (list of dominance regime&#39;s keys, optional): The list of keys for dom_regimes indexing the dom_regimes to be sampled.</span>
</span><span id="__span-0-1723"><a id="__codelineno-0-1723" name="__codelineno-0-1723"></a><span class="sd">            e.g. [((0,1,2),7), ((0,1,3),7)]. If empty, sample all dom_regimes. Defaults to empty list [].</span>
</span><span id="__span-0-1724"><a id="__codelineno-0-1724" name="__codelineno-0-1724"></a><span class="sd">        is_feasible_only (bool, optional): If True, only feasible dom_regimes are sampled.</span>
</span><span id="__span-0-1725"><a id="__codelineno-0-1725" name="__codelineno-0-1725"></a><span class="sd">            If False, all dom_regimes in regime_key_list (or all in this activity) are sampled.</span>
</span><span id="__span-0-1726"><a id="__codelineno-0-1726" name="__codelineno-0-1726"></a><span class="sd">            Each dom_regime&#39;s is_feasible tag comes from results of the most recent feasibility test.</span>
</span><span id="__span-0-1727"><a id="__codelineno-0-1727" name="__codelineno-0-1727"></a><span class="sd">        chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-1728"><a id="__codelineno-0-1728" name="__codelineno-0-1728"></a><span class="sd">            Choices are &#39;x&#39;, &#39;xak&#39;, and &#39;tk&#39;. Defaults to &#39;x&#39;.</span>
</span><span id="__span-0-1729"><a id="__codelineno-0-1729" name="__codelineno-0-1729"></a><span class="sd">        margin (float, optional): The vertex&#39;s feasibility conditions are inequalities,</span>
</span><span id="__span-0-1730"><a id="__codelineno-0-1730" name="__codelineno-0-1730"></a><span class="sd">            of the form c_mat * logx + c0_vec &gt; margin (e.g. in &#39;x&#39; chart),</span>
</span><span id="__span-0-1731"><a id="__codelineno-0-1731" name="__codelineno-0-1731"></a><span class="sd">            where margin is the positive threshold used here. Defaults to 0.</span>
</span><span id="__span-0-1732"><a id="__codelineno-0-1732" name="__codelineno-0-1732"></a><span class="sd">            This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-1733"><a id="__codelineno-0-1733" name="__codelineno-0-1733"></a><span class="sd">        logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to every variable.</span>
</span><span id="__span-0-1734"><a id="__codelineno-0-1734" name="__codelineno-0-1734"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-1735"><a id="__codelineno-0-1735" name="__codelineno-0-1735"></a><span class="sd">        logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to every variable.</span>
</span><span id="__span-0-1736"><a id="__codelineno-0-1736" name="__codelineno-0-1736"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-1737"><a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>
</span><span id="__span-0-1738"><a id="__codelineno-0-1738" name="__codelineno-0-1738"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1739"><a id="__codelineno-0-1739" name="__codelineno-0-1739"></a><span class="sd">        dict: A dictionary of ndarray with shape (nsample, dim_n).</span>
</span><span id="__span-0-1740"><a id="__codelineno-0-1740" name="__codelineno-0-1740"></a><span class="sd">            Key is the perm of each vertex. Value is the sample for that vertex.</span>
</span><span id="__span-0-1741"><a id="__codelineno-0-1741" name="__codelineno-0-1741"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1742"><a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>    <span class="k">pass</span>
</span><span id="__span-0-1743"><a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>    <span class="c1"># # calculate number of vertex to be plotted and the dictionary of vertices.</span>
</span><span id="__span-0-1744"><a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>    <span class="c1"># vertex_plot_dict={}</span>
</span><span id="__span-0-1745"><a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>    <span class="c1"># if vertex_perm_list: # vertex_perm_list is not empty</span>
</span><span id="__span-0-1746"><a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>    <span class="c1">#   nvertex=len(vertex_perm_list)</span>
</span><span id="__span-0-1747"><a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>    <span class="c1">#   for perm in vertex_perm_list:</span>
</span><span id="__span-0-1748"><a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>    <span class="c1">#     vertex_plot_dict[perm]=self.vertex_dict[&#39;all&#39;][perm]</span>
</span><span id="__span-0-1749"><a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>    <span class="c1"># else: # plot all vertices</span>
</span><span id="__span-0-1750"><a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>    <span class="c1">#   if is_finite_only: </span>
</span><span id="__span-0-1751"><a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>    <span class="c1">#     finite_key=&#39;finite&#39;</span>
</span><span id="__span-0-1752"><a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>    <span class="c1">#   else: </span>
</span><span id="__span-0-1753"><a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>    <span class="c1">#     finite_key=&#39;all&#39;</span>
</span><span id="__span-0-1754"><a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>    <span class="c1">#   nvertex=len(self.vertex_dict[finite_key].keys())</span>
</span><span id="__span-0-1755"><a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>    <span class="c1">#   vertex_plot_dict=self.vertex_dict[finite_key]</span>
</span><span id="__span-0-1756"><a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>    <span class="c1"># # now sample each vertex.</span>
</span><span id="__span-0-1757"><a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>    <span class="c1"># nsample_per_vertex=int(nsample/nvertex) # take the floor for number of sample per vertex</span>
</span><span id="__span-0-1758"><a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>    <span class="c1"># sample_vertex_dict={}</span>
</span><span id="__span-0-1759"><a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>    <span class="c1"># for key,vv in vertex_plot_dict.items():</span>
</span><span id="__span-0-1760"><a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>    <span class="c1">#   sample_vertex_dict[key]=vv.vertex_hull_sampling(nsample_per_vertex,chart=chart,margin=margin,logmin=logmin,logmax=logmax)</span>
</span><span id="__span-0-1761"><a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>    <span class="c1"># return sample_vertex_dict</span>
</span><span id="__span-0-1762"><a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>
</span><span id="__span-0-1763"><a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">activity_regime_construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">b_vec</span><span class="p">):</span>
</span><span id="__span-0-1764"><a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>    <span class="c1"># given b_vec, go through all vertices and their possible regimes</span>
</span><span id="__span-0-1765"><a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>    <span class="c1"># test for basic feasibility, and return a dictionary of regimes</span>
</span><span id="__span-0-1766"><a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>    <span class="c1"># {(perm,row):regime}; perm is vertex, row is dominant species in activity (b_vec)</span>
</span><span id="__span-0-1767"><a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>    <span class="c1"># regime is an rop_dom_regime object.</span>
</span><span id="__span-0-1768"><a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>    <span class="n">b_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)</span>
</span><span id="__span-0-1769"><a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computing feasible regimes...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1770"><a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>    <span class="n">nnz_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">b_vec</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1771"><a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>    <span class="n">regime_fin_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1772"><a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>    <span class="n">regime_inf_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1773"><a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1774"><a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nnz_b</span><span class="p">:</span>
</span><span id="__span-0-1775"><a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>        <span class="n">regime</span><span class="o">=</span><span class="n">rop_dom_regime</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">perm</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1776"><a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>        <span class="c1"># if vv.orientation == 0 and np.all(regime.ld==0): #this is an infinite vertex in direction not relevant for this activity</span>
</span><span id="__span-0-1777"><a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>        <span class="c1">#   continue</span>
</span><span id="__span-0-1778"><a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>        <span class="n">is_feasible</span><span class="o">=</span><span class="n">regime</span><span class="o">.</span><span class="n">feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="p">[])</span>
</span><span id="__span-0-1779"><a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>        <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1780"><a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>          <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1781"><a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>            <span class="n">regime_inf_dict</span><span class="p">[(</span><span class="n">perm</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span><span class="o">=</span><span class="n">regime</span>
</span><span id="__span-0-1782"><a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>          <span class="k">else</span><span class="p">:</span> <span class="n">regime_fin_dict</span><span class="p">[(</span><span class="n">perm</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span><span class="o">=</span><span class="n">regime</span>
</span><span id="__span-0-1783"><a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>
</span><span id="__span-0-1784"><a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>    <span class="n">regime_all_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">regime_fin_dict</span><span class="p">,</span><span class="o">**</span><span class="n">regime_inf_dict</span><span class="p">}</span>
</span><span id="__span-0-1785"><a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">regime_fin_dict</span><span class="p">,</span>
</span><span id="__span-0-1786"><a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>                                            <span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">regime_inf_dict</span><span class="p">,</span>
</span><span id="__span-0-1787"><a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>                                            <span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">regime_all_dict</span><span class="p">}</span>
</span><span id="__span-0-1788"><a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>
</span><span id="__span-0-1789"><a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Feasible regime computed, computing their neighboring regimes...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1790"><a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="n">regime_all_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1791"><a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>      <span class="n">regime</span><span class="o">.</span><span class="n">find_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1792"><a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="n">regime_all_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1793"><a id="__codelineno-0-1793" name="__codelineno-0-1793"></a>      <span class="n">regime</span><span class="o">.</span><span class="n">find_neighbors_zero</span><span class="p">()</span>
</span><span id="__span-0-1794"><a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>
</span><span id="__span-0-1795"><a id="__codelineno-0-1795" name="__codelineno-0-1795"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computing activity logder regimes dictionary... &#39;</span><span class="p">)</span>
</span><span id="__span-0-1796"><a id="__codelineno-0-1796" name="__codelineno-0-1796"></a>    <span class="c1"># since several regimes will have the same log derivative, we use log derivative as key, rather than regimes.</span>
</span><span id="__span-0-1797"><a id="__codelineno-0-1797" name="__codelineno-0-1797"></a>    <span class="n">ld_regime_fin_key_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1798"><a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>    <span class="n">ld_regime_inf_key_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1799"><a id="__codelineno-0-1799" name="__codelineno-0-1799"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="n">regime_fin_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1800"><a id="__codelineno-0-1800" name="__codelineno-0-1800"></a>      <span class="k">try</span><span class="p">:</span> <span class="n">ld_regime_fin_key_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">regime</span><span class="o">.</span><span class="n">ld</span><span class="p">)]</span><span class="o">+=</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="c1">#add regime to ld</span>
</span><span id="__span-0-1801"><a id="__codelineno-0-1801" name="__codelineno-0-1801"></a>      <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="n">ld_regime_fin_key_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">regime</span><span class="o">.</span><span class="n">ld</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="c1">#no regimes yet, initiate.</span>
</span><span id="__span-0-1802"><a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="n">regime_inf_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1803"><a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>      <span class="k">try</span><span class="p">:</span> <span class="n">ld_regime_inf_key_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">regime</span><span class="o">.</span><span class="n">ld</span><span class="p">)]</span><span class="o">+=</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="c1">#add regime to ld</span>
</span><span id="__span-0-1804"><a id="__codelineno-0-1804" name="__codelineno-0-1804"></a>      <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="n">ld_regime_inf_key_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">regime</span><span class="o">.</span><span class="n">ld</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="c1">#no regimes yet, initiate.</span>
</span><span id="__span-0-1805"><a id="__codelineno-0-1805" name="__codelineno-0-1805"></a>    <span class="c1"># convert into dictionary of ld_regime objects</span>
</span><span id="__span-0-1806"><a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>    <span class="n">ld_regime_fin_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1807"><a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>    <span class="n">ld_regime_inf_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1808"><a id="__codelineno-0-1808" name="__codelineno-0-1808"></a>    <span class="n">is_ray</span><span class="o">=</span><span class="kc">False</span>
</span><span id="__span-0-1809"><a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>    <span class="k">for</span> <span class="n">ld</span><span class="p">,</span><span class="n">regime_keys</span> <span class="ow">in</span> <span class="n">ld_regime_fin_key_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1810"><a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>      <span class="n">ld_regime</span><span class="o">=</span><span class="n">rop_ld_regime</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="n">is_ray</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">regime_keys</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1811"><a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>      <span class="n">ld_regime_fin_dict</span><span class="p">[</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="n">ld_regime</span>
</span><span id="__span-0-1812"><a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>    <span class="n">is_ray</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-1813"><a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>    <span class="k">for</span> <span class="n">ld</span><span class="p">,</span><span class="n">regime_keys</span> <span class="ow">in</span> <span class="n">ld_regime_inf_key_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1814"><a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>      <span class="n">ld_regime</span><span class="o">=</span><span class="n">rop_ld_regime</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span><span class="n">is_ray</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">regime_keys</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1815"><a id="__codelineno-0-1815" name="__codelineno-0-1815"></a>      <span class="n">ld_regime_inf_dict</span><span class="p">[</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="n">ld_regime</span>
</span><span id="__span-0-1816"><a id="__codelineno-0-1816" name="__codelineno-0-1816"></a>
</span><span id="__span-0-1817"><a id="__codelineno-0-1817" name="__codelineno-0-1817"></a>    <span class="n">ld_regime_all_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">ld_regime_fin_dict</span><span class="p">,</span><span class="o">**</span><span class="n">ld_regime_inf_dict</span><span class="p">}</span>
</span><span id="__span-0-1818"><a id="__codelineno-0-1818" name="__codelineno-0-1818"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">ld_regime_fin_dict</span><span class="p">,</span>
</span><span id="__span-0-1819"><a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>                                               <span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">ld_regime_inf_dict</span><span class="p">,</span>
</span><span id="__span-0-1820"><a id="__codelineno-0-1820" name="__codelineno-0-1820"></a>                                               <span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">ld_regime_all_dict</span><span class="p">}</span>
</span><span id="__span-0-1821"><a id="__codelineno-0-1821" name="__codelineno-0-1821"></a>
</span><span id="__span-0-1822"><a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computing activity logder regimes neighbors... &#39;</span><span class="p">)</span>
</span><span id="__span-0-1823"><a id="__codelineno-0-1823" name="__codelineno-0-1823"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">ld_regime</span> <span class="ow">in</span> <span class="n">ld_regime_all_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1824"><a id="__codelineno-0-1824" name="__codelineno-0-1824"></a>      <span class="n">ld_regime</span><span class="o">.</span><span class="n">find_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1825"><a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>
</span><span id="__span-0-1826"><a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done&#39;</span><span class="p">)</span>
</span><span id="__span-0-1827"><a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>
</span><span id="__span-0-1828"><a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">activity_regime_constrained_construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">opt_constraints</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;xak&#39;</span><span class="p">):</span>
</span><span id="__span-0-1829"><a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>    <span class="c1"># For the given opt_constraints, test for each dom_regime whether it is</span>
</span><span id="__span-0-1830"><a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>    <span class="c1"># feasible, update their neighbors under constraint,</span>
</span><span id="__span-0-1831"><a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>    <span class="c1"># and create a dictionary for feasible dom_regimes, stored in</span>
</span><span id="__span-0-1832"><a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>    <span class="c1"># self.activity_regime_contrained_dict[b_vec].</span>
</span><span id="__span-0-1833"><a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>    <span class="c1"># and create a dictionary for feasible ld_regimes, stored in</span>
</span><span id="__span-0-1834"><a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>    <span class="c1"># self.activity_ld_regime_constrained_dict[b_vec].</span>
</span><span id="__span-0-1835"><a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute dominance regimes&#39; feasibility...&quot;</span><span class="p">)</span>
</span><span id="__span-0-1836"><a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>    <span class="n">regime_constrained_fin</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1837"><a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>    <span class="n">regime_constrained_inf</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1838"><a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)][</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1839"><a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>      <span class="n">is_feasible</span><span class="o">=</span><span class="n">regime</span><span class="o">.</span><span class="n">feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span>
</span><span id="__span-0-1840"><a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>      <span class="n">regime</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1841"><a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>      <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1842"><a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>        <span class="k">if</span> <span class="n">regime</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1843"><a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>          <span class="n">regime_constrained_inf</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">regime</span>
</span><span id="__span-0-1844"><a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1845"><a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>          <span class="n">regime_constrained_fin</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">regime</span>
</span><span id="__span-0-1846"><a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>    <span class="n">regime_constrained_all</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">regime_constrained_fin</span><span class="p">,</span><span class="o">**</span><span class="n">regime_constrained_inf</span><span class="p">}</span>
</span><span id="__span-0-1847"><a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">activity_regime_constrained_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">regime_constrained_all</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">regime_constrained_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">regime_constrained_inf</span><span class="p">}</span>
</span><span id="__span-0-1848"><a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>
</span><span id="__span-0-1849"><a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute regimes&#39; neighboring regimes under opt_constraints...&quot;</span><span class="p">)</span>
</span><span id="__span-0-1850"><a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)][</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1851"><a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>      <span class="k">if</span> <span class="n">regime</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1852"><a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>        <span class="c1"># if it is feasible, we want to look at its neighbors.</span>
</span><span id="__span-0-1853"><a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>        <span class="c1"># if a neighbor is feasible, it is still a neighbor.</span>
</span><span id="__span-0-1854"><a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>        <span class="c1"># if a neighbor is infeasible, we look at its neighbors to see whether</span>
</span><span id="__span-0-1855"><a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>        <span class="c1"># they are feasible.</span>
</span><span id="__span-0-1856"><a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>        <span class="n">regime</span><span class="o">.</span><span class="n">update_constrained_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1857"><a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>
</span><span id="__span-0-1858"><a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute ld regimes&#39; feasibility and compute neighbors under opt_constraints...&quot;</span><span class="p">)</span>
</span><span id="__span-0-1859"><a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>    <span class="n">ld_regime_constrained_fin</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1860"><a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>    <span class="n">ld_regime_constrained_inf</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1861"><a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>    <span class="k">for</span> <span class="n">ld</span><span class="p">,</span><span class="n">ld_regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)][</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1862"><a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>      <span class="n">ld_regime</span><span class="o">.</span><span class="n">update_feasibility</span><span class="p">()</span>
</span><span id="__span-0-1863"><a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>      <span class="k">if</span> <span class="n">ld_regime</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1864"><a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>        <span class="n">ld_regime</span><span class="o">.</span><span class="n">update_constrained_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1865"><a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>        <span class="k">if</span> <span class="n">ld_regime</span><span class="o">.</span><span class="n">is_ray</span><span class="p">:</span>
</span><span id="__span-0-1866"><a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>          <span class="n">ld_regime_constrained_inf</span><span class="p">[</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="n">ld_regime</span>
</span><span id="__span-0-1867"><a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1868"><a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>          <span class="n">ld_regime_constrained_fin</span><span class="p">[</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="n">ld_regime</span>
</span><span id="__span-0-1869"><a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>    <span class="n">ld_regime_constrained_all</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">ld_regime_constrained_fin</span><span class="p">,</span><span class="o">**</span><span class="n">ld_regime_constrained_inf</span><span class="p">}</span>
</span><span id="__span-0-1870"><a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_constrained_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)]</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-1871"><a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>        <span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">ld_regime_constrained_all</span><span class="p">,</span>
</span><span id="__span-0-1872"><a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>        <span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">ld_regime_constrained_fin</span><span class="p">,</span>
</span><span id="__span-0-1873"><a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>        <span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">ld_regime_constrained_inf</span>
</span><span id="__span-0-1874"><a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>        <span class="p">}</span>
</span><span id="__span-0-1875"><a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>
</span><span id="__span-0-1876"><a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done&#39;</span><span class="p">)</span>
</span><span id="__span-0-1877"><a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>
</span><span id="__span-0-1878"><a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">activity_list_feasibility_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">opt_constraints</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;xak&#39;</span><span class="p">):</span>
</span><span id="__span-0-1879"><a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>    <span class="c1"># for the activity defined by b_vec (b_vec*x), and constraints given in</span>
</span><span id="__span-0-1880"><a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>    <span class="c1"># opt_constraints in chart (default xak), test each of the ld_regime</span>
</span><span id="__span-0-1881"><a id="__codelineno-0-1881" name="__codelineno-0-1881"></a>    <span class="c1"># whether it is feasible.</span>
</span><span id="__span-0-1882"><a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>    <span class="c1"># A ld_regime is feasible if one of its dom_regime is feasible.</span>
</span><span id="__span-0-1883"><a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>    <span class="n">is_feasible_fin</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1884"><a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>    <span class="n">is_feasible_inf</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1885"><a id="__codelineno-0-1885" name="__codelineno-0-1885"></a>    <span class="k">for</span> <span class="n">ld</span><span class="p">,</span><span class="n">ld_regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)][</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1886"><a id="__codelineno-0-1886" name="__codelineno-0-1886"></a>      <span class="n">is_feasible_dom_regime_list</span><span class="o">=</span><span class="p">[</span><span class="n">dom_regime</span><span class="o">.</span><span class="n">feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span> <span class="k">for</span> <span class="n">dom_regime</span> <span class="ow">in</span> <span class="n">ld_regime</span><span class="o">.</span><span class="n">dom_regime_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="__span-0-1887"><a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>      <span class="n">is_feasible</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">is_feasible_dom_regime_list</span><span class="p">)</span>
</span><span id="__span-0-1888"><a id="__codelineno-0-1888" name="__codelineno-0-1888"></a>      <span class="n">is_feasible_fin</span><span class="p">[</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1889"><a id="__codelineno-0-1889" name="__codelineno-0-1889"></a>    <span class="k">for</span> <span class="n">ld</span><span class="p">,</span><span class="n">ld_regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)][</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1890"><a id="__codelineno-0-1890" name="__codelineno-0-1890"></a>      <span class="n">is_feasible_dom_regime_list</span><span class="o">=</span><span class="p">[</span><span class="n">dom_regime</span><span class="o">.</span><span class="n">feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span> <span class="k">for</span> <span class="n">dom_regime</span> <span class="ow">in</span> <span class="n">ld_regime</span><span class="o">.</span><span class="n">dom_regime_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="__span-0-1891"><a id="__codelineno-0-1891" name="__codelineno-0-1891"></a>      <span class="n">is_feasible</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">is_feasible_dom_regime_list</span><span class="p">)</span>
</span><span id="__span-0-1892"><a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>      <span class="n">is_feasible_inf</span><span class="p">[</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1893"><a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>    <span class="n">is_feasible_all</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">is_feasible_fin</span><span class="p">,</span><span class="o">**</span><span class="n">is_feasible_inf</span><span class="p">}</span>
</span><span id="__span-0-1894"><a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>    <span class="n">is_feasible_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">is_feasible_all</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">is_feasible_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">is_feasible_inf</span><span class="p">}</span>
</span><span id="__span-0-1895"><a id="__codelineno-0-1895" name="__codelineno-0-1895"></a>    <span class="k">return</span> <span class="n">is_feasible_dict</span>
</span><span id="__span-0-1896"><a id="__codelineno-0-1896" name="__codelineno-0-1896"></a>
</span><span id="__span-0-1897"><a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><span class="c1"># BELOW ARE SYMBOLIC METHODS for the binding network</span>
</span><span id="__span-0-1898"><a id="__codelineno-0-1898" name="__codelineno-0-1898"></a>
</span><span id="__span-0-1899"><a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span><span class="n">is_saved</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-1900"><a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1901"><a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><span class="sd">    Calculate the symbolic log derivative matrix of dlog(x)/dlog(a_mat @ x, k).</span>
</span><span id="__span-0-1902"><a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>
</span><span id="__span-0-1903"><a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1904"><a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><span class="sd">        a_mat (numpy array, optional): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1905"><a id="__codelineno-0-1905" name="__codelineno-0-1905"></a><span class="sd">            Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1906"><a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">            Optional, defaults to l_mat of the binding network.</span>
</span><span id="__span-0-1907"><a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><span class="sd">        is_saved (bool, optional): To save the resulting logdermat as parameter ld_sym of the binding network or not.</span>
</span><span id="__span-0-1908"><a id="__codelineno-0-1908" name="__codelineno-0-1908"></a><span class="sd">            Defaults to True.</span>
</span><span id="__span-0-1909"><a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>
</span><span id="__span-0-1910"><a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1911"><a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">        sympy.Matrix: Symbolic log derivative matrix for x to (t_sym_temp, k_sym) expressed in terms of x.</span>
</span><span id="__span-0-1912"><a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>
</span><span id="__span-0-1913"><a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1914"><a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><span class="sd">        If the provided a_mat yields a noninvertible matrix, then the function will return logdermat as a matrix of zeros (with the appropriate size).</span>
</span><span id="__span-0-1915"><a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1916"><a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1"># no a_mat argument is given</span>
</span><span id="__span-0-1917"><a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>      <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-1918"><a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1919"><a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>      <span class="k">assert</span> <span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;the shape of L matrix should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="si">}</span><span class="s2"> by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-0-1920"><a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>      <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;all entries of A matrix should be non-negative.&quot;</span>
</span><span id="__span-0-1921"><a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>      <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;each row of A matrix should have at least one positive entry.&quot;</span>
</span><span id="__span-0-1922"><a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>
</span><span id="__span-0-1923"><a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>    <span class="n">a_mat_sym</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1924"><a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>    <span class="n">n_mat_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat_sym</span>
</span><span id="__span-0-1925"><a id="__codelineno-0-1925" name="__codelineno-0-1925"></a>
</span><span id="__span-0-1926"><a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>    <span class="c1">#it&#39;s much faster (10x) to use a dummy &quot;total&quot; variables to calculate matrix inverse,</span>
</span><span id="__span-0-1927"><a id="__codelineno-0-1927" name="__codelineno-0-1927"></a>    <span class="c1"># and then substitute the expression for the totals in terms of x, rather than</span>
</span><span id="__span-0-1928"><a id="__codelineno-0-1928" name="__codelineno-0-1928"></a>    <span class="c1"># inverting with the totals explicitly expressed in x variables.</span>
</span><span id="__span-0-1929"><a id="__codelineno-0-1929" name="__codelineno-0-1929"></a>
</span><span id="__span-0-1930"><a id="__codelineno-0-1930" name="__codelineno-0-1930"></a>    <span class="n">temp_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;t:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">))</span>
</span><span id="__span-0-1931"><a id="__codelineno-0-1931" name="__codelineno-0-1931"></a>
</span><span id="__span-0-1932"><a id="__codelineno-0-1932" name="__codelineno-0-1932"></a>    <span class="n">Lam_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">*</span><span class="n">temp_sym</span><span class="p">)</span>
</span><span id="__span-0-1933"><a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>    <span class="n">Lam_x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">)</span>
</span><span id="__span-0-1934"><a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>
</span><span id="__span-0-1935"><a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>    <span class="n">topmat</span> <span class="o">=</span> <span class="n">Lam_t</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">a_mat_sym</span> <span class="o">*</span> <span class="n">Lam_x</span>
</span><span id="__span-0-1936"><a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>    <span class="n">fullmat</span> <span class="o">=</span> <span class="n">topmat</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">n_mat_sym</span><span class="p">)</span>
</span><span id="__span-0-1937"><a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>
</span><span id="__span-0-1938"><a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>    <span class="n">logdermat_t</span> <span class="o">=</span> <span class="n">fullmat</span><span class="o">**-</span><span class="mi">1</span>
</span><span id="__span-0-1939"><a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>
</span><span id="__span-0-1940"><a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>    <span class="n">temp_expr</span><span class="o">=</span><span class="n">a_mat_sym</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">)</span>
</span><span id="__span-0-1941"><a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>    <span class="n">temp2x_subs_list</span><span class="o">=</span><span class="p">[(</span><span class="n">temp_sym</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">temp_expr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">)]</span>
</span><span id="__span-0-1942"><a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>    <span class="n">logdermat</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">logdermat_t</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">temp2x_subs_list</span><span class="p">))</span>
</span><span id="__span-0-1943"><a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>
</span><span id="__span-0-1944"><a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>    <span class="k">if</span> <span class="n">is_saved</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ld_sym_dict</span><span class="p">[</span><span class="n">a_mat</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()]</span><span class="o">=</span><span class="n">logdermat</span>
</span><span id="__span-0-1945"><a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>    <span class="k">return</span> <span class="n">logdermat</span>
</span><span id="__span-0-1946"><a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>
</span><span id="__span-0-1947"><a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">subs_list_t2x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-1948"><a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>    <span class="n">total_expr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat_sym</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">)</span>
</span><span id="__span-0-1949"><a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>    <span class="n">t2x_subs_list</span><span class="o">=</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_sym</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">total_expr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">)]</span>
</span><span id="__span-0-1950"><a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>    <span class="k">return</span> <span class="n">t2x_subs_list</span>
</span><span id="__span-0-1951"><a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>
</span><span id="__span-0-1952"><a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">subs_list_xc2xak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-1953"><a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="p">,</span> <span class="s2">&quot;this operation requires the binding network to be atomic&quot;</span>
</span><span id="__span-0-1954"><a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>    <span class="n">l2_mat_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat_sym</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">:]</span>
</span><span id="__span-0-1955"><a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>    <span class="n">n2_mat_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat_sym</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">:]</span>
</span><span id="__span-0-1956"><a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>    <span class="n">xa_sym_vec</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">])</span>
</span><span id="__span-0-1957"><a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>    <span class="n">xa_sym_log</span><span class="o">=</span><span class="n">xa_sym_vec</span><span class="o">.</span><span class="n">applyfunc</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
</span><span id="__span-0-1958"><a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>    <span class="n">xc2xak_log_expr</span><span class="o">=</span><span class="n">l2_mat_sym</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">xa_sym_log</span><span class="o">+</span><span class="n">n2_mat_sym</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_sym</span><span class="p">)</span><span class="o">.</span><span class="n">applyfunc</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
</span><span id="__span-0-1959"><a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>    <span class="n">func_exponentiate</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">sp</span><span class="o">.</span><span class="n">E</span><span class="o">**</span><span class="n">x</span>
</span><span id="__span-0-1960"><a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>    <span class="n">xc2xak_expr</span><span class="o">=</span><span class="n">xc2xak_log_expr</span><span class="o">.</span><span class="n">applyfunc</span><span class="p">(</span><span class="n">func_exponentiate</span><span class="p">)</span>
</span><span id="__span-0-1961"><a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>    <span class="n">xc2xak_subs_list</span><span class="o">=</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="o">+</span><span class="n">i</span><span class="p">],</span><span class="n">xc2xak_expr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span><span class="p">)]</span>
</span><span id="__span-0-1962"><a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>    <span class="k">return</span> <span class="n">xc2xak_subs_list</span>
</span><span id="__span-0-1963"><a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>
</span><span id="__span-0-1964"><a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">t2x_sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-0-1965"><a id="__codelineno-0-1965" name="__codelineno-0-1965"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1966"><a id="__codelineno-0-1966" name="__codelineno-0-1966"></a><span class="sd">    Input a symbolic expression containing totals t, and map it to x.</span>
</span><span id="__span-0-1967"><a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>
</span><span id="__span-0-1968"><a id="__codelineno-0-1968" name="__codelineno-0-1968"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1969"><a id="__codelineno-0-1969" name="__codelineno-0-1969"></a><span class="sd">        expr (sympy symbolic expression): A symbolic expression to be converted.</span>
</span><span id="__span-0-1970"><a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>
</span><span id="__span-0-1971"><a id="__codelineno-0-1971" name="__codelineno-0-1971"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1972"><a id="__codelineno-0-1972" name="__codelineno-0-1972"></a><span class="sd">        sympy symbolic expression: The symbolic expression after conversion.</span>
</span><span id="__span-0-1973"><a id="__codelineno-0-1973" name="__codelineno-0-1973"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1974"><a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>    <span class="c1"># calculate the substitutions map for totals to species</span>
</span><span id="__span-0-1975"><a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">expr_x</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2x</span><span class="p">)</span>
</span><span id="__span-0-1976"><a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-1977"><a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>      <span class="n">t2x_subs_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subs_list_t2x</span><span class="p">()</span>
</span><span id="__span-0-1978"><a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">t2x</span><span class="o">=</span><span class="n">t2x_subs_list</span>
</span><span id="__span-0-1979"><a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>      <span class="n">expr_x</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2x</span><span class="p">)</span>
</span><span id="__span-0-1980"><a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>    <span class="k">return</span> <span class="n">expr_x</span>
</span><span id="__span-0-1981"><a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>
</span><span id="__span-0-1982"><a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">xc2xak_sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-0-1983"><a id="__codelineno-0-1983" name="__codelineno-0-1983"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1984"><a id="__codelineno-0-1984" name="__codelineno-0-1984"></a><span class="sd">    Input a symbolic expression containing complex species x^c, and map it to x^a and k.</span>
</span><span id="__span-0-1985"><a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>
</span><span id="__span-0-1986"><a id="__codelineno-0-1986" name="__codelineno-0-1986"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1987"><a id="__codelineno-0-1987" name="__codelineno-0-1987"></a><span class="sd">        expr (sympy symbolic expression): A symbolic expression to be converted.</span>
</span><span id="__span-0-1988"><a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>
</span><span id="__span-0-1989"><a id="__codelineno-0-1989" name="__codelineno-0-1989"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1990"><a id="__codelineno-0-1990" name="__codelineno-0-1990"></a><span class="sd">        sympy symbolic expression: The symbolic expression after conversion.</span>
</span><span id="__span-0-1991"><a id="__codelineno-0-1991" name="__codelineno-0-1991"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1992"><a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="p">,</span> <span class="s2">&quot;this operation requires the binding network to be atomic&quot;</span>
</span><span id="__span-0-1993"><a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>    <span class="c1"># calculate the substitutions map for complex species to atomic species and k&#39;s, if it does not exist.</span>
</span><span id="__span-0-1994"><a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">expr_xak</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc2xak</span><span class="p">)</span>
</span><span id="__span-0-1995"><a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-1996"><a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>      <span class="n">xc2xak_subs_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subs_list_xc2xak</span><span class="p">()</span>
</span><span id="__span-0-1997"><a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">xc2xak</span><span class="o">=</span><span class="n">xc2xak_subs_list</span>
</span><span id="__span-0-1998"><a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>      <span class="n">expr_xak</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc2xak</span><span class="p">)</span>
</span><span id="__span-0-1999"><a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>    <span class="k">return</span> <span class="n">expr_xak</span>
</span><span id="__span-0-2000"><a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>
</span><span id="__span-0-2001"><a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">logder_sym_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">b_vec_sym</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-2002"><a id="__codelineno-0-2002" name="__codelineno-0-2002"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-2003"><a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><span class="sd">    Compute the log derivative of a linear sum of x, i.e. dlog(b_vec_sym * x)/dlog(tp, k), where tp = a_mat * x.</span>
</span><span id="__span-0-2004"><a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>
</span><span id="__span-0-2005"><a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2006"><a id="__codelineno-0-2006" name="__codelineno-0-2006"></a><span class="sd">        b_vec_sym (sympy symbolic vector): A vector of symbolic expressions corresponding to coefficients to be summed. Shape is (n, 1).</span>
</span><span id="__span-0-2007"><a id="__codelineno-0-2007" name="__codelineno-0-2007"></a><span class="sd">        a_mat (numpy array, optional): The matrix denoting the variables a_mat * x that the log derivative is taken with respect to.</span>
</span><span id="__span-0-2008"><a id="__codelineno-0-2008" name="__codelineno-0-2008"></a><span class="sd">            Defaults to self.l_mat.</span>
</span><span id="__span-0-2009"><a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>
</span><span id="__span-0-2010"><a id="__codelineno-0-2010" name="__codelineno-0-2010"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2011"><a id="__codelineno-0-2011" name="__codelineno-0-2011"></a><span class="sd">        sympy vector: The symbolic log derivative dlog(b_vec_sym * x)/dlog(tp, k), where tp = a_mat * x.</span>
</span><span id="__span-0-2012"><a id="__codelineno-0-2012" name="__codelineno-0-2012"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2013"><a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1"># no a_mat argument is given</span>
</span><span id="__span-0-2014"><a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>      <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-2015"><a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>    <span class="c1"># check if logder is already calculated with respect to this a_mat.</span>
</span><span id="__span-0-2016"><a id="__codelineno-0-2016" name="__codelineno-0-2016"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">ld_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ld_sym_dict</span><span class="p">[</span><span class="n">a_mat</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()]</span>
</span><span id="__span-0-2017"><a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="c1"># not calculated yet</span>
</span><span id="__span-0-2018"><a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Symbolic logder for this chart coordinate does not exist, calculating...&#39;</span><span class="p">)</span>
</span><span id="__span-0-2019"><a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>      <span class="n">ld_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_sym</span><span class="p">(</span><span class="n">a_mat</span><span class="o">=</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-2020"><a id="__codelineno-0-2020" name="__codelineno-0-2020"></a>    <span class="n">coeff_vec_sym</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">b_vec_sym</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="__span-0-2021"><a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>    <span class="n">bx</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">matrix_multiply_elementwise</span><span class="p">(</span><span class="n">b_vec_sym</span><span class="p">,</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">))</span> <span class="c1">#b multiply x element-wise</span>
</span><span id="__span-0-2022"><a id="__codelineno-0-2022" name="__codelineno-0-2022"></a>    <span class="n">bx_sum</span> <span class="o">=</span> <span class="n">bx</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="o">*</span><span class="n">bx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-2023"><a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>    <span class="n">coeff_vec_sym</span><span class="o">=</span><span class="n">bx</span><span class="o">*</span><span class="n">bx_sum</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># convex coefficients for the log derivative sum</span>
</span><span id="__span-0-2024"><a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>    <span class="n">ld_sym_sum</span><span class="o">=</span><span class="p">(</span><span class="n">ld_sym</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">coeff_vec_sym</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="c1"># for logder matrix ld_sym, rows are species, columns are variables.</span>
</span><span id="__span-0-2025"><a id="__codelineno-0-2025" name="__codelineno-0-2025"></a>    <span class="k">return</span> <span class="n">ld_sym_sum</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">n_mat</span><span class="p">,</span> <span class="n">l_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">is_atomic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">t_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">k_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initiate a binding network.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The stoichiometry matrix defining the binding network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_atomic</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is the binding network atomic or not. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>l_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The conservation law matrix defining the conserved total quantities.
If not given, and is_atomic is True, then it will be computed from n_mat. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_sym</code>
            </td>
            <td>
                  <code>list of symbols</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An ordered list of symbols for the chemical species, denoting columns of the n_mat and l_mat. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_sym</code>
            </td>
            <td>
                  <code>list of symbols</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An ordered list of symbols for the total or conserved quantities, denoting rows of the l_mat. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>k_sym</code>
            </td>
            <td>
                  <code>list of symbols</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An ordered list of symbols for the binding constants in the dissociation direction, denoting rows of the n_mat. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>             <span class="n">n_mat</span><span class="p">,</span>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>             <span class="n">l_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>             <span class="n">is_atomic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>             <span class="n">x_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>             <span class="n">t_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>             <span class="n">k_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">  Initiate a binding network.</span>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">      n_mat (numpy array): The stoichiometry matrix defining the binding network.</span>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">      is_atomic (bool, optional): Is the binding network atomic or not. Defaults to None.</span>
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">      l_mat (numpy array, optional): The conservation law matrix defining the conserved total quantities.</span>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">          If not given, and is_atomic is True, then it will be computed from n_mat. Defaults to None.</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">      x_sym (list of symbols, optional): An ordered list of symbols for the chemical species, denoting columns of the n_mat and l_mat. Defaults to None.</span>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">      t_sym (list of symbols, optional): An ordered list of symbols for the total or conserved quantities, denoting rows of the l_mat. Defaults to None.</span>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">      k_sym (list of symbols, optional): An ordered list of symbols for the binding constants in the dissociation direction, denoting rows of the n_mat. Defaults to None.</span>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="o">=</span><span class="n">is_atomic</span>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="o">=</span><span class="n">n_mat</span>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">n_mat_sym</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">n_mat</span><span class="p">)</span>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">l_mat</span><span class="p">):</span> <span class="c1">#no input l_mat</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>    <span class="n">l_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_from_n</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">)</span>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">l_mat</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>  <span class="c1"># if no input symbols for the x,t,k variables then give them default numerically ordered ones.</span>
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">x_sym</span><span class="p">):</span>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>    <span class="n">x_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">t_sym</span><span class="p">):</span>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>    <span class="n">t_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;t:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">))</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">k_sym</span><span class="p">):</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>    <span class="n">k_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;k:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span><span class="p">))</span>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="o">=</span><span class="n">l_mat</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">l_mat_sym</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">l_mat</span><span class="p">)</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="o">=</span><span class="n">x_sym</span>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">t_sym</span><span class="o">=</span><span class="n">t_sym</span>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">k_sym</span><span class="o">=</span><span class="n">k_sym</span>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">tk_sym</span><span class="o">=</span><span class="n">t_sym</span><span class="o">+</span><span class="n">k_sym</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">opt_var</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">)</span>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span><span class="p">))</span>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">ld_sym_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">activity_regime_constrained_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">activity_ld_regime_constrained_dict</span><span class="o">=</span><span class="p">{}</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.l_from_n" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">l_from_n</span><span class="p">(</span><span class="n">n_mat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>If the network is atomic, compute the L matrix from the N matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The stoichiometry matrix defining the binding network.
Assumes the columns are ordered so that the atomic species come first.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy array: The conservation law or totals matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="k">def</span><span class="w"> </span><span class="nf">l_from_n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_mat</span><span class="p">):</span>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">  If the network is atomic, compute the L matrix from the N matrix.</span>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">      n_mat (numpy array): The stoichiometry matrix defining the binding network.</span>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">          Assumes the columns are ordered so that the atomic species come first.</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">      numpy array: The conservation law or totals matrix.</span>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>  <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>  <span class="n">r</span><span class="o">=</span><span class="n">n_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>  <span class="n">d</span><span class="o">=</span><span class="n">n_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">r</span>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>  <span class="n">n1_mat</span><span class="o">=</span><span class="n">n_mat</span><span class="p">[:,:</span><span class="n">d</span><span class="p">]</span>
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>  <span class="n">n2_mat</span><span class="o">=</span><span class="n">n_mat</span><span class="p">[:,</span><span class="o">-</span><span class="n">r</span><span class="p">:]</span>
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>  <span class="n">l2_mat</span><span class="o">=-</span><span class="p">(</span><span class="n">n1_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">n2_mat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>  <span class="n">l_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="n">l2_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>  <span class="k">return</span> <span class="n">l_mat</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_activity_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_activity_num</span><span class="p">(</span><span class="n">b_vec</span><span class="p">,</span> <span class="n">logx_array</span><span class="p">,</span> <span class="n">ld_mat_array</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Given a logder matrix, compute the logder of b^T x.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>b_vec</code>
            </td>
            <td>
                  <code>numpy vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector indicating which species are included in the catalytic activity. Shape is (dim_n,).
All entries are non-negative, with at least one nonzero.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logx_array</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of logx-vector indicating the point at which the logder is evaluated. Shape is (n_points, dim_n).
log is base 10.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ld_mat_array</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of n x n matrix for dlogx/dlog(t, k) at point x on the manifold. Shape is (n_points, dim_n, dim_n).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ndarray</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of vectors for dlog(b^T x)/dlog(t, k). Shape is (n_points, dim_n).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_activity_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">logx_array</span><span class="p">,</span><span class="n">ld_mat_array</span><span class="p">):</span>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1267"><a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">  Given a logder matrix, compute the logder of b^T x.</span>
</span><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">      b_vec (numpy vector): Vector indicating which species are included in the catalytic activity. Shape is (dim_n,).</span>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">          All entries are non-negative, with at least one nonzero.</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">      logx_array (ndarray): Array of logx-vector indicating the point at which the logder is evaluated. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1273"><a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">          log is base 10.</span>
</span><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">      ld_mat_array (ndarray): Array of n x n matrix for dlogx/dlog(t, k) at point x on the manifold. Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">      ndarray: Array of vectors for dlog(b^T x)/dlog(t, k). Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1279"><a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>  <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">b_vec</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;all entries of b_vec should be non-negative.&quot;</span>
</span><span id="__span-0-1280"><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>  <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;there should be at least one nonzero entry in b_vec.&quot;</span>
</span><span id="__span-0-1281"><a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>  <span class="n">x_array</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">logx_array</span> <span class="c1"># shape (n_points,dim_n)</span>
</span><span id="__span-0-1282"><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>  <span class="n">bx_array</span><span class="o">=</span><span class="n">x_array</span><span class="o">*</span><span class="n">b_vec</span> <span class="c1"># each row element-wise product with b_vec</span>
</span><span id="__span-0-1283"><a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>  <span class="c1"># so bx_array has shape (n_points,dim_n)</span>
</span><span id="__span-0-1284"><a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>  <span class="n">coeff</span><span class="o">=</span><span class="p">(</span><span class="n">bx_array</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">bx_array</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span> <span class="c1"># shape (n_points,dim_n)</span>
</span><span id="__span-0-1285"><a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>  <span class="n">npts</span><span class="o">=</span><span class="n">logx_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1286"><a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>
</span><span id="__span-0-1287"><a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>  <span class="c1"># One implementation is iterate and sum, this is slow (not really?).</span>
</span><span id="__span-0-1288"><a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>  <span class="n">ld_activity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">npts</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-1289"><a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1290"><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>    <span class="n">ld_activity</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">coeff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ld_mat_array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-0-1291"><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
</span><span id="__span-0-1292"><a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>  <span class="c1"># Another implementation is directly writing out the product</span>
</span><span id="__span-0-1293"><a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>  <span class="c1"># coeff_temp=np.repeat(coeff[:,:,np.newaxis],self.dim_n,axis=2)</span>
</span><span id="__span-0-1294"><a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>  <span class="c1"># ld_activity=(ld_mat_array*coeff_temp).sum(-1)</span>
</span><span id="__span-0-1295"><a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>
</span><span id="__span-0-1296"><a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>  <span class="c1"># Yet another way is to use einsum. Will do these if speed is a problem.</span>
</span><span id="__span-0-1297"><a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
</span><span id="__span-0-1298"><a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>  <span class="k">return</span> <span class="n">ld_activity</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the numerical log derivative of the binding network at points specified by logvar in the specified chart and dominance a_mat.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logvar</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of the points to evaluate the log derivatives at, in base-10 log. Shape is (n_points, dim_n).
In chart 'x', for example, this is logx.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifying the chart that logvar is specified in. Could be 'x', 'xak', or 'tk'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix defining the variables log derivative is taken in terms of.
Assumes all entries are non-negative, and each row has at least one positive entry.
Optional, defaults to l_mat of the binding network.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>logder</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.
Shape is (n_points, dim_n, dim_n).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>logx</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).
This is returned since all input variables, regardless of chart, are mapped to the logx chart first.
Returned for convenience.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logvar</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">  Compute the numerical log derivative of the binding network at points specified by logvar in the specified chart and dominance a_mat.</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">      logvar (ndarray): Array of the points to evaluate the log derivatives at, in base-10 log. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">          In chart &#39;x&#39;, for example, this is logx.</span>
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">      chart (str): Specifying the chart that logvar is specified in. Could be &#39;x&#39;, &#39;xak&#39;, or &#39;tk&#39;.</span>
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">      a_mat (numpy array, optional): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">          Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">          Optional, defaults to l_mat of the binding network.</span>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">      logder (ndarray): Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">          Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">      logx (ndarray): Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">          This is returned since all input variables, regardless of chart, are mapped to the logx chart first.</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">          Returned for convenience.</span>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>  <span class="c1"># first check a_mat makes sense.</span>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1"># no a_mat argument is given</span>
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>    <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>    <span class="k">assert</span> <span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;the shape of L matrix should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="si">}</span><span class="s2"> by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;all entries of A matrix should be non-negative.&quot;</span>
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;each row of A matrix should have at least one positive entry.&quot;</span>
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>  <span class="c1"># for different charts, use different functions to evaluate</span>
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>  <span class="n">npts</span><span class="o">=</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>  <span class="k">assert</span> <span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span> <span class="s1">&#39;shape of logvar should be num_points-by-dim_n&#39;</span>
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>  <span class="n">logders</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>  <span class="k">if</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>      <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>    <span class="n">logx</span><span class="o">=</span><span class="n">logvar</span>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>  <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;xak&#39;</span><span class="p">:</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="p">,</span> <span class="s1">&#39;the binding network is not atomic, cannot use xak chart&#39;</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>    <span class="n">logx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>      <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_xak_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>  <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;tk&#39;</span><span class="p">:</span>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>    <span class="n">logx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>      <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_tk_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>  <span class="k">else</span><span class="p">:</span> 
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;chart that is not one of &quot;x,xak,tk&quot; is not implemented yet&#39;</span><span class="p">)</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>  <span class="k">return</span> <span class="n">logders</span><span class="p">,</span><span class="n">logx</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_sym" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_sym</span><span class="p">(</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">is_saved</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the symbolic log derivative matrix of dlog(x)/dlog(a_mat @ x, k).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix defining the variables log derivative is taken in terms of.
Assumes all entries are non-negative, and each row has at least one positive entry.
Optional, defaults to l_mat of the binding network.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_saved</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>To save the resulting logdermat as parameter ld_sym of the binding network or not.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>sympy.Matrix: Symbolic log derivative matrix for x to (t_sym_temp, k_sym) expressed in terms of x.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>If the provided a_mat yields a noninvertible matrix, then the function will return logdermat as a matrix of zeros (with the appropriate size).</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1899"><a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span><span class="n">is_saved</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-1900"><a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1901"><a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><span class="sd">  Calculate the symbolic log derivative matrix of dlog(x)/dlog(a_mat @ x, k).</span>
</span><span id="__span-0-1902"><a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>
</span><span id="__span-0-1903"><a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1904"><a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><span class="sd">      a_mat (numpy array, optional): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1905"><a id="__codelineno-0-1905" name="__codelineno-0-1905"></a><span class="sd">          Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1906"><a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">          Optional, defaults to l_mat of the binding network.</span>
</span><span id="__span-0-1907"><a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><span class="sd">      is_saved (bool, optional): To save the resulting logdermat as parameter ld_sym of the binding network or not.</span>
</span><span id="__span-0-1908"><a id="__codelineno-0-1908" name="__codelineno-0-1908"></a><span class="sd">          Defaults to True.</span>
</span><span id="__span-0-1909"><a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>
</span><span id="__span-0-1910"><a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1911"><a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">      sympy.Matrix: Symbolic log derivative matrix for x to (t_sym_temp, k_sym) expressed in terms of x.</span>
</span><span id="__span-0-1912"><a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>
</span><span id="__span-0-1913"><a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><span class="sd">  Note:</span>
</span><span id="__span-0-1914"><a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><span class="sd">      If the provided a_mat yields a noninvertible matrix, then the function will return logdermat as a matrix of zeros (with the appropriate size).</span>
</span><span id="__span-0-1915"><a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1916"><a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1"># no a_mat argument is given</span>
</span><span id="__span-0-1917"><a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>    <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-1918"><a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1919"><a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>    <span class="k">assert</span> <span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;the shape of L matrix should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="si">}</span><span class="s2"> by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-0-1920"><a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;all entries of A matrix should be non-negative.&quot;</span>
</span><span id="__span-0-1921"><a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;each row of A matrix should have at least one positive entry.&quot;</span>
</span><span id="__span-0-1922"><a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>
</span><span id="__span-0-1923"><a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>  <span class="n">a_mat_sym</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1924"><a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>  <span class="n">n_mat_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat_sym</span>
</span><span id="__span-0-1925"><a id="__codelineno-0-1925" name="__codelineno-0-1925"></a>
</span><span id="__span-0-1926"><a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>  <span class="c1">#it&#39;s much faster (10x) to use a dummy &quot;total&quot; variables to calculate matrix inverse,</span>
</span><span id="__span-0-1927"><a id="__codelineno-0-1927" name="__codelineno-0-1927"></a>  <span class="c1"># and then substitute the expression for the totals in terms of x, rather than</span>
</span><span id="__span-0-1928"><a id="__codelineno-0-1928" name="__codelineno-0-1928"></a>  <span class="c1"># inverting with the totals explicitly expressed in x variables.</span>
</span><span id="__span-0-1929"><a id="__codelineno-0-1929" name="__codelineno-0-1929"></a>
</span><span id="__span-0-1930"><a id="__codelineno-0-1930" name="__codelineno-0-1930"></a>  <span class="n">temp_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;t:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">))</span>
</span><span id="__span-0-1931"><a id="__codelineno-0-1931" name="__codelineno-0-1931"></a>
</span><span id="__span-0-1932"><a id="__codelineno-0-1932" name="__codelineno-0-1932"></a>  <span class="n">Lam_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">*</span><span class="n">temp_sym</span><span class="p">)</span>
</span><span id="__span-0-1933"><a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>  <span class="n">Lam_x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">)</span>
</span><span id="__span-0-1934"><a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>
</span><span id="__span-0-1935"><a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>  <span class="n">topmat</span> <span class="o">=</span> <span class="n">Lam_t</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">a_mat_sym</span> <span class="o">*</span> <span class="n">Lam_x</span>
</span><span id="__span-0-1936"><a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>  <span class="n">fullmat</span> <span class="o">=</span> <span class="n">topmat</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">n_mat_sym</span><span class="p">)</span>
</span><span id="__span-0-1937"><a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>
</span><span id="__span-0-1938"><a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>  <span class="n">logdermat_t</span> <span class="o">=</span> <span class="n">fullmat</span><span class="o">**-</span><span class="mi">1</span>
</span><span id="__span-0-1939"><a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>
</span><span id="__span-0-1940"><a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>  <span class="n">temp_expr</span><span class="o">=</span><span class="n">a_mat_sym</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">)</span>
</span><span id="__span-0-1941"><a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>  <span class="n">temp2x_subs_list</span><span class="o">=</span><span class="p">[(</span><span class="n">temp_sym</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">temp_expr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">)]</span>
</span><span id="__span-0-1942"><a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>  <span class="n">logdermat</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">logdermat_t</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">temp2x_subs_list</span><span class="p">))</span>
</span><span id="__span-0-1943"><a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>
</span><span id="__span-0-1944"><a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>  <span class="k">if</span> <span class="n">is_saved</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ld_sym_dict</span><span class="p">[</span><span class="n">a_mat</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()]</span><span class="o">=</span><span class="n">logdermat</span>
</span><span id="__span-0-1945"><a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>  <span class="k">return</span> <span class="n">logdermat</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_sym_activity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_sym_activity</span><span class="p">(</span><span class="n">b_vec_sym</span><span class="p">,</span> <span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the log derivative of a linear sum of x, i.e. dlog(b_vec_sym * x)/dlog(tp, k), where tp = a_mat * x.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>b_vec_sym</code>
            </td>
            <td>
                  <code>sympy symbolic vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A vector of symbolic expressions corresponding to coefficients to be summed. Shape is (n, 1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix denoting the variables a_mat * x that the log derivative is taken with respect to.
Defaults to self.l_mat.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>sympy vector: The symbolic log derivative dlog(b_vec_sym * x)/dlog(tp, k), where tp = a_mat * x.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2001"><a id="__codelineno-0-2001" name="__codelineno-0-2001"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_sym_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">b_vec_sym</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-2002"><a id="__codelineno-0-2002" name="__codelineno-0-2002"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-2003"><a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><span class="sd">  Compute the log derivative of a linear sum of x, i.e. dlog(b_vec_sym * x)/dlog(tp, k), where tp = a_mat * x.</span>
</span><span id="__span-0-2004"><a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>
</span><span id="__span-0-2005"><a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><span class="sd">  Args:</span>
</span><span id="__span-0-2006"><a id="__codelineno-0-2006" name="__codelineno-0-2006"></a><span class="sd">      b_vec_sym (sympy symbolic vector): A vector of symbolic expressions corresponding to coefficients to be summed. Shape is (n, 1).</span>
</span><span id="__span-0-2007"><a id="__codelineno-0-2007" name="__codelineno-0-2007"></a><span class="sd">      a_mat (numpy array, optional): The matrix denoting the variables a_mat * x that the log derivative is taken with respect to.</span>
</span><span id="__span-0-2008"><a id="__codelineno-0-2008" name="__codelineno-0-2008"></a><span class="sd">          Defaults to self.l_mat.</span>
</span><span id="__span-0-2009"><a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>
</span><span id="__span-0-2010"><a id="__codelineno-0-2010" name="__codelineno-0-2010"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-2011"><a id="__codelineno-0-2011" name="__codelineno-0-2011"></a><span class="sd">      sympy vector: The symbolic log derivative dlog(b_vec_sym * x)/dlog(tp, k), where tp = a_mat * x.</span>
</span><span id="__span-0-2012"><a id="__codelineno-0-2012" name="__codelineno-0-2012"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-2013"><a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1"># no a_mat argument is given</span>
</span><span id="__span-0-2014"><a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>    <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-2015"><a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>  <span class="c1"># check if logder is already calculated with respect to this a_mat.</span>
</span><span id="__span-0-2016"><a id="__codelineno-0-2016" name="__codelineno-0-2016"></a>  <span class="k">try</span><span class="p">:</span> <span class="n">ld_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ld_sym_dict</span><span class="p">[</span><span class="n">a_mat</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()]</span>
</span><span id="__span-0-2017"><a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>  <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="c1"># not calculated yet</span>
</span><span id="__span-0-2018"><a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Symbolic logder for this chart coordinate does not exist, calculating...&#39;</span><span class="p">)</span>
</span><span id="__span-0-2019"><a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>    <span class="n">ld_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_sym</span><span class="p">(</span><span class="n">a_mat</span><span class="o">=</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-2020"><a id="__codelineno-0-2020" name="__codelineno-0-2020"></a>  <span class="n">coeff_vec_sym</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">b_vec_sym</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="__span-0-2021"><a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>  <span class="n">bx</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">matrix_multiply_elementwise</span><span class="p">(</span><span class="n">b_vec_sym</span><span class="p">,</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_sym</span><span class="p">))</span> <span class="c1">#b multiply x element-wise</span>
</span><span id="__span-0-2022"><a id="__codelineno-0-2022" name="__codelineno-0-2022"></a>  <span class="n">bx_sum</span> <span class="o">=</span> <span class="n">bx</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="o">*</span><span class="n">bx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-2023"><a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>  <span class="n">coeff_vec_sym</span><span class="o">=</span><span class="n">bx</span><span class="o">*</span><span class="n">bx_sum</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># convex coefficients for the log derivative sum</span>
</span><span id="__span-0-2024"><a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>  <span class="n">ld_sym_sum</span><span class="o">=</span><span class="p">(</span><span class="n">ld_sym</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">coeff_vec_sym</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="c1"># for logder matrix ld_sym, rows are species, columns are variables.</span>
</span><span id="__span-0-2025"><a id="__codelineno-0-2025" name="__codelineno-0-2025"></a>  <span class="k">return</span> <span class="n">ld_sym_sum</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_tk2x_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_tk2x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the numerical dlog(t, k)/dlog(x) log derivative of the binding network at points specified by logvar in the specified chart and dominance a_mat.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logvar</code>
            </td>
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of the points to evaluate the log derivatives at, in base-10 log. Shape is (n_points, dim_n).
In chart 'x', for example, this is logx.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifying the chart that logvar is specified in. Could be 'x', 'xak', or 'tk'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix defining the variables log derivative is taken in terms of.
Assumes all entries are non-negative, and each row has at least one positive entry.
Optional, defaults to l_mat of the binding network.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>logder</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of n-by-n matrix of log derivative of (t, k) to x, where t = a_mat @ x, and n is the number of species.
Shape is (n_points, dim_n, dim_n).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>logx</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).
This is returned since all input variables, regardless of chart, are mapped to the logx chart first.
Returned for convenience.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_tk2x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logvar</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">  Compute the numerical dlog(t, k)/dlog(x) log derivative of the binding network at points specified by logvar in the specified chart and dominance a_mat.</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">      logvar (ndarray): Array of the points to evaluate the log derivatives at, in base-10 log. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">          In chart &#39;x&#39;, for example, this is logx.</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">      chart (str): Specifying the chart that logvar is specified in. Could be &#39;x&#39;, &#39;xak&#39;, or &#39;tk&#39;.</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">      a_mat (numpy array, optional): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">          Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">          Optional, defaults to l_mat of the binding network.</span>
</span><span id="__span-0-1390"><a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>
</span><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">      logder (ndarray): Array of n-by-n matrix of log derivative of (t, k) to x, where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">          Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1394"><a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><span class="sd">      logx (ndarray): Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1395"><a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">          This is returned since all input variables, regardless of chart, are mapped to the logx chart first.</span>
</span><span id="__span-0-1396"><a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">          Returned for convenience.</span>
</span><span id="__span-0-1397"><a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1398"><a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>  <span class="c1"># first check a_mat makes sense.</span>
</span><span id="__span-0-1399"><a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1"># no a_mat argument is given</span>
</span><span id="__span-0-1400"><a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>    <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-1401"><a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1402"><a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>    <span class="k">assert</span> <span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;the shape of L matrix should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_d</span><span class="si">}</span><span class="s2"> by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-0-1403"><a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;all entries of A matrix should be non-negative.&quot;</span>
</span><span id="__span-0-1404"><a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;each row of A matrix should have at least one positive entry.&quot;</span>
</span><span id="__span-0-1405"><a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>  <span class="c1"># for different charts, use different functions to evaluate</span>
</span><span id="__span-0-1406"><a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>  <span class="n">npts</span><span class="o">=</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1407"><a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>  <span class="k">assert</span> <span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span> <span class="s1">&#39;shape of logvar should be num_points-by-dim_n&#39;</span>
</span><span id="__span-0-1408"><a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>  <span class="n">logders</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-1409"><a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>  <span class="k">if</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="__span-0-1410"><a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1411"><a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>      <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_tk2x_x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1412"><a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>    <span class="n">logx</span><span class="o">=</span><span class="n">logvar</span>
</span><span id="__span-0-1413"><a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>  <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;xak&#39;</span><span class="p">:</span>
</span><span id="__span-0-1414"><a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="p">,</span> <span class="s1">&#39;the binding network is not atomic, cannot use xak chart&#39;</span>
</span><span id="__span-0-1415"><a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>    <span class="n">logx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-1416"><a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1417"><a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>      <span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xak2x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-0-1418"><a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>      <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_tk2x_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1419"><a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>  <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;tk&#39;</span><span class="p">:</span>
</span><span id="__span-0-1420"><a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>    <span class="n">logx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-1421"><a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
</span><span id="__span-0-1422"><a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>      <span class="n">logx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk2x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1423"><a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>      <span class="n">logders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logder_tk2x_x_num</span><span class="p">(</span><span class="n">logvar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1424"><a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>  <span class="k">else</span><span class="p">:</span> 
</span><span id="__span-0-1425"><a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;chart that is not one of &quot;x,xak,tk&quot; is not implemented yet&#39;</span><span class="p">)</span>
</span><span id="__span-0-1426"><a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>  <span class="k">return</span> <span class="n">logders</span><span class="p">,</span><span class="n">logx</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_tk2x_x_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_tk2x_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">,</span> <span class="n">a_mat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the numerical dlog(t, k)/dlog(x) log derivative of the binding network at one point in chart x.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logx</code>
            </td>
            <td>
                  <code>numpy vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector of concentrations for all the species in log, base-10.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix defining the variables log derivative is taken in terms of.
Assumes all entries are non-negative, and each row has at least one positive entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ndarray</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of n-by-n matrix of log derivative of (t, k) to x, where t = a_mat @ x, and n is the number of species.
Shape is (n_points, dim_n, dim_n).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1428"><a id="__codelineno-0-1428" name="__codelineno-0-1428"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_tk2x_x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1429"><a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1430"><a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="sd">  Compute the numerical dlog(t, k)/dlog(x) log derivative of the binding network at one point in chart x.</span>
</span><span id="__span-0-1431"><a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>
</span><span id="__span-0-1432"><a id="__codelineno-0-1432" name="__codelineno-0-1432"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1433"><a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="sd">      logx (numpy vector): Vector of concentrations for all the species in log, base-10.</span>
</span><span id="__span-0-1434"><a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">      a_mat (numpy array): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1435"><a id="__codelineno-0-1435" name="__codelineno-0-1435"></a><span class="sd">          Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1436"><a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>
</span><span id="__span-0-1437"><a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1438"><a id="__codelineno-0-1438" name="__codelineno-0-1438"></a><span class="sd">      ndarray: Array of n-by-n matrix of log derivative of (t, k) to x, where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1439"><a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">          Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1440"><a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1441"><a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>  <span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">logx</span>
</span><span id="__span-0-1442"><a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>  <span class="n">t_inv</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-0-1443"><a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>  <span class="n">temp</span><span class="o">=</span><span class="n">a_mat</span><span class="o">*</span><span class="n">x</span>
</span><span id="__span-0-1444"><a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>  <span class="n">upper</span><span class="o">=</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">t_inv</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="__span-0-1445"><a id="__codelineno-0-1445" name="__codelineno-0-1445"></a>  <span class="n">logder</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">upper</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1446"><a id="__codelineno-0-1446" name="__codelineno-0-1446"></a>  <span class="k">return</span> <span class="n">logder</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_tk_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_tk_num</span><span class="p">(</span><span class="n">logtk</span><span class="p">,</span> <span class="n">a_mat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the numerical log derivative of dlog(x)/dlog(a_mat @ x, k) at a point specified by log(t, k), where t = a_mat @ x is the concentration of atomic species, and k is the binding constants. log is base 10.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logtk</code>
            </td>
            <td>
                  <code>numpy vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector numerical value for total concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).
log is base 10.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix defining the variables log derivative is taken in terms of.
Assumes all entries are non-negative, and each row has at least one positive entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>logder</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.
Shape is (n_points, dim_n, dim_n).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>logx</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).
This is returned since all input variables, regardless of chart, are mapped to the logx chart first.
Returned for convenience.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_tk_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logtk</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">  Compute the numerical log derivative of dlog(x)/dlog(a_mat @ x, k) at a point specified by log(t, k), where t = a_mat @ x is the concentration of atomic species, and k is the binding constants. log is base 10.</span>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">      logtk (numpy vector): Vector numerical value for total concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).</span>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">          log is base 10.</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">      a_mat (numpy array): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">          Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">      logder (ndarray): Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">          Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">      logx (ndarray): Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">          This is returned since all input variables, regardless of chart, are mapped to the logx chart first.</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">          Returned for convenience.</span>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>  <span class="n">logx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tk2x_num</span><span class="p">(</span><span class="n">logtk</span><span class="p">,</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">),</span><span class="n">logx</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_x_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">,</span> <span class="n">a_mat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the numerical log derivative of the binding network at one point in chart x.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logx</code>
            </td>
            <td>
                  <code>numpy vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector of concentrations for all the species in log, base-10.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix defining the variables log derivative is taken in terms of.
Assumes all entries are non-negative, and each row has at least one positive entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ndarray</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.
Shape is (n_points, dim_n, dim_n).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">  Compute the numerical log derivative of the binding network at one point in chart x.</span>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">      logx (numpy vector): Vector of concentrations for all the species in log, base-10.</span>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">      a_mat (numpy array): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="sd">          Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">      ndarray: Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">          Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>  <span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">logx</span>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>  <span class="n">t_inv</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>  <span class="n">temp</span><span class="o">=</span><span class="n">a_mat</span><span class="o">*</span><span class="n">x</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>  <span class="n">upper</span><span class="o">=</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">t_inv</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>  <span class="n">logder_inv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">upper</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>  <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>    <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">logder_inv</span><span class="p">)</span>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>  <span class="k">except</span><span class="p">:</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">t_inv</span><span class="p">)</span>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">logder_inv</span><span class="p">)</span>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">logder_inv</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.logder_xak_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logder_xak_num</span><span class="p">(</span><span class="n">logxak</span><span class="p">,</span> <span class="n">a_mat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the numerical log derivative of dlog(x)/dlog(a_mat * x, k) at a point specified by log(xa, k), where xa is the concentration of atomic species, and k is the binding constants. log is base 10.
    Assumes the network is atomic, and n_mat, a_mat have atomic species coming first.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logxak</code>
            </td>
            <td>
                  <code>numpy vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector numerical value for atomic species concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).
log is base 10.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix defining the variables log derivative is taken in terms of.
Assumes all entries are non-negative, and each row has at least one positive entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>logder</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.
Shape is (n_points, dim_n, dim_n).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>logx</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).
This is returned since all input variables, regardless of chart, are mapped to the logx chart first.
Returned for convenience.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="k">def</span><span class="w"> </span><span class="nf">logder_xak_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logxak</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">  Compute the numerical log derivative of dlog(x)/dlog(a_mat * x, k) at a point specified by log(xa, k), where xa is the concentration of atomic species, and k is the binding constants. log is base 10.</span>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">      Assumes the network is atomic, and n_mat, a_mat have atomic species coming first.</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">      logxak (numpy vector): Vector numerical value for atomic species concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).</span>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">          log is base 10.</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">      a_mat (numpy array): Matrix defining the variables log derivative is taken in terms of.</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">          Assumes all entries are non-negative, and each row has at least one positive entry.</span>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">      logder (ndarray): Array of n-by-n matrix of log derivative of x to (t, k), where t = a_mat @ x, and n is the number of species.</span>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">          Shape is (n_points, dim_n, dim_n).</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">      logx (ndarray): Array of logx that the logvar points correspond to. Shape is (n_points, dim_n).</span>
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">          This is returned since all input variables, regardless of chart, are mapped to the logx chart first.</span>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">          Returned for convenience.</span>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>  <span class="c1">## commented out are old code that directly calculate logx, now we use stored map.</span>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>  <span class="c1"># d=self.dim_d</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>  <span class="c1"># logxa=logxak[:d]</span>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>  <span class="c1"># logk=logxak[d:]</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>  <span class="c1"># temp1=(a_mat.T).dot(logxa)</span>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>  <span class="c1"># n2_mat=self.n_mat[:,d:]</span>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>  <span class="c1"># temp2=np.linalg.inv(n2_mat).dot(logk)</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>  <span class="c1"># logx=temp1 + np.pad(temp2,(d,0),mode=&#39;constant&#39;,constant_values=(0,0))</span>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>  <span class="n">logx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xak2x_num</span><span class="p">(</span><span class="n">logxak</span><span class="p">)</span>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">),</span><span class="n">logx</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.sampling_over_activity_regime_hull" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sampling_over_activity_regime_hull</span><span class="p">(</span><span class="n">nsample</span><span class="p">,</span> <span class="n">b_tuple</span><span class="p">,</span> <span class="n">regime_key_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">is_finite_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_feasible_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span> <span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Randomly sample points in the log space of chart variables for each dom_regime for a given activity, but instead of log-uniform, we first assign points to each vertex in an even fashion, then sample uniformly within each vertex.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nsample</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of points to be sampled in the space of chart variables.
This is divided evenly to all the vertices of this binding network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b_tuple</code>
            </td>
            <td>
                  <code>tuple of length dim_n</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The b_tuple indicating the activity whose dom_regimes we are interested in sampling.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_finite_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, only finite dom_regimes are sampled.
If False, both finite and infinite dom_regimes are sampled. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regime_key_list</code>
            </td>
            <td>
                  <code>list of dominance regime&#39;s keys</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of keys for dom_regimes indexing the dom_regimes to be sampled.
e.g. [((0,1,2),7), ((0,1,3),7)]. If empty, sample all dom_regimes. Defaults to empty list [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_feasible_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, only feasible dom_regimes are sampled.
If False, all dom_regimes in regime_key_list (or all in this activity) are sampled.
Each dom_regime's is_feasible tag comes from results of the most recent feasibility test.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string indicating the chart that the opt_constraints are specified in.
Choices are 'x', 'xak', and 'tk'. Defaults to 'x'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>margin</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vertex's feasibility conditions are inequalities,
of the form c_mat * logx + c0_vec &gt; margin (e.g. in 'x' chart),
where margin is the positive threshold used here. Defaults to 0.
This can be adjusted to be stronger/weaker requirements on dominance.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmin</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to every variable.
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>-6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmax</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to every variable.
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of ndarray with shape (nsample, dim_n).
Key is the perm of each vertex. Value is the sample for that vertex.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1712"><a id="__codelineno-0-1712" name="__codelineno-0-1712"></a><span class="k">def</span><span class="w"> </span><span class="nf">sampling_over_activity_regime_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">b_tuple</span><span class="p">,</span><span class="n">regime_key_list</span><span class="o">=</span><span class="p">[],</span><span class="n">is_finite_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">is_feasible_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-1713"><a id="__codelineno-0-1713" name="__codelineno-0-1713"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1714"><a id="__codelineno-0-1714" name="__codelineno-0-1714"></a><span class="sd">  Randomly sample points in the log space of chart variables for each dom_regime for a given activity, but instead of log-uniform, we first assign points to each vertex in an even fashion, then sample uniformly within each vertex.</span>
</span><span id="__span-0-1715"><a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>
</span><span id="__span-0-1716"><a id="__codelineno-0-1716" name="__codelineno-0-1716"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1717"><a id="__codelineno-0-1717" name="__codelineno-0-1717"></a><span class="sd">      nsample (int): The number of points to be sampled in the space of chart variables.</span>
</span><span id="__span-0-1718"><a id="__codelineno-0-1718" name="__codelineno-0-1718"></a><span class="sd">          This is divided evenly to all the vertices of this binding network.</span>
</span><span id="__span-0-1719"><a id="__codelineno-0-1719" name="__codelineno-0-1719"></a><span class="sd">      b_tuple (tuple of length dim_n): The b_tuple indicating the activity whose dom_regimes we are interested in sampling.</span>
</span><span id="__span-0-1720"><a id="__codelineno-0-1720" name="__codelineno-0-1720"></a><span class="sd">      is_finite_only (bool, optional): If True, only finite dom_regimes are sampled.</span>
</span><span id="__span-0-1721"><a id="__codelineno-0-1721" name="__codelineno-0-1721"></a><span class="sd">          If False, both finite and infinite dom_regimes are sampled. Defaults to False.</span>
</span><span id="__span-0-1722"><a id="__codelineno-0-1722" name="__codelineno-0-1722"></a><span class="sd">      regime_key_list (list of dominance regime&#39;s keys, optional): The list of keys for dom_regimes indexing the dom_regimes to be sampled.</span>
</span><span id="__span-0-1723"><a id="__codelineno-0-1723" name="__codelineno-0-1723"></a><span class="sd">          e.g. [((0,1,2),7), ((0,1,3),7)]. If empty, sample all dom_regimes. Defaults to empty list [].</span>
</span><span id="__span-0-1724"><a id="__codelineno-0-1724" name="__codelineno-0-1724"></a><span class="sd">      is_feasible_only (bool, optional): If True, only feasible dom_regimes are sampled.</span>
</span><span id="__span-0-1725"><a id="__codelineno-0-1725" name="__codelineno-0-1725"></a><span class="sd">          If False, all dom_regimes in regime_key_list (or all in this activity) are sampled.</span>
</span><span id="__span-0-1726"><a id="__codelineno-0-1726" name="__codelineno-0-1726"></a><span class="sd">          Each dom_regime&#39;s is_feasible tag comes from results of the most recent feasibility test.</span>
</span><span id="__span-0-1727"><a id="__codelineno-0-1727" name="__codelineno-0-1727"></a><span class="sd">      chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-1728"><a id="__codelineno-0-1728" name="__codelineno-0-1728"></a><span class="sd">          Choices are &#39;x&#39;, &#39;xak&#39;, and &#39;tk&#39;. Defaults to &#39;x&#39;.</span>
</span><span id="__span-0-1729"><a id="__codelineno-0-1729" name="__codelineno-0-1729"></a><span class="sd">      margin (float, optional): The vertex&#39;s feasibility conditions are inequalities,</span>
</span><span id="__span-0-1730"><a id="__codelineno-0-1730" name="__codelineno-0-1730"></a><span class="sd">          of the form c_mat * logx + c0_vec &gt; margin (e.g. in &#39;x&#39; chart),</span>
</span><span id="__span-0-1731"><a id="__codelineno-0-1731" name="__codelineno-0-1731"></a><span class="sd">          where margin is the positive threshold used here. Defaults to 0.</span>
</span><span id="__span-0-1732"><a id="__codelineno-0-1732" name="__codelineno-0-1732"></a><span class="sd">          This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-1733"><a id="__codelineno-0-1733" name="__codelineno-0-1733"></a><span class="sd">      logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to every variable.</span>
</span><span id="__span-0-1734"><a id="__codelineno-0-1734" name="__codelineno-0-1734"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-1735"><a id="__codelineno-0-1735" name="__codelineno-0-1735"></a><span class="sd">      logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to every variable.</span>
</span><span id="__span-0-1736"><a id="__codelineno-0-1736" name="__codelineno-0-1736"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-1737"><a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>
</span><span id="__span-0-1738"><a id="__codelineno-0-1738" name="__codelineno-0-1738"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1739"><a id="__codelineno-0-1739" name="__codelineno-0-1739"></a><span class="sd">      dict: A dictionary of ndarray with shape (nsample, dim_n).</span>
</span><span id="__span-0-1740"><a id="__codelineno-0-1740" name="__codelineno-0-1740"></a><span class="sd">          Key is the perm of each vertex. Value is the sample for that vertex.</span>
</span><span id="__span-0-1741"><a id="__codelineno-0-1741" name="__codelineno-0-1741"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1742"><a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>  <span class="k">pass</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.sampling_over_vertex_hull" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sampling_over_vertex_hull</span><span class="p">(</span><span class="n">nsample</span><span class="p">,</span> <span class="n">vertex_perm_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">is_finite_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span> <span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Randomly sample points in the log space of chart variables, but instead of log-uniform, we first assign points to each vertex in an even fashion, then sample uniformly within each vertex.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nsample</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of points to be sampled in the space of chart variables.
This is divided evenly to all the vertices of this binding network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_finite_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Useful only when vertex_perm_list=[], so that all vertices are sampled.
If True, only finite vertices are sampled. This also allows chart 'tk' to work.
If False, both finite and infinite vertices are sampled. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vertex_perm_list</code>
            </td>
            <td>
                  <code>list of vertex&#39;s perm tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of perms indexing the vertices to be sampled.
e.g. [(0,1,2), (0,1,3)]. Defaults to empty list []. If empty, sample all vertices.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string indicating the chart that the opt_constraints are specified in.
Choices are 'x', 'xak', and 'tk'. Defaults to 'x'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>margin</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vertex's feasibility conditions are inequalities,
of the form c_mat * logx + c0_vec &gt; margin (e.g. in 'x' chart),
where margin is the positive threshold used here. Defaults to 0.
This can be adjusted to be stronger/weaker requirements on dominance.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmin</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to every variable.
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>-6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmax</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to every variable.
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of ndarray with shape (nsample, dim_n).
Key is the perm of each vertex. Value is the sample for that vertex.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1663"><a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="k">def</span><span class="w"> </span><span class="nf">sampling_over_vertex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">vertex_perm_list</span><span class="o">=</span><span class="p">[],</span><span class="n">is_finite_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-1664"><a id="__codelineno-0-1664" name="__codelineno-0-1664"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1665"><a id="__codelineno-0-1665" name="__codelineno-0-1665"></a><span class="sd">  Randomly sample points in the log space of chart variables, but instead of log-uniform, we first assign points to each vertex in an even fashion, then sample uniformly within each vertex.</span>
</span><span id="__span-0-1666"><a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>
</span><span id="__span-0-1667"><a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1668"><a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">      nsample (int): The number of points to be sampled in the space of chart variables.</span>
</span><span id="__span-0-1669"><a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">          This is divided evenly to all the vertices of this binding network.</span>
</span><span id="__span-0-1670"><a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">      is_finite_only (bool, optional): Useful only when vertex_perm_list=[], so that all vertices are sampled.</span>
</span><span id="__span-0-1671"><a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">          If True, only finite vertices are sampled. This also allows chart &#39;tk&#39; to work.</span>
</span><span id="__span-0-1672"><a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">          If False, both finite and infinite vertices are sampled. Defaults to False.</span>
</span><span id="__span-0-1673"><a id="__codelineno-0-1673" name="__codelineno-0-1673"></a><span class="sd">      vertex_perm_list (list of vertex&#39;s perm tuples, optional): The list of perms indexing the vertices to be sampled.</span>
</span><span id="__span-0-1674"><a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">          e.g. [(0,1,2), (0,1,3)]. Defaults to empty list []. If empty, sample all vertices.</span>
</span><span id="__span-0-1675"><a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="sd">      chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-1676"><a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="sd">          Choices are &#39;x&#39;, &#39;xak&#39;, and &#39;tk&#39;. Defaults to &#39;x&#39;.</span>
</span><span id="__span-0-1677"><a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">      margin (float, optional): The vertex&#39;s feasibility conditions are inequalities,</span>
</span><span id="__span-0-1678"><a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">          of the form c_mat * logx + c0_vec &gt; margin (e.g. in &#39;x&#39; chart),</span>
</span><span id="__span-0-1679"><a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">          where margin is the positive threshold used here. Defaults to 0.</span>
</span><span id="__span-0-1680"><a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="sd">          This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-1681"><a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">      logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to every variable.</span>
</span><span id="__span-0-1682"><a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-1683"><a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">      logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to every variable.</span>
</span><span id="__span-0-1684"><a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-1685"><a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>
</span><span id="__span-0-1686"><a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1687"><a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">      dict: A dictionary of ndarray with shape (nsample, dim_n).</span>
</span><span id="__span-0-1688"><a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">          Key is the perm of each vertex. Value is the sample for that vertex.</span>
</span><span id="__span-0-1689"><a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1690"><a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>
</span><span id="__span-0-1691"><a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>  <span class="c1"># calculate number of vertex to be plotted and the dictionary of vertices.</span>
</span><span id="__span-0-1692"><a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>  <span class="n">vertex_plot_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1693"><a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>  <span class="k">if</span> <span class="n">vertex_perm_list</span><span class="p">:</span> <span class="c1"># vertex_perm_list is not empty</span>
</span><span id="__span-0-1694"><a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>    <span class="n">nvertex</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vertex_perm_list</span><span class="p">)</span>
</span><span id="__span-0-1695"><a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">vertex_perm_list</span><span class="p">:</span>
</span><span id="__span-0-1696"><a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>      <span class="n">vertex_plot_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">perm</span><span class="p">]</span>
</span><span id="__span-0-1697"><a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>  <span class="k">else</span><span class="p">:</span> <span class="c1"># plot all vertices</span>
</span><span id="__span-0-1698"><a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>    <span class="k">if</span> <span class="n">is_finite_only</span><span class="p">:</span> 
</span><span id="__span-0-1699"><a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>      <span class="n">finite_key</span><span class="o">=</span><span class="s1">&#39;finite&#39;</span>
</span><span id="__span-0-1700"><a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>    <span class="k">else</span><span class="p">:</span> 
</span><span id="__span-0-1701"><a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>      <span class="n">finite_key</span><span class="o">=</span><span class="s1">&#39;all&#39;</span>
</span><span id="__span-0-1702"><a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>    <span class="n">nvertex</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="n">finite_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-0-1703"><a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>    <span class="n">vertex_plot_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="n">finite_key</span><span class="p">]</span>
</span><span id="__span-0-1704"><a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>  <span class="c1"># now sample each vertex.</span>
</span><span id="__span-0-1705"><a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>  <span class="n">nsample_per_vertex</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">nsample</span><span class="o">/</span><span class="n">nvertex</span><span class="p">)</span> <span class="c1"># take the floor for number of sample per vertex</span>
</span><span id="__span-0-1706"><a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>  <span class="n">sample_vertex_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1707"><a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>  <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_plot_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1708"><a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-1709"><a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>    <span class="n">sample_vertex_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_hull_sampling</span><span class="p">(</span><span class="n">nsample_per_vertex</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span><span class="n">logmin</span><span class="o">=</span><span class="n">logmin</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="n">logmax</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="n">c_mat_extra</span><span class="p">,</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="n">c0_vec_extra</span><span class="p">)</span>
</span><span id="__span-0-1710"><a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>  <span class="k">return</span> <span class="n">sample_vertex_dict</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.t2x_sym" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">t2x_sym</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Input a symbolic expression containing totals t, and map it to x.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expr</code>
            </td>
            <td>
                  <code>sympy symbolic expression</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A symbolic expression to be converted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>sympy symbolic expression: The symbolic expression after conversion.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1964"><a id="__codelineno-0-1964" name="__codelineno-0-1964"></a><span class="k">def</span><span class="w"> </span><span class="nf">t2x_sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-0-1965"><a id="__codelineno-0-1965" name="__codelineno-0-1965"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1966"><a id="__codelineno-0-1966" name="__codelineno-0-1966"></a><span class="sd">  Input a symbolic expression containing totals t, and map it to x.</span>
</span><span id="__span-0-1967"><a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>
</span><span id="__span-0-1968"><a id="__codelineno-0-1968" name="__codelineno-0-1968"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1969"><a id="__codelineno-0-1969" name="__codelineno-0-1969"></a><span class="sd">      expr (sympy symbolic expression): A symbolic expression to be converted.</span>
</span><span id="__span-0-1970"><a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>
</span><span id="__span-0-1971"><a id="__codelineno-0-1971" name="__codelineno-0-1971"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1972"><a id="__codelineno-0-1972" name="__codelineno-0-1972"></a><span class="sd">      sympy symbolic expression: The symbolic expression after conversion.</span>
</span><span id="__span-0-1973"><a id="__codelineno-0-1973" name="__codelineno-0-1973"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1974"><a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>  <span class="c1"># calculate the substitutions map for totals to species</span>
</span><span id="__span-0-1975"><a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>  <span class="k">try</span><span class="p">:</span> <span class="n">expr_x</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2x</span><span class="p">)</span>
</span><span id="__span-0-1976"><a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>  <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-1977"><a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>    <span class="n">t2x_subs_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subs_list_t2x</span><span class="p">()</span>
</span><span id="__span-0-1978"><a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">t2x</span><span class="o">=</span><span class="n">t2x_subs_list</span>
</span><span id="__span-0-1979"><a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>    <span class="n">expr_x</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2x</span><span class="p">)</span>
</span><span id="__span-0-1980"><a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>  <span class="k">return</span> <span class="n">expr_x</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.tk2x_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tk2x_num</span><span class="p">(</span><span class="n">logtk</span><span class="p">,</span> <span class="n">a_mat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the logx value by numerical integration along the equilibrium manifold using log derivatives. The point on the manifold defined by logtk = (logt, logk) is the same as that defined by logx.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logtk</code>
            </td>
            <td>
                  <code>numpy vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector numerical value for total variables (in first dim_d entries) and the binding reaction constants (in last dim_r entries) that define the point. 
p_(logx) = p_(logt, logk). Shape is (dim_n,). log is base 10.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix defining the total variables t = a_mat @ x that the log derivatives are taken with respect to.
Default should be specified to be self.l_mat.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy vector: The numerical value of x at this point. log is base 10.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1345"><a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="k">def</span><span class="w"> </span><span class="nf">tk2x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logtk</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-1346"><a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1347"><a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">  Compute the logx value by numerical integration along the equilibrium manifold using log derivatives. The point on the manifold defined by logtk = (logt, logk) is the same as that defined by logx.</span>
</span><span id="__span-0-1348"><a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>
</span><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="sd">      logtk (numpy vector): Vector numerical value for total variables (in first dim_d entries) and the binding reaction constants (in last dim_r entries) that define the point. </span>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a><span class="sd">          p_(logx) = p_(logt, logk). Shape is (dim_n,). log is base 10.</span>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><span class="sd">      a_mat (numpy array): The matrix defining the total variables t = a_mat @ x that the log derivatives are taken with respect to.</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="sd">          Default should be specified to be self.l_mat.</span>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">      numpy vector: The numerical value of x at this point. log is base 10.</span>
</span><span id="__span-0-1357"><a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>  <span class="c1"># the initial point is always x=1, (t,k) = (A*1, 1)</span>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>  <span class="c1"># or, in log, logx=0, (logt,logk) = (log(A*1),0)</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>  <span class="n">logt0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a_mat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>  <span class="n">logk0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_r</span><span class="p">)</span>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>  <span class="n">y0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">logt0</span><span class="p">,</span><span class="n">logk0</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>  <span class="n">y1</span><span class="o">=</span><span class="n">logtk</span>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>  <span class="n">logx0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_n</span><span class="p">)</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>  <span class="c1"># The time is pseudo time, parameterizing trajectory from y0 to y1,</span>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>  <span class="c1"># where y0=(logt0,logk0) = (log(A*1),0), and y1=(logt,logk) the input.</span>
</span><span id="__span-0-1369"><a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>  <span class="c1"># So a point on the trajectory is gamma(tau) = tau*(y1-y0)+y0, 0&lt;=tau&lt;=1.</span>
</span><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>  <span class="c1"># The time derivative is therefore</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>  <span class="c1"># dlogx/dtau (x0) = dlogx/dlog(t,k) (x0) * dlog(t,k)/dtau (x0)</span>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>  <span class="c1">#                 = dlogx/dlog(t,k) (x0) * (y1-y0)</span>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>  <span class="c1"># dlogx/dlog(t,k) (x0) is log derivative matrix evaluated at x0.</span>
</span><span id="__span-0-1374"><a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>  <span class="n">time_derivative_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tau</span><span class="p">,</span><span class="n">logx</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logder_x_num</span><span class="p">(</span><span class="n">logx</span><span class="p">,</span><span class="n">a_mat</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span>
</span><span id="__span-0-1375"><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>  <span class="n">sol</span><span class="o">=</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">time_derivative_func</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">logx0</span><span class="p">)</span>
</span><span id="__span-0-1376"><a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>  <span class="n">logx</span><span class="o">=</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>  <span class="k">return</span> <span class="n">logx</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.vertex_constrained_construct" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_constrained_construct</span><span class="p">(</span><span class="n">opt_constraints</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;xak&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assuming self.vertex_dict is already computed, for given opt_constraints, this function computes whether the vertices are feasible under these constraints, updates rop_vertex.is_feasible for each vertex, and updates each vertex's feasible neighbors (stored in vertex.neighbors_constrained_dict). It returns is_feasible_dict, a dictionary of {perm: is_feasible} pairs.
This function calls vertex_list_feasibility_test.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>opt_constraints</code>
            </td>
            <td>
                  <code>list of cvxpy inequalities</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of constraints under which vertices are tested for feasibility.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string with value from {'x', 'xak', 'tk'} that specifies the chart that the opt_constraints are described in. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;xak&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of {perm: is_feasible} pairs indicating whether a vertex is feasible.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1599"><a id="__codelineno-0-1599" name="__codelineno-0-1599"></a><span class="k">def</span><span class="w"> </span><span class="nf">vertex_constrained_construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opt_constraints</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;xak&#39;</span><span class="p">):</span>
</span><span id="__span-0-1600"><a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1601"><a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="sd">  Assuming self.vertex_dict is already computed, for given opt_constraints, this function computes whether the vertices are feasible under these constraints, updates rop_vertex.is_feasible for each vertex, and updates each vertex&#39;s feasible neighbors (stored in vertex.neighbors_constrained_dict). It returns is_feasible_dict, a dictionary of {perm: is_feasible} pairs.</span>
</span><span id="__span-0-1602"><a id="__codelineno-0-1602" name="__codelineno-0-1602"></a><span class="sd">  This function calls vertex_list_feasibility_test.</span>
</span><span id="__span-0-1603"><a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>
</span><span id="__span-0-1604"><a id="__codelineno-0-1604" name="__codelineno-0-1604"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1605"><a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><span class="sd">      opt_constraints (list of cvxpy inequalities): List of constraints under which vertices are tested for feasibility.</span>
</span><span id="__span-0-1606"><a id="__codelineno-0-1606" name="__codelineno-0-1606"></a><span class="sd">      chart (str, optional): A string with value from {&#39;x&#39;, &#39;xak&#39;, &#39;tk&#39;} that specifies the chart that the opt_constraints are described in. Defaults to None.</span>
</span><span id="__span-0-1607"><a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>
</span><span id="__span-0-1608"><a id="__codelineno-0-1608" name="__codelineno-0-1608"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1609"><a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><span class="sd">      dict: A dictionary of {perm: is_feasible} pairs indicating whether a vertex is feasible.</span>
</span><span id="__span-0-1610"><a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1611"><a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>  <span class="c1"># for the given opt_constraints, test for each vertex whether it is feasible</span>
</span><span id="__span-0-1612"><a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>  <span class="c1"># under opt_constraints, and create a vertex dictionary for feasible vertices</span>
</span><span id="__span-0-1613"><a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>  <span class="c1"># under opt_constraints, stored in self.vertex_constrained_dict.</span>
</span><span id="__span-0-1614"><a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>  <span class="c1"># Also update each vertex&#39;s neighbors under constraints,</span>
</span><span id="__span-0-1615"><a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>  <span class="c1"># stored in each vertex.neighbors_constrained_dict.</span>
</span><span id="__span-0-1616"><a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>
</span><span id="__span-0-1617"><a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compute feasible vertices...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1618"><a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>  <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1619"><a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>    <span class="n">is_feasible</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span>
</span><span id="__span-0-1620"><a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>    <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1621"><a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>  <span class="n">vertex_feasible_all</span><span class="o">=</span><span class="p">{</span><span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-1622"><a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>  <span class="n">vertex_feasible_fin</span><span class="o">=</span><span class="p">{</span><span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-1623"><a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>  <span class="n">vertex_feasible_inf</span><span class="o">=</span><span class="p">{</span><span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-1624"><a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">vertex_constrained_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">vertex_feasible_all</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">vertex_feasible_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">vertex_feasible_inf</span><span class="p">}</span>
</span><span id="__span-0-1625"><a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>
</span><span id="__span-0-1626"><a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compute neighbors under opt_constraints...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1627"><a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>  <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1628"><a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>    <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1629"><a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>      <span class="c1"># if it is feasible, we want to look at its neighbors.</span>
</span><span id="__span-0-1630"><a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>      <span class="c1"># if a neighbor is feasible, it is still a neighbor under constraint.</span>
</span><span id="__span-0-1631"><a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>      <span class="c1"># if a neighbor is infeasible, we look at its neighbors to see whether</span>
</span><span id="__span-0-1632"><a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>      <span class="c1"># they are feasible. This recurses.</span>
</span><span id="__span-0-1633"><a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_update_constrained_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1634"><a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.vertex_construct" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_construct</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Construct the rop_vertex objects that this binding network can have, compute their orientation and feasibility (without additional constraints), and store them in self.vertex_dict.
Then the vertices' neighbors, log derivative, and c_mat_xak are computed and stored in these objects.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None. The vertices are recorded in self.vertex_dict and by updating the vertex objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1460"><a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-1461"><a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1462"><a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">    Construct the rop_vertex objects that this binding network can have, compute their orientation and feasibility (without additional constraints), and store them in self.vertex_dict.</span>
</span><span id="__span-0-1463"><a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">    Then the vertices&#39; neighbors, log derivative, and c_mat_xak are computed and stored in these objects.</span>
</span><span id="__span-0-1464"><a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>
</span><span id="__span-0-1465"><a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1466"><a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><span class="sd">        None.</span>
</span><span id="__span-0-1467"><a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>
</span><span id="__span-0-1468"><a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1469"><a id="__codelineno-0-1469" name="__codelineno-0-1469"></a><span class="sd">        None. The vertices are recorded in self.vertex_dict and by updating the vertex objects.</span>
</span><span id="__span-0-1470"><a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1471"><a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>    <span class="c1"># Construct a dictionary of reachable vertices.</span>
</span><span id="__span-0-1472"><a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>    <span class="c1"># because l_mat tends to be sparse, we iterate through its rows to get nonzero indices,</span>
</span><span id="__span-0-1473"><a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>    <span class="c1"># then each vertex&#39;s dominance condition a_mat is choosen from the nonezro indices.</span>
</span><span id="__span-0-1474"><a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>
</span><span id="__span-0-1475"><a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Constructing vertex objects and test for feasibility...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1476"><a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>    <span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-1477"><a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>    <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span>
</span><span id="__span-0-1478"><a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>    <span class="n">nnz_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-1479"><a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
</span><span id="__span-0-1480"><a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>      <span class="n">nnz_list</span><span class="o">=</span><span class="n">nnz_list</span><span class="o">+</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,:])[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="__span-0-1481"><a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>    <span class="n">vertex_inf_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1482"><a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>    <span class="n">vertex_fin_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1483"><a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">nnz_list</span><span class="p">):</span>
</span><span id="__span-0-1484"><a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>      <span class="n">vertex</span><span class="o">=</span><span class="n">rop_vertex</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1485"><a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>      <span class="k">if</span> <span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1486"><a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>        <span class="c1"># this is possibly an infinite vertex</span>
</span><span id="__span-0-1487"><a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>        <span class="c1"># check for rank =1, meaning perm has exactly one repeat</span>
</span><span id="__span-0-1488"><a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>        <span class="n">perm_count</span><span class="o">=</span><span class="p">[</span><span class="n">perm</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>
</span><span id="__span-0-1489"><a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">perm_count</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-1490"><a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>          <span class="k">if</span> <span class="n">perm_count</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span> <span class="c1"># because that same value shows up twice, each with count 2.</span>
</span><span id="__span-0-1491"><a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>            <span class="c1"># after all that check, there still can be infinite vertices that are not reachable</span>
</span><span id="__span-0-1492"><a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>            <span class="c1"># so we do feasibility test.</span>
</span><span id="__span-0-1493"><a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>            <span class="n">is_feasible</span><span class="o">=</span><span class="n">vertex</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="p">[])</span>
</span><span id="__span-0-1494"><a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>            <span class="c1"># and then add to vertex_inf_dict.</span>
</span><span id="__span-0-1495"><a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>            <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1496"><a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>              <span class="n">vertex_inf_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1497"><a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>      <span class="k">elif</span> <span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="n">orientation</span><span class="p">:</span>
</span><span id="__span-0-1498"><a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>        <span class="c1"># this is a finite vertex with the right orientation</span>
</span><span id="__span-0-1499"><a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>        <span class="c1"># we test for feasibility</span>
</span><span id="__span-0-1500"><a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>        <span class="n">is_feasible</span><span class="o">=</span><span class="n">vertex</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="p">[])</span>
</span><span id="__span-0-1501"><a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>        <span class="c1"># and then add to vertex_fin_dict.</span>
</span><span id="__span-0-1502"><a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>        <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-1503"><a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>          <span class="n">vertex_fin_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1504"><a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>    <span class="n">vertex_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">vertex_fin_dict</span><span class="p">,</span><span class="o">**</span><span class="n">vertex_inf_dict</span><span class="p">}</span>
</span><span id="__span-0-1505"><a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">vertex_dict</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">vertex_fin_dict</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">vertex_inf_dict</span><span class="p">}</span>
</span><span id="__span-0-1506"><a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>
</span><span id="__span-0-1507"><a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished vertex construction, now computing neighbors of vertices...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1508"><a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1509"><a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_find_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1510"><a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>
</span><span id="__span-0-1511"><a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished neighbors, now computing log derivatives...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1512"><a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>    <span class="c1"># first compute log der for finite vertices, since infinite ones rely on</span>
</span><span id="__span-0-1513"><a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>    <span class="c1"># finite neighbors to find orientation.</span>
</span><span id="__span-0-1514"><a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1515"><a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_ld_calc</span><span class="p">()</span>
</span><span id="__span-0-1516"><a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>
</span><span id="__span-0-1517"><a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished log derivatives, now computing c_mat_xak&#39;</span><span class="p">)</span>
</span><span id="__span-0-1518"><a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>    <span class="c1"># compute c_mat_xak for each vertex in preparation for feasibility tests.</span>
</span><span id="__span-0-1519"><a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1520"><a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>      <span class="n">vv</span><span class="o">.</span><span class="n">vertex_c_mat_xak_calc</span><span class="p">()</span>
</span><span id="__span-0-1521"><a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.vertex_construct_direct" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_construct_direct</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Construct the rop_vertex objects that this binding network can have, directly, without feasibility test.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None. The vertices are recorded in self.vertex_dict and by updating the vertex objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1545"><a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><span class="k">def</span><span class="w"> </span><span class="nf">vertex_construct_direct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-1546"><a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1547"><a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">  Construct the rop_vertex objects that this binding network can have, directly, without feasibility test.</span>
</span><span id="__span-0-1548"><a id="__codelineno-0-1548" name="__codelineno-0-1548"></a>
</span><span id="__span-0-1549"><a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1550"><a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">      None.</span>
</span><span id="__span-0-1551"><a id="__codelineno-0-1551" name="__codelineno-0-1551"></a>
</span><span id="__span-0-1552"><a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1553"><a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="sd">      None. The vertices are recorded in self.vertex_dict and by updating the vertex objects.</span>
</span><span id="__span-0-1554"><a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1555"><a id="__codelineno-0-1555" name="__codelineno-0-1555"></a>  <span class="c1"># We construct the vertices by iteratively construct all the possible</span>
</span><span id="__span-0-1556"><a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>  <span class="c1"># dominance vector (perm).</span>
</span><span id="__span-0-1557"><a id="__codelineno-0-1557" name="__codelineno-0-1557"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Constructing vertex objects DIRECTLY...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1558"><a id="__codelineno-0-1558" name="__codelineno-0-1558"></a>  <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-1559"><a id="__codelineno-0-1559" name="__codelineno-0-1559"></a>  <span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">a_mat</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-1560"><a id="__codelineno-0-1560" name="__codelineno-0-1560"></a>  <span class="n">not_dominated_col_idx</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="__span-0-1561"><a id="__codelineno-0-1561" name="__codelineno-0-1561"></a>  <span class="n">dominated_row_vec_prev</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="__span-0-1562"><a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>  <span class="n">dom_tuple_prev</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</span><span id="__span-0-1563"><a id="__codelineno-0-1563" name="__codelineno-0-1563"></a>  <span class="n">perm_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_dom_vec</span><span class="p">(</span><span class="n">a_mat</span><span class="p">,</span><span class="n">not_dominated_col_idx</span><span class="p">,</span><span class="n">dominated_row_vec_prev</span><span class="p">,</span><span class="n">dom_tuple_prev</span><span class="p">)</span>
</span><span id="__span-0-1564"><a id="__codelineno-0-1564" name="__codelineno-0-1564"></a>  <span class="n">vertex_fin_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1565"><a id="__codelineno-0-1565" name="__codelineno-0-1565"></a>  <span class="n">vertex_inf_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1566"><a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>  <span class="n">vertex_infHO_dict</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1567"><a id="__codelineno-0-1567" name="__codelineno-0-1567"></a>  <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">perm_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="__span-0-1568"><a id="__codelineno-0-1568" name="__codelineno-0-1568"></a>    <span class="n">vertex</span><span class="o">=</span><span class="n">rop_vertex</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1569"><a id="__codelineno-0-1569" name="__codelineno-0-1569"></a>    <span class="n">repeat_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">p_mat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1570"><a id="__codelineno-0-1570" name="__codelineno-0-1570"></a>    <span class="k">if</span> <span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1571"><a id="__codelineno-0-1571" name="__codelineno-0-1571"></a>      <span class="n">vertex_fin_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1572"><a id="__codelineno-0-1572" name="__codelineno-0-1572"></a>    <span class="c1"># elif np.max(repeat_vec)&gt;2 or np.sum(repeat_vec&gt;1) &gt;=2:</span>
</span><span id="__span-0-1573"><a id="__codelineno-0-1573" name="__codelineno-0-1573"></a>      <span class="c1"># there is an index repeated 3 or more times, OR there are more than two indices repeated twice or above;</span>
</span><span id="__span-0-1574"><a id="__codelineno-0-1574" name="__codelineno-0-1574"></a>      <span class="c1"># So this is an infinite vertex of higher order.</span>
</span><span id="__span-0-1575"><a id="__codelineno-0-1575" name="__codelineno-0-1575"></a>    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">repeat_vec</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">repeat_vec</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]])</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-1576"><a id="__codelineno-0-1576" name="__codelineno-0-1576"></a>      <span class="c1"># another way to test for higher order is the sum of repeated indices&#39; total repeated times is &gt;2.</span>
</span><span id="__span-0-1577"><a id="__codelineno-0-1577" name="__codelineno-0-1577"></a>      <span class="n">vertex_infHO_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1578"><a id="__codelineno-0-1578" name="__codelineno-0-1578"></a>    <span class="k">else</span><span class="p">:</span> <span class="c1">#infinite vertex of order one</span>
</span><span id="__span-0-1579"><a id="__codelineno-0-1579" name="__codelineno-0-1579"></a>      <span class="n">vertex_inf_dict</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vertex</span>
</span><span id="__span-0-1580"><a id="__codelineno-0-1580" name="__codelineno-0-1580"></a>  <span class="n">vertex_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">vertex_fin_dict</span><span class="p">,</span><span class="o">**</span><span class="n">vertex_inf_dict</span><span class="p">}</span>
</span><span id="__span-0-1581"><a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">vertex_dict</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">vertex_fin_dict</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">vertex_inf_dict</span><span class="p">,</span><span class="s1">&#39;infiniteHO&#39;</span><span class="p">:</span><span class="n">vertex_infHO_dict</span><span class="p">}</span>
</span><span id="__span-0-1582"><a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>
</span><span id="__span-0-1583"><a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished vertex construction, now computing neighbors of vertices...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1584"><a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>  <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1585"><a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>    <span class="n">vv</span><span class="o">.</span><span class="n">vertex_find_neighbors</span><span class="p">()</span>
</span><span id="__span-0-1586"><a id="__codelineno-0-1586" name="__codelineno-0-1586"></a>
</span><span id="__span-0-1587"><a id="__codelineno-0-1587" name="__codelineno-0-1587"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished neighbors, now computing log derivatives...&#39;</span><span class="p">)</span>
</span><span id="__span-0-1588"><a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>  <span class="c1"># first compute log der for finite vertices, since infinite ones rely on</span>
</span><span id="__span-0-1589"><a id="__codelineno-0-1589" name="__codelineno-0-1589"></a>  <span class="c1"># finite neighbors to find orientation.</span>
</span><span id="__span-0-1590"><a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>  <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1591"><a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>    <span class="n">vv</span><span class="o">.</span><span class="n">vertex_ld_calc</span><span class="p">()</span>
</span><span id="__span-0-1592"><a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>
</span><span id="__span-0-1593"><a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished log derivatives, now computing c_mat_xak&#39;</span><span class="p">)</span>
</span><span id="__span-0-1594"><a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>  <span class="c1"># compute c_mat_xak for each vertex in preparation for feasibility tests.</span>
</span><span id="__span-0-1595"><a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>  <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vertex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1596"><a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>    <span class="n">vv</span><span class="o">.</span><span class="n">vertex_c_mat_xak_calc</span><span class="p">()</span>
</span><span id="__span-0-1597"><a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.vertex_list_feasibility_test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_list_feasibility_test</span><span class="p">(</span><span class="n">opt_constraints</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;xak&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Given opt_constraints, test all the vertices for their feasibility and return is_feasible_dict.
This function is called by vertex_constrained_construct.
It can also be directly called to test for feasibility without storing or finding feasible neighbors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>opt_constraints</code>
            </td>
            <td>
                  <code>list of cvxpy inequalities</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of constraints under which vertices are tested for feasibility.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string with value from {'x', 'xak', 'tk'} that specifies the chart that the opt_constraints are described in. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;xak&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of {perm: is_feasible} pairs indicating whether a vertex is feasible.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1636"><a id="__codelineno-0-1636" name="__codelineno-0-1636"></a><span class="k">def</span><span class="w"> </span><span class="nf">vertex_list_feasibility_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opt_constraints</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;xak&#39;</span><span class="p">):</span>
</span><span id="__span-0-1637"><a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1638"><a id="__codelineno-0-1638" name="__codelineno-0-1638"></a><span class="sd">  Given opt_constraints, test all the vertices for their feasibility and return is_feasible_dict.</span>
</span><span id="__span-0-1639"><a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><span class="sd">  This function is called by vertex_constrained_construct.</span>
</span><span id="__span-0-1640"><a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="sd">  It can also be directly called to test for feasibility without storing or finding feasible neighbors.</span>
</span><span id="__span-0-1641"><a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>
</span><span id="__span-0-1642"><a id="__codelineno-0-1642" name="__codelineno-0-1642"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1643"><a id="__codelineno-0-1643" name="__codelineno-0-1643"></a><span class="sd">      opt_constraints (list of cvxpy inequalities): List of constraints under which vertices are tested for feasibility.</span>
</span><span id="__span-0-1644"><a id="__codelineno-0-1644" name="__codelineno-0-1644"></a><span class="sd">      chart (str, optional): A string with value from {&#39;x&#39;, &#39;xak&#39;, &#39;tk&#39;} that specifies the chart that the opt_constraints are described in. Defaults to None.</span>
</span><span id="__span-0-1645"><a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>
</span><span id="__span-0-1646"><a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1647"><a id="__codelineno-0-1647" name="__codelineno-0-1647"></a><span class="sd">      dict: A dictionary of {perm: is_feasible} pairs indicating whether a vertex is feasible.</span>
</span><span id="__span-0-1648"><a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1649"><a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>  <span class="c1"># for the given opt_constraints, test each of the vertex whether it is feasible</span>
</span><span id="__span-0-1650"><a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>  <span class="n">is_feasible_fin</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1651"><a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>  <span class="n">is_feasible_inf</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-1652"><a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>  <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1653"><a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>    <span class="n">is_feasible</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span>
</span><span id="__span-0-1654"><a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>    <span class="n">is_feasible_fin</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1655"><a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>  <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-1656"><a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>    <span class="n">is_feasible</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints</span><span class="p">)</span>
</span><span id="__span-0-1657"><a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>    <span class="n">is_feasible_inf</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">is_feasible</span>
</span><span id="__span-0-1658"><a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>
</span><span id="__span-0-1659"><a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>  <span class="n">is_feasible_all</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">is_feasible_fin</span><span class="p">,</span><span class="o">**</span><span class="n">is_feasible_inf</span><span class="p">}</span>
</span><span id="__span-0-1660"><a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>  <span class="n">is_feasible_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">is_feasible_all</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">is_feasible_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">is_feasible_inf</span><span class="p">}</span>
</span><span id="__span-0-1661"><a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>  <span class="k">return</span> <span class="n">is_feasible_dict</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.x2tk_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">x2tk_num</span><span class="p">(</span><span class="n">logx</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the (logt, logk) value given logx.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logx</code>
            </td>
            <td>
                  <code>numpy vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector numerical value for total variables that define the x point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing two numpy vectors:
- logt: The numerical value of total concentration at this point. log is base 10.
- logk: The numerical value of binding constants at this point. log is base 10.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1300"><a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="k">def</span><span class="w"> </span><span class="nf">x2tk_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logx</span><span class="p">):</span>
</span><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">  Compute the (logt, logk) value given logx.</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">      logx (numpy vector): Vector numerical value for total variables that define the x point.</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>
</span><span id="__span-0-1307"><a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1308"><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">      tuple: A tuple containing two numpy vectors:</span>
</span><span id="__span-0-1309"><a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">          - logt: The numerical value of total concentration at this point. log is base 10.</span>
</span><span id="__span-0-1310"><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">          - logk: The numerical value of binding constants at this point. log is base 10.</span>
</span><span id="__span-0-1311"><a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1312"><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>  <span class="n">logt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logx</span><span class="p">))</span>
</span><span id="__span-0-1313"><a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>  <span class="n">logk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">logx</span><span class="p">)</span>
</span><span id="__span-0-1314"><a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>  <span class="k">return</span> <span class="n">logt</span><span class="p">,</span><span class="n">logk</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.xak2x_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xak2x_num</span><span class="p">(</span><span class="n">logxak</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the logx value given logxak = (logxa, logk).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logxak</code>
            </td>
            <td>
                  <code>numpy vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector numerical value for atomic species concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).
log is base 10.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy vector: The numerical value of logx at this point.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1316"><a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="k">def</span><span class="w"> </span><span class="nf">xak2x_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logxak</span><span class="p">):</span>
</span><span id="__span-0-1317"><a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1318"><a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">  Compute the logx value given logxak = (logxa, logk).</span>
</span><span id="__span-0-1319"><a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
</span><span id="__span-0-1320"><a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1321"><a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">      logxak (numpy vector): Vector numerical value for atomic species concentration (first dim_d entries) and binding reaction constants (last dim_r entries). Shape is (dim_n,).</span>
</span><span id="__span-0-1322"><a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">          log is base 10.</span>
</span><span id="__span-0-1323"><a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
</span><span id="__span-0-1324"><a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1325"><a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">      numpy vector: The numerical value of logx at this point.</span>
</span><span id="__span-0-1326"><a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1327"><a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>  <span class="k">try</span><span class="p">:</span> <span class="n">xak2x_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xak2x_map</span>
</span><span id="__span-0-1328"><a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>  <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-1329"><a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">calc_xak2x_map</span><span class="p">()</span> <span class="c1"># if doesn&#39;t exist, calculate it</span>
</span><span id="__span-0-1330"><a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>    <span class="n">xak2x_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xak2x_map</span>
</span><span id="__span-0-1331"><a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>  <span class="k">return</span> <span class="n">xak2x_map</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">logxak</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.binding_network.xc2xak_sym" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xc2xak_sym</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Input a symbolic expression containing complex species x^c, and map it to x^a and k.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expr</code>
            </td>
            <td>
                  <code>sympy symbolic expression</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A symbolic expression to be converted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>sympy symbolic expression: The symbolic expression after conversion.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1982"><a id="__codelineno-0-1982" name="__codelineno-0-1982"></a><span class="k">def</span><span class="w"> </span><span class="nf">xc2xak_sym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-0-1983"><a id="__codelineno-0-1983" name="__codelineno-0-1983"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1984"><a id="__codelineno-0-1984" name="__codelineno-0-1984"></a><span class="sd">  Input a symbolic expression containing complex species x^c, and map it to x^a and k.</span>
</span><span id="__span-0-1985"><a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>
</span><span id="__span-0-1986"><a id="__codelineno-0-1986" name="__codelineno-0-1986"></a><span class="sd">  Args:</span>
</span><span id="__span-0-1987"><a id="__codelineno-0-1987" name="__codelineno-0-1987"></a><span class="sd">      expr (sympy symbolic expression): A symbolic expression to be converted.</span>
</span><span id="__span-0-1988"><a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>
</span><span id="__span-0-1989"><a id="__codelineno-0-1989" name="__codelineno-0-1989"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1990"><a id="__codelineno-0-1990" name="__codelineno-0-1990"></a><span class="sd">      sympy symbolic expression: The symbolic expression after conversion.</span>
</span><span id="__span-0-1991"><a id="__codelineno-0-1991" name="__codelineno-0-1991"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1992"><a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>  <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_atomic</span><span class="p">,</span> <span class="s2">&quot;this operation requires the binding network to be atomic&quot;</span>
</span><span id="__span-0-1993"><a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>  <span class="c1"># calculate the substitutions map for complex species to atomic species and k&#39;s, if it does not exist.</span>
</span><span id="__span-0-1994"><a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>  <span class="k">try</span><span class="p">:</span> <span class="n">expr_xak</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc2xak</span><span class="p">)</span>
</span><span id="__span-0-1995"><a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>  <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-1996"><a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>    <span class="n">xc2xak_subs_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subs_list_xc2xak</span><span class="p">()</span>
</span><span id="__span-0-1997"><a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">xc2xak</span><span class="o">=</span><span class="n">xc2xak_subs_list</span>
</span><span id="__span-0-1998"><a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>    <span class="n">expr_xak</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc2xak</span><span class="p">)</span>
</span><span id="__span-0-1999"><a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>  <span class="k">return</span> <span class="n">expr_xak</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="bcn.binding_network.rop_dom_regime" class="doc doc-heading">
            <code>rop_dom_regime</code>


</h2>


    <div class="doc doc-contents ">


        <p>A dominance regime (dom_regime) object for a catalytic activity on top of a given binding network defined by b^T x, for some b vector.
  A dominance regime is labeled by a tuple ((perm), j) where perm is the permutation (a length-n tuple) defining the vertex, and j is the dominant species index in activity b^T x.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>row_idx</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The integer j indicating x_j is the dominant species in b^T x at this regime.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b_vec</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The b vector defining the activity b^T x.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vertex_perm</code>
            </td>
            <td>
                  <code>tuple of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tuple of length d (number of totals of binding network) referring to the dominance vertex that this dom_regime belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vertex</code>
            </td>
            <td>
                  <code><span title="ROP_vertex">ROP_vertex</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vertex that this dom_regime belongs to. This dom_regime is at this vertex with an additional dominance condition for the activity.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bn</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="binding_network (bcn.binding_network.binding_network)" href="#bcn.binding_network.binding_network">binding_network</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The binding network that this dom_regime belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ld</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reaction order or log derivative of this dom_regime. The row_idx row of the vertex's h_mat.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>neighbors_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary for dom_regime neighbors of this dom_regime.
Has four keys, three of them are "finite", "infinite", and "all",
for finite, infinite (ray) dom_regime neighbors, and all of dom_regime neighbors, respectively.
For each of these keys, we get a dictionary as well, with a (perm, row_idx) tuple as key and the dom_regime object as value.
The last key is "zero", which maps to neighbors connected via dom_regimes that are zero rays in reaction orders (or log derivative).
The value is itself a dictionary with "finite", "infinite", and "all" mapping to dictionaries with (ld: ld_regime) entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_feasible</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether this dom_regime is feasible under the last given constraints.
If a new set of constraints is given and tested, then this is overwritten.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>neighbors_constrained_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary for ld_regime neighbors of this ld_regime that are feasible under constraints applied to each dom_regime.
Same keys as neighbors_dict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_add_x</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional inequalities specifying the condition to reach this dom_regime on top of the inequalities from its vertex.
To be concatenated vertically with vertex.c_mat_x. This is in chart 'x'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_add_xak</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional inequalities specifying the condition to reach this dom_regime on top of the inequalities from its vertex.
To be concatenated vertically with vertex.c_mat_xak. This is in chart 'xak'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c0_vec_add</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional intercept vector entries for the inequalities specifying the condition to reach this dom_regime on top of the inequalities from its vertex.
To be concatenated vertically with vertex.c0_vec when used to specify inequalities.
Same vector for both chart 'x' and 'xak'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_add_tk</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional inequalities specifying this dom_regime on top of the inequalities from its vertex.
To be concatenated vertically with vertex.c_mat_tk. This is in chart 'tk'.
Is only meaningful if its vertex is non-singular.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="k">class</span><span class="w"> </span><span class="nc">rop_dom_regime</span><span class="p">:</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">  A dominance regime (dom_regime) object for a catalytic activity on top of a given binding network defined by b^T x, for some b vector.</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    A dominance regime is labeled by a tuple ((perm), j) where perm is the permutation (a length-n tuple) defining the vertex, and j is the dominant species index in activity b^T x.</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">  Args:</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">      row_idx (int): The integer j indicating x_j is the dominant species in b^T x at this regime.</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">      b_vec (numpy array): The b vector defining the activity b^T x.</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">      vertex_perm (tuple of int): The tuple of length d (number of totals of binding network) referring to the dominance vertex that this dom_regime belongs to.</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">      vertex (ROP_vertex): The vertex that this dom_regime belongs to. This dom_regime is at this vertex with an additional dominance condition for the activity.</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">      bn (binding_network): The binding network that this dom_regime belongs to.</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">      ld (tuple): The reaction order or log derivative of this dom_regime. The row_idx row of the vertex&#39;s h_mat.</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">      neighbors_dict (dict): The dictionary for dom_regime neighbors of this dom_regime.</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">          Has four keys, three of them are &quot;finite&quot;, &quot;infinite&quot;, and &quot;all&quot;,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">          for finite, infinite (ray) dom_regime neighbors, and all of dom_regime neighbors, respectively.</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">          For each of these keys, we get a dictionary as well, with a (perm, row_idx) tuple as key and the dom_regime object as value.</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">          The last key is &quot;zero&quot;, which maps to neighbors connected via dom_regimes that are zero rays in reaction orders (or log derivative).</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">          The value is itself a dictionary with &quot;finite&quot;, &quot;infinite&quot;, and &quot;all&quot; mapping to dictionaries with (ld: ld_regime) entries.</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">      is_feasible (bool): Whether this dom_regime is feasible under the last given constraints.</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">          If a new set of constraints is given and tested, then this is overwritten.</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">      neighbors_constrained_dict (dict): The dictionary for ld_regime neighbors of this ld_regime that are feasible under constraints applied to each dom_regime.</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">          Same keys as neighbors_dict.</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">      c_mat_add_x (numpy array): Additional inequalities specifying the condition to reach this dom_regime on top of the inequalities from its vertex.</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">          To be concatenated vertically with vertex.c_mat_x. This is in chart &#39;x&#39;.</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">      c_mat_add_xak (numpy array): Additional inequalities specifying the condition to reach this dom_regime on top of the inequalities from its vertex.</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">          To be concatenated vertically with vertex.c_mat_xak. This is in chart &#39;xak&#39;.</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">      c0_vec_add (numpy array): Additional intercept vector entries for the inequalities specifying the condition to reach this dom_regime on top of the inequalities from its vertex.</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">          To be concatenated vertically with vertex.c0_vec when used to specify inequalities.</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">          Same vector for both chart &#39;x&#39; and &#39;xak&#39;.</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">      c_mat_add_tk (numpy array): Additional inequalities specifying this dom_regime on top of the inequalities from its vertex.</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">          To be concatenated vertically with vertex.c_mat_tk. This is in chart &#39;tk&#39;.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">          Is only meaningful if its vertex is non-singular.</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">row_idx</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">vertex_perm</span><span class="p">,</span><span class="n">bn</span><span class="p">):</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    Initiates a ROP vertex.</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Args:</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        row_idx (int): The integer j indicating x_j is the dominant species in b^T x at this regime.</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        b_vec (numpy array): The b vector defining the activity b^T x.</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        vertex_perm (tuple of int): The tuple of length d (number of totals of binding network) referring to the dominance vertex that this dom_regime belongs to.</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        bn (binding_network): The binding network that this dom_regime belongs to.</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span><span class="o">=</span><span class="n">row_idx</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span><span class="o">=</span><span class="n">vertex_perm</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">=</span><span class="n">bn</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">vertex_perm</span><span class="p">]</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">=</span><span class="n">bn</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ld</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">h_mat</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,:])</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">chart_check_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chart</span><span class="p">):</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">if</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>      <span class="k">try</span><span class="p">:</span> 
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">c_mat_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_x</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">c0_vec_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>      <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># c_mat_add is not yet calculated</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calc_c_mat_add_x</span><span class="p">()</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">c_mat_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_x</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">c0_vec_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;xak&#39;</span><span class="p">:</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>      <span class="k">try</span><span class="p">:</span> 
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">c_mat_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_xak</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">c0_vec_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>      <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># c_mat_add_xak is not yet calculated</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calc_c_mat_add_xak</span><span class="p">()</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">c_mat_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_xak</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">c0_vec_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;tk&#39;</span><span class="p">:</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>      <span class="k">try</span><span class="p">:</span> 
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">c_mat_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_tk</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">c0_vec_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add_tk</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a>      <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># c_mat_add_tk is not yet calculated</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calc_c_mat_add_tk</span><span class="p">()</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">c_mat_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_tk</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">c0_vec_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add_tk</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;chart that is not one of &quot;x,xak,tk&quot; is not implemented yet&#39;</span><span class="p">)</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">return</span> <span class="n">c_mat_add</span><span class="p">,</span><span class="n">c0_vec_add</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">feasibility_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="p">[],</span><span class="n">positive_threshold</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span><span class="n">is_asymptotic</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">c_mat_add</span><span class="p">,</span><span class="n">c0_vec_add</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chart_check_add</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="n">vv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="n">opt_var</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">opt_var</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="n">opt_constraints_test</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="n">opt_constraints_test</span><span class="o">+=</span><span class="n">opt_constraints</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">c_mat_add</span><span class="p">):</span> <span class="c1">#c_mat_add could be empty if b_vec has just one nonzero entry.</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>      <span class="k">if</span> <span class="n">is_asymptotic</span><span class="p">:</span> <span class="c1"># if the test condition is asymptotic, c0_vec_add is considered 0.</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">opt_constraints_test</span><span class="o">+=</span><span class="p">[</span><span class="n">c_mat_add</span> <span class="o">@</span> <span class="n">opt_var</span> <span class="o">&gt;=</span> <span class="n">positive_threshold</span><span class="p">]</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># if not asymptotic, it is exact, so c0_vec_add needs to be considered.</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">opt_constraints_test</span><span class="o">+=</span><span class="p">[</span><span class="n">c_mat_add</span> <span class="o">@</span> <span class="n">opt_var</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add</span> <span class="o">&gt;=</span> <span class="n">positive_threshold</span><span class="p">]</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">is_feasible</span><span class="o">=</span><span class="n">vv</span><span class="o">.</span><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="n">opt_constraints_test</span><span class="p">,</span><span class="n">is_asymptotic</span><span class="o">=</span><span class="n">is_asymptotic</span><span class="p">)</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">return</span> <span class="n">is_feasible</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">calc_c_mat_add_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Compute feasibility conditions of this dominance regime in addition </span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="c1">#   to vertex feasibility conditions in the form of </span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="c1">#   c_mat_add_x * logx + c0_vec_add &gt; 0, i.e. in chart x.</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="c1"># Each condition comes from and inequality of the form </span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="c1">#   b_j1 x_j1 &gt; b_j2 x_j2, which can be written as </span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="c1">#   log(x_j1) - log(x_j2) + [log(b_j1) - log(b_j2)] &gt; 0.</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="c1"># So the corresponding row of c_mat_add_x are all 0&#39;s except 1 at j1 </span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="c1">#   and -1 at j2. And corresponding entry of c0_vec is log(b_j1) - log(b_j2).</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">j</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">b_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">)</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">idx_nonzero_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">b_vec</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">n_ineq</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_nonzero_b</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">c_mat_add_x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_ineq</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">c0_vec_add</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_ineq</span><span class="p">)</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">for</span> <span class="n">jp</span> <span class="ow">in</span> <span class="n">idx_nonzero_b</span><span class="p">:</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>      <span class="k">if</span> <span class="n">jp</span><span class="o">!=</span><span class="n">j</span><span class="p">:</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">c_mat_add_x</span><span class="p">[</span><span class="n">counter</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">c_mat_add_x</span><span class="p">[</span><span class="n">counter</span><span class="p">,</span><span class="n">jp</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">c0_vec_add</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">b_vec</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">b_vec</span><span class="p">[</span><span class="n">jp</span><span class="p">])</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_x</span><span class="o">=</span><span class="n">c_mat_add_x</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add</span><span class="o">=</span><span class="n">c0_vec_add</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">calc_c_mat_add_xak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="c1"># compute feasibility conditions of this dominance regime in addition to vertex feasibility conditions</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="c1"># in the form of c_mat_add_xak * log(xa,k) + c0_vec_add &gt; 0, i.e. in chart log(xa,k)</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">c_mat_add_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_x</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># c_mat_add is not yet calculated</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">calc_c_mat_add_x</span><span class="p">()</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>      <span class="n">c_mat_add_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_x</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">xak2x_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">xak2x_map</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">calc_xak2x_map</span><span class="p">()</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>      <span class="n">xak2x_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">xak2x_map</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">c_mat_add_xak</span><span class="o">=</span><span class="n">c_mat_add_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">xak2x_map</span><span class="p">)</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_xak</span><span class="o">=</span><span class="n">c_mat_add_xak</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">calc_c_mat_add_tk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="c1"># compute feasibility conditions of this dominance regime in addition to vertex feasibility conditions</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="c1"># in the form of c_mat_add_tk * log(t,k) &gt; 0, i.e. in chart log(t,k)</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;only finite vertices can have non-singular (t,k) chart&quot;</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">c_mat_add_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_x</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># c_mat_add is not yet calculated</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">calc_c_mat_add_x</span><span class="p">()</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>      <span class="n">c_mat_add_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_x</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="c1"># The equivalence here is the following:</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="c1"># c_mat_tk @ log(t,k) + c0_vec_tk &gt;=0  &lt;=&gt;  c_mat_x @ logx + c0_vec &gt;=0</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="c1"># and we use h_mat*log(t,k)=log(x) at the vertex</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">c_mat_add_tk</span><span class="o">=</span><span class="n">c_mat_add_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">h_mat</span><span class="p">)</span> 
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">c0_vec_add_tk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_add</span> <span class="o">-</span> <span class="n">c_mat_add_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m0_vec</span><span class="p">))</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_mat_add_tk</span><span class="o">=</span><span class="n">c_mat_add_tk</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span><span class="o">=</span><span class="n">c0_vec_add_tk</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">find_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="n">vv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="n">neighbors_fin</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">neighbors_inf</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">regime_fin_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">)][</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">regime_inf_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">)][</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="n">regime_fin_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>      <span class="n">perm</span><span class="p">,</span><span class="n">row_idx</span><span class="o">=</span><span class="n">key</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>      <span class="c1"># if same vertex, but different dominance, then it&#39;s neighbor.</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>      <span class="k">if</span> <span class="n">perm</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span> <span class="ow">and</span> <span class="n">row_idx</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span><span class="p">:</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">neighbors_fin</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">regime</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>      <span class="c1"># if different vertex, but it&#39;s a neighboring vertex, then it&#39;s neighbor.</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">try</span><span class="p">:</span> <span class="c1"># if perm is in neighbors</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>          <span class="n">vv</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">perm</span><span class="p">]</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>          <span class="c1"># If the neighboring vertex&#39;s transition index (the row_idx that changed compared to self)</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>          <span class="c1"># is the same as its dominance index, then it&#39;s a neighbor.</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>          <span class="c1"># Or, if the transition index is not the same, then its dominance index needs to be the same as self.</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>          <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">==</span><span class="n">row_idx</span><span class="p">:</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">neighbors_fin</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">regime</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="c1"># not in neighbors</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>          <span class="k">continue</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="n">regime_inf_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>      <span class="n">perm</span><span class="p">,</span><span class="n">row_idx</span><span class="o">=</span><span class="n">key</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>      <span class="c1"># if same vertex, but different dominance, then it&#39;s neighbor.</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a>      <span class="k">if</span> <span class="n">perm</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span> <span class="ow">and</span> <span class="n">row_idx</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span><span class="p">:</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">neighbors_inf</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">regime</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a>      <span class="c1"># if different vertex, but it&#39;s a neighboring vertex, then it&#39;s neighbor.</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="k">try</span><span class="p">:</span> <span class="c1"># if perm is in neighbors</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a>          <span class="n">vv</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">perm</span><span class="p">]</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a>          <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">==</span><span class="n">row_idx</span><span class="p">:</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="n">neighbors_inf</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">regime</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="c1"># not in neighbors</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a>          <span class="k">continue</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">neighbors_all</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">neighbors_fin</span><span class="p">,</span><span class="o">**</span><span class="n">neighbors_inf</span><span class="p">}</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">neighbors_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">neighbors_inf</span><span class="p">,</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">neighbors_all</span><span class="p">}</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">find_neighbors_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="c1"># Find neighbors that connect through dom_regimes with zero ld.</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="c1"># neighbors via zero are not considered neighbors of dom_regimes,</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="c1"># but we would like to keep them tracked, since they will become neighbors</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="c1"># in ld space.</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="c1"># This should be done after all neighbors of dom_regimes are constructed</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="c1"># since it relies on knowing the neighbors of dom_regime with ld=0.</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="c1"># A zero neighbor could have a zero neighbor, so recursion is needed to exhaust this.</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_zero_neighbor</span><span class="p">(</span><span class="n">infinite_neighbors</span><span class="p">,</span> <span class="n">finite_zero_neighbors</span><span class="p">,</span> <span class="n">infinite_zero_neighbors</span><span class="p">,</span> <span class="n">ld_zero</span><span class="p">,</span> <span class="n">visited</span><span class="p">):</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a>      <span class="n">zero_neighbors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a>          <span class="n">key</span><span class="p">:</span> <span class="n">dom_regime</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dom_regime</span> <span class="ow">in</span> <span class="n">infinite_neighbors</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dom_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">)</span> <span class="o">==</span> <span class="n">ld_zero</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>      <span class="p">}</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a>      <span class="k">if</span> <span class="n">zero_neighbors</span><span class="p">:</span>  <span class="c1"># the dictionary is not empty</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a>          <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dom_regime</span> <span class="ow">in</span> <span class="n">zero_neighbors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a>              <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a>                  <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a>                  <span class="n">finite_zero_neighbors</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">])</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a>                  <span class="n">infinite_zero_neighbors</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">])</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a>                  <span class="n">finite_zero_neighbors</span><span class="p">,</span> <span class="n">infinite_zero_neighbors</span><span class="p">,</span> <span class="n">visited</span> <span class="o">=</span> <span class="n">extract_zero_neighbor</span><span class="p">(</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a>                      <span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">],</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>                      <span class="n">finite_zero_neighbors</span><span class="p">,</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a>                      <span class="n">infinite_zero_neighbors</span><span class="p">,</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a>                      <span class="n">ld_zero</span><span class="p">,</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a>                      <span class="n">visited</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a>                  <span class="p">)</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a>      <span class="k">return</span> <span class="n">finite_zero_neighbors</span><span class="p">,</span> <span class="n">infinite_zero_neighbors</span><span class="p">,</span> <span class="n">visited</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">ld_zero</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">finite_zero_neighbors</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">infinite_zero_neighbors</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="n">infinite_neighbors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="n">finite_zero_neighbors</span><span class="p">,</span> <span class="n">infinite_zero_neighbors</span><span class="p">,</span> <span class="n">visited</span> <span class="o">=</span> <span class="n">extract_zero_neighbor</span><span class="p">(</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">infinite_neighbors</span><span class="p">,</span> <span class="n">finite_zero_neighbors</span><span class="p">,</span> <span class="n">infinite_zero_neighbors</span><span class="p">,</span> <span class="n">ld_zero</span><span class="p">,</span> <span class="n">visited</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="p">)</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="c1"># Remove self from the neighbors&#39; dictionaries if present</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="k">del</span> <span class="n">infinite_zero_neighbors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span><span class="p">)]</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="k">del</span> <span class="n">finite_zero_neighbors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span><span class="p">)]</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="k">pass</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">all_zero_neighbors</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">finite_zero_neighbors</span><span class="p">,</span> <span class="o">**</span><span class="n">infinite_zero_neighbors</span><span class="p">}</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;zero&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="s1">&#39;finite&#39;</span><span class="p">:</span> <span class="n">finite_zero_neighbors</span><span class="p">,</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="s1">&#39;infinite&#39;</span><span class="p">:</span> <span class="n">infinite_zero_neighbors</span><span class="p">,</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="n">all_zero_neighbors</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="p">}</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;allnzero&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="s1">&#39;finite&#39;</span><span class="p">:</span> <span class="p">{</span><span class="o">**</span><span class="n">finite_zero_neighbors</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]},</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="s1">&#39;infinite&#39;</span><span class="p">:</span> <span class="p">{</span><span class="o">**</span><span class="n">infinite_zero_neighbors</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]},</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="p">{</span><span class="o">**</span><span class="n">all_zero_neighbors</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]}</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="p">}</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">update_constrained_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="c1"># Using dom_regimes&#39; is_feasible tag to have updated neighbors.</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="c1"># The feasible neighbors of an infeasible neighbor becomes this vertex&#39;s neighbors.</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="c1"># We search the next level for the infeasible neighbors of an infeasible neighbor.</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="c1"># So this uses recursion.</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_infeasible_neighbor</span><span class="p">(</span><span class="n">infeasible_neighbors</span><span class="p">,</span><span class="n">neighbors_feasible_all</span><span class="p">,</span><span class="n">visited</span><span class="p">):</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>      <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">dom_regime</span> <span class="ow">in</span> <span class="n">infeasible_neighbors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a>          <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>              <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>              <span class="c1"># get the feasible and infeasible neighbors of this dom_regime</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>              <span class="n">infeasible_neighbors</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a>              <span class="n">feasible_neighbors</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a>              <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">dom_regime</span> <span class="ow">in</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;allnzero&#39;</span><span class="p">][</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a>                <span class="k">if</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">:</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>                  <span class="n">feasible_neighbors</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">dom_regime</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a>                  <span class="n">infeasible_neighbors</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">dom_regime</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a>              <span class="c1"># the feasible ones are neighbors under constraint.</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a>              <span class="n">neighbors_feasible_all</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">feasible_neighbors</span><span class="p">)</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a>              <span class="c1"># the infeasible ones we need to look further</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a>              <span class="k">if</span> <span class="n">infeasible_neighbors</span><span class="p">:</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a>                <span class="n">neighbors_feasible_all</span><span class="p">,</span> <span class="n">visited</span> <span class="o">=</span> <span class="n">extract_infeasible_neighbor</span><span class="p">(</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a>                  <span class="n">infeasible_neighbors</span><span class="p">,</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a>                  <span class="n">neighbors_feasible_all</span><span class="p">,</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a>                  <span class="n">visited</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a>                <span class="p">)</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a>      <span class="k">return</span> <span class="n">neighbors_feasible_all</span><span class="p">,</span> <span class="n">visited</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="n">neighbors_feasible_all</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">dom_regime</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">dom_regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;allnzero&#39;</span><span class="p">][</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="n">infeasible_neighbors</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">dom_regime</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">dom_regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;allnzero&#39;</span><span class="p">][</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="k">if</span> <span class="n">infeasible_neighbors</span><span class="p">:</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a>      <span class="n">neighbors_feasible_all</span><span class="p">,</span><span class="n">visited</span> <span class="o">=</span> <span class="n">extract_infeasible_neighbor</span><span class="p">(</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="n">infeasible_neighbors</span><span class="p">,</span><span class="n">neighbors_feasible_all</span><span class="p">,</span><span class="n">visited</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a>      <span class="p">)</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="c1"># Remove self from the neighbors&#39; dictionaries if present</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">del</span> <span class="n">neighbors_feasible_all</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span><span class="p">)]</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">pass</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="n">neighbors_feasible_inf</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">key</span><span class="p">:</span><span class="n">dom_regime</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">dom_regime</span> <span class="ow">in</span> <span class="n">neighbors_feasible_all</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="mi">0</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="p">}</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">neighbors_feasible_fin</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="n">key</span><span class="p">:</span><span class="n">dom_regime</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">dom_regime</span> <span class="ow">in</span> <span class="n">neighbors_feasible_all</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">orientation</span><span class="o">!=</span><span class="mi">0</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="p">}</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_constrained_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">neighbors_feasible_fin</span><span class="p">,</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>                                  <span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">neighbors_feasible_inf</span><span class="p">,</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a>                                  <span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">neighbors_feasible_all</span><span class="p">}</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>  <span class="c1"># def print_validity_condition(self,is_asymptotic=False):</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a>  <span class="c1">#   # print the expression for t=x, x(t,k) and inequalities for the</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a>  <span class="c1">#   # region of validity for this dominance regime,</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a>  <span class="c1">#   # using the labels of x,t,k</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">hull_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">    Sample points in the dom_regime&#39;s region of validity based on its hull of feasible regions.</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    Extra conditions (linear) can be added as c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">    This is done by adding dom_regime&#39;s additional constraints to its vertex&#39;s sampling function.</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    Args:</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        nsample (int): Number of points to be sampled.</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        margin (float, optional): The dom_regime&#39;s feasibility conditions are inequalities, </span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            of the form c_mat*x + c0_vec &gt;= margin (e.g. in &#39;x&#39; chart),</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">            where margin is the margin used here. Defaults to 0.</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">            This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            every variable. </span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            every variable. </span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        c_mat_extra (ndarray, shape (n_constraints, n_var)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">            in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        c0_vec_extra (numpy vector, shape (n_constraints,)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        sample (ndarray of shape nsample-by-dim_n): dim_n is number of species in the binding network.</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">            Sampled points satisfying the feasibility conditions of this vertex.</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">            Each row (sample[i,:]) is a sampled point.</span>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="c1"># Get the additional constraints for the dom_regime</span>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="n">c_mat_add</span><span class="p">,</span><span class="n">c0_vec_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_check_add</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">)</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="c1"># Combine dom_regime constraints with given additional constraints </span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="c1">#   to get the full constraints to be added to vertex validity.</span>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">c_mat_extra</span><span class="p">):</span> <span class="c1"># if there are additional constraints</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a>      <span class="n">c_mat_extra_full</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">c_mat_add</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="p">))</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a>      <span class="c1"># Incorporate margin into c0_vec_add, since this won&#39;t be added again later in the vertex.</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a>      <span class="n">c0_vec_extra_full</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">c0_vec_add</span><span class="o">-</span><span class="n">margin</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c0_vec_add</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">c0_vec_extra</span><span class="p">))</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="k">else</span><span class="p">:</span> <span class="c1"># there are no additional constraints</span>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a>      <span class="n">c_mat_extra_full</span> <span class="o">=</span> <span class="n">c_mat_add</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a>      <span class="n">c0_vec_extra_full</span> <span class="o">=</span> <span class="n">c0_vec_add</span><span class="o">-</span><span class="n">margin</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="c1"># Get the hull using the vertex&#39;s method, but with additional</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="c1">#   constraints from the dom_regime.</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="n">points</span><span class="p">,</span><span class="n">hull</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">vertex_hull_of_validity</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span><span class="n">logmin</span><span class="o">=</span><span class="n">logmin</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="n">logmax</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="n">c_mat_extra_full</span><span class="p">,</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="n">c0_vec_extra_full</span><span class="p">)</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="n">ncoeffs</span><span class="o">=</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="n">temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nsample</span><span class="p">,</span><span class="n">ncoeffs</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="n">coeffs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">prepend</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">append</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="n">sample</span><span class="o">=</span><span class="n">coeffs</span><span class="nd">@points</span> <span class="c1"># this has shape nsample-by-dim_n</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">return</span> <span class="n">sample</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_dom_regime.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">b_vec</span><span class="p">,</span> <span class="n">vertex_perm</span><span class="p">,</span> <span class="n">bn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initiates a ROP vertex.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>row_idx</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The integer j indicating x_j is the dominant species in b^T x at this regime.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b_vec</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The b vector defining the activity b^T x.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vertex_perm</code>
            </td>
            <td>
                  <code>tuple of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tuple of length d (number of totals of binding network) referring to the dominance vertex that this dom_regime belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bn</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="binding_network (bcn.binding_network.binding_network)" href="#bcn.binding_network.binding_network">binding_network</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The binding network that this dom_regime belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">row_idx</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">vertex_perm</span><span class="p">,</span><span class="n">bn</span><span class="p">):</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">  Initiates a ROP vertex.</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">  Args:</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">      row_idx (int): The integer j indicating x_j is the dominant species in b^T x at this regime.</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">      b_vec (numpy array): The b vector defining the activity b^T x.</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">      vertex_perm (tuple of int): The tuple of length d (number of totals of binding network) referring to the dominance vertex that this dom_regime belongs to.</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">      bn (binding_network): The binding network that this dom_regime belongs to.</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">row_idx</span><span class="o">=</span><span class="n">row_idx</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">vertex_perm</span><span class="o">=</span><span class="n">vertex_perm</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">=</span><span class="n">bn</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">vertex_perm</span><span class="p">]</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">=</span><span class="n">bn</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">ld</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">h_mat</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,:])</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_dom_regime.hull_sampling" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hull_sampling</span><span class="p">(</span><span class="n">nsample</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span> <span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sample points in the dom_regime's region of validity based on its hull of feasible regions.
Extra conditions (linear) can be added as c_mat_extra @ var + c0_vec_extra &gt;= 0.
This is done by adding dom_regime's additional constraints to its vertex's sampling function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nsample</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points to be sampled.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string indicating the chart that the opt_constraints are specified in.
Choices are 'x','xak', and 'tk'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>margin</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dom_regime's feasibility conditions are inequalities, 
of the form c_mat*x + c0_vec &gt;= margin (e.g. in 'x' chart),
where margin is the margin used here. Defaults to 0.
This can be adjusted to be stronger/weaker requirements on dominance.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmin</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to 
every variable. 
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>-6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmax</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to 
every variable. 
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_extra</code>
            </td>
            <td>
                  <code>ndarray, shape (n_constraints, n_var</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra optimization constraints to be added to feasibility conditions,
in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c0_vec_extra</code>
            </td>
            <td>
                  <code>numpy vector, shape (n_constraints,</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra optimization constraints to be added to feasibility conditions,
in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>sample</code></td>            <td>
                  <code>ndarray of shape nsample-by-dim_n</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dim_n is number of species in the binding network.
Sampled points satisfying the feasibility conditions of this vertex.
Each row (sample[i,:]) is a sampled point.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="k">def</span><span class="w"> </span><span class="nf">hull_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">  Sample points in the dom_regime&#39;s region of validity based on its hull of feasible regions.</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">  Extra conditions (linear) can be added as c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">  This is done by adding dom_regime&#39;s additional constraints to its vertex&#39;s sampling function.</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">  Args:</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">      nsample (int): Number of points to be sampled.</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">      chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">          Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">      margin (float, optional): The dom_regime&#39;s feasibility conditions are inequalities, </span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">          of the form c_mat*x + c0_vec &gt;= margin (e.g. in &#39;x&#39; chart),</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">          where margin is the margin used here. Defaults to 0.</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">          This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">      logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">          every variable. </span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">      logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">          every variable. </span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">      c_mat_extra (ndarray, shape (n_constraints, n_var)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">          in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">      c0_vec_extra (numpy vector, shape (n_constraints,)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">          in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">      sample (ndarray of shape nsample-by-dim_n): dim_n is number of species in the binding network.</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">          Sampled points satisfying the feasibility conditions of this vertex.</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">          Each row (sample[i,:]) is a sampled point.</span>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a>  <span class="c1"># Get the additional constraints for the dom_regime</span>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a>  <span class="n">c_mat_add</span><span class="p">,</span><span class="n">c0_vec_add</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_check_add</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">)</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>  <span class="c1"># Combine dom_regime constraints with given additional constraints </span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>  <span class="c1">#   to get the full constraints to be added to vertex validity.</span>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a>  <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">c_mat_extra</span><span class="p">):</span> <span class="c1"># if there are additional constraints</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="n">c_mat_extra_full</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">c_mat_add</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="p">))</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="c1"># Incorporate margin into c0_vec_add, since this won&#39;t be added again later in the vertex.</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="n">c0_vec_extra_full</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">c0_vec_add</span><span class="o">-</span><span class="n">margin</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c0_vec_add</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">c0_vec_extra</span><span class="p">))</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a>  <span class="k">else</span><span class="p">:</span> <span class="c1"># there are no additional constraints</span>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="n">c_mat_extra_full</span> <span class="o">=</span> <span class="n">c_mat_add</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="n">c0_vec_extra_full</span> <span class="o">=</span> <span class="n">c0_vec_add</span><span class="o">-</span><span class="n">margin</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a>  <span class="c1"># Get the hull using the vertex&#39;s method, but with additional</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a>  <span class="c1">#   constraints from the dom_regime.</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a>  <span class="n">points</span><span class="p">,</span><span class="n">hull</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">vertex_hull_of_validity</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span><span class="n">logmin</span><span class="o">=</span><span class="n">logmin</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="n">logmax</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="n">c_mat_extra_full</span><span class="p">,</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="n">c0_vec_extra_full</span><span class="p">)</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a>  <span class="n">ncoeffs</span><span class="o">=</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a>  <span class="n">temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nsample</span><span class="p">,</span><span class="n">ncoeffs</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a>  <span class="n">coeffs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">prepend</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">append</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a>  <span class="n">sample</span><span class="o">=</span><span class="n">coeffs</span><span class="nd">@points</span> <span class="c1"># this has shape nsample-by-dim_n</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a>  <span class="k">return</span> <span class="n">sample</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="bcn.binding_network.rop_ld_regime" class="doc doc-heading">
            <code>rop_ld_regime</code>


</h2>


    <div class="doc doc-contents ">


        <p>The ld_regime object, for a given ld (log derivative or reaction order), there could be multiple dominance regimes (defined by dominance relations in x for a given catalytic activity on top of a binding network).
  Each ld_regime has possibly several dominance regimes with the same ld.</p>
<p>Args:
      ld (tuple of integers): The log derivative, or reaction order, of this ld_regime.
      b_vec (numpy array vector): The b vector defining the activity, b^T x.
      bn (binding_network object): The binding network that this ld_regime belongs to.
      is_ray (boolean): Whether this ld_regime is a ray or not.
      dom_regime_keys (list of tuples): The list of tuples, each tuple is the key for a dominance regime that has reaction order (ld) the same as this ld_regime.
      dom_regime_dict (dictionary): The dictionary with key as the tuple (perm, dom_idx) representing a dominance regime and value of the dominance regime object.
      neighbors_dict (dictionary): The dictionary for ld_regime neighbors of this ld_regime.
          Has four keys, three of them are "finite", "infinite", and "all",
          for finite, infinite (ray) ld_regime neighbors, and all of ld_regime neighbors, respectively.
          For each of these keys, we get a dictionary as well, with ld tuple as key and the ld_regime object as value.
          The last key is "zero", which maps to neighbors connected via ld_regimes that are zero rays. The value is itself a dictionary with "finite", "infinite", and "all" mapping to dictionaries with (ld: ld_regime) entries.
      is_feasible (boolean): Whether this ld_regime is feasible. It is feasible if it has at least one dom_regime that is feasible.
      neighbors_constrained_dict (dictionary): The dictionary for ld_regime neighbors of this ld_regime that are feasible under constraints applied to each dom_regime.</p>







              <details class="quote">
                <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span>
<span class="normal"><a href="#__codelineno-0-99">99</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="k">class</span><span class="w"> </span><span class="nc">rop_ld_regime</span><span class="p">:</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">  The ld_regime object, for a given ld (log derivative or reaction order), there could be multiple dominance regimes (defined by dominance relations in x for a given catalytic activity on top of a binding network).</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Each ld_regime has possibly several dominance regimes with the same ld.</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Args:</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        ld (tuple of integers): The log derivative, or reaction order, of this ld_regime.</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        b_vec (numpy array vector): The b vector defining the activity, b^T x.</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        bn (binding_network object): The binding network that this ld_regime belongs to.</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        is_ray (boolean): Whether this ld_regime is a ray or not.</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        dom_regime_keys (list of tuples): The list of tuples, each tuple is the key for a dominance regime that has reaction order (ld) the same as this ld_regime.</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        dom_regime_dict (dictionary): The dictionary with key as the tuple (perm, dom_idx) representing a dominance regime and value of the dominance regime object.</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        neighbors_dict (dictionary): The dictionary for ld_regime neighbors of this ld_regime.</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            Has four keys, three of them are &quot;finite&quot;, &quot;infinite&quot;, and &quot;all&quot;,</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">            for finite, infinite (ray) ld_regime neighbors, and all of ld_regime neighbors, respectively.</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            For each of these keys, we get a dictionary as well, with ld tuple as key and the ld_regime object as value.</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            The last key is &quot;zero&quot;, which maps to neighbors connected via ld_regimes that are zero rays. The value is itself a dictionary with &quot;finite&quot;, &quot;infinite&quot;, and &quot;all&quot; mapping to dictionaries with (ld: ld_regime) entries.</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        is_feasible (boolean): Whether this ld_regime is feasible. It is feasible if it has at least one dom_regime that is feasible.</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        neighbors_constrained_dict (dictionary): The dictionary for ld_regime neighbors of this ld_regime that are feasible under constraints applied to each dom_regime.</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33"></a>  <span class="c1"># b_vec defines an activity, yielding possibly multiple regimes for each vertex,</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34"></a>  <span class="c1"># with logder corresponding to different rows of the vertex logder matrix.</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35"></a>  <span class="c1"># ld_regime focus on logder, collapsing the same logder to be the same ld_regime,</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36"></a>  <span class="c1"># which may come from different vertices.</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37"></a>  <span class="c1"># Each ld_regime has multiple dom_regimes and regions of feasibility.</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ld</span><span class="p">,</span><span class="n">is_ray</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">dom_regime_keys</span><span class="p">,</span><span class="n">bn</span><span class="p">):</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Args:</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        ld (tuple of integers): The log derivative, or reaction order, of this ld_regime.</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        is_ray (bool): Whether this ld_regime is a ray or not.</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        b_vec (numpy array): The b vector defining the activity, b^T x.</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        dom_regime_keys (list of tuples): The list of tuples, each tuple is the key for a dominance regime that has reaction order (ld) the same as this ld_regime.</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        bn (binding_network): The binding network that this ld_regime belongs to.</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ld</span><span class="o">=</span><span class="n">ld</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">=</span><span class="n">bn</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_ray</span><span class="o">=</span><span class="n">is_ray</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_keys</span><span class="o">=</span><span class="n">dom_regime_keys</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_dict</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">][</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dom_regime_keys</span><span class="p">}</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">find_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="c1"># Construct self.neighbors_dict based on dominance regimes&#39; neighbors,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="c1"># then construct neighbors_constrained_dict.</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">neighbors_fin</span><span class="o">=</span><span class="p">{};</span><span class="n">neighbors_inf</span><span class="o">=</span><span class="p">{};</span><span class="n">neighbors_fin_zero</span><span class="o">=</span><span class="p">{};</span><span class="n">neighbors_inf_zero</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="c1"># Instead of iterating through all ld_regimes, we just look at this ld_regime&#39;s</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="c1"># dom_regimes and their corresponding ld_regimes as neighbors.</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">dom_regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>      <span class="k">for</span> <span class="n">nb_key</span><span class="p">,</span><span class="n">nb_regime</span> <span class="ow">in</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">neighbors_fin</span><span class="p">[</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">][</span><span class="s1">&#39;finite&#39;</span><span class="p">][</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a>      <span class="k">for</span> <span class="n">nb_key</span><span class="p">,</span><span class="n">nb_regime</span> <span class="ow">in</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">neighbors_inf</span><span class="p">[</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">][</span><span class="s1">&#39;infinite&#39;</span><span class="p">][</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a>      <span class="k">for</span> <span class="n">nb_key</span><span class="p">,</span><span class="n">nb_regime</span> <span class="ow">in</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;zero&#39;</span><span class="p">][</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">neighbors_fin_zero</span><span class="p">[</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">][</span><span class="s1">&#39;finite&#39;</span><span class="p">][</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a>      <span class="k">for</span> <span class="n">nb_key</span><span class="p">,</span><span class="n">nb_regime</span> <span class="ow">in</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;zero&#39;</span><span class="p">][</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">neighbors_inf_zero</span><span class="p">[</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">][</span><span class="s1">&#39;infinite&#39;</span><span class="p">][</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">neighbors_all</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">neighbors_fin</span><span class="p">,</span><span class="o">**</span><span class="n">neighbors_inf</span><span class="p">}</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">neighbors_all_zero</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">neighbors_fin_zero</span><span class="p">,</span><span class="o">**</span><span class="n">neighbors_inf_zero</span><span class="p">}</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">neighbors_all</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">neighbors_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">neighbors_inf</span><span class="p">,</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>                         <span class="s1">&#39;zero&#39;</span><span class="p">:{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">neighbors_all_zero</span><span class="p">,</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">neighbors_fin_zero</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">neighbors_inf_zero</span><span class="p">}}</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">update_feasibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="c1"># Construct self.dom_regime_constrained_dict using dom_regime&#39;s is_feasible tag.</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="c1"># Then update self.is_feasible tag, True if self.dom_regime_constrained_dict is not empty,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="c1"># since this means there are some dom_regimes satisfying the constraints.</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_constrained_dict</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">regime</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">regime</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_constrained_dict</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="kc">False</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">update_constrained_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="c1"># Construct self.neighbors_constrained_dict based on dominance regimes&#39; neighbors_constrained_dict.</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="c1"># This does not distinguish neighbors via zero or not.</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">neighbors_constrained_fin</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">neighbors_constrained_inf</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="c1"># Instead of iterating through all ld_regimes, we just look at this ld_regime&#39;s</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="c1"># dom_regimes and their corresponding ld_regimes as neighbors.</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">dom_regime</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_constrained_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>      <span class="k">for</span> <span class="n">nb_key</span><span class="p">,</span><span class="n">nb_regime</span> <span class="ow">in</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_constrained_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">neighbors_constrained_fin</span><span class="p">[</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">][</span><span class="s1">&#39;finite&#39;</span><span class="p">][</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>      <span class="k">for</span> <span class="n">nb_key</span><span class="p">,</span><span class="n">nb_regime</span> <span class="ow">in</span> <span class="n">dom_regime</span><span class="o">.</span><span class="n">neighbors_constrained_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">neighbors_constrained_inf</span><span class="p">[</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_ld_regime_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">][</span><span class="s1">&#39;infinite&#39;</span><span class="p">][</span><span class="n">nb_regime</span><span class="o">.</span><span class="n">ld</span><span class="p">]</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">neighbors_constrained_all</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">neighbors_constrained_fin</span><span class="p">,</span><span class="o">**</span><span class="n">neighbors_constrained_inf</span><span class="p">}</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_constrained_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">neighbors_constrained_all</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>                                     <span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">neighbors_constrained_fin</span><span class="p">,</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>                                     <span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">neighbors_constrained_inf</span><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_ld_regime.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ld</span><span class="p">,</span> <span class="n">is_ray</span><span class="p">,</span> <span class="n">b_vec</span><span class="p">,</span> <span class="n">dom_regime_keys</span><span class="p">,</span> <span class="n">bn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ld</code>
            </td>
            <td>
                  <code>tuple of integers</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The log derivative, or reaction order, of this ld_regime.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_ray</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether this ld_regime is a ray or not.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b_vec</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The b vector defining the activity, b^T x.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dom_regime_keys</code>
            </td>
            <td>
                  <code>list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of tuples, each tuple is the key for a dominance regime that has reaction order (ld) the same as this ld_regime.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bn</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="binding_network (bcn.binding_network.binding_network)" href="#bcn.binding_network.binding_network">binding_network</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The binding network that this ld_regime belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ld</span><span class="p">,</span><span class="n">is_ray</span><span class="p">,</span><span class="n">b_vec</span><span class="p">,</span><span class="n">dom_regime_keys</span><span class="p">,</span><span class="n">bn</span><span class="p">):</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">  Args:</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">      ld (tuple of integers): The log derivative, or reaction order, of this ld_regime.</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">      is_ray (bool): Whether this ld_regime is a ray or not.</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">      b_vec (numpy array): The b vector defining the activity, b^T x.</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">      dom_regime_keys (list of tuples): The list of tuples, each tuple is the key for a dominance regime that has reaction order (ld) the same as this ld_regime.</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">      bn (binding_network): The binding network that this ld_regime belongs to.</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">ld</span><span class="o">=</span><span class="n">ld</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">b_vec</span><span class="p">)</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">=</span><span class="n">bn</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">is_ray</span><span class="o">=</span><span class="n">is_ray</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_keys</span><span class="o">=</span><span class="n">dom_regime_keys</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">dom_regime_dict</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">bn</span><span class="o">.</span><span class="n">activity_regime_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_vec</span><span class="p">][</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dom_regime_keys</span><span class="p">}</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="bcn.binding_network.rop_vertex" class="doc doc-heading">
            <code>rop_vertex</code>


</h2>


    <div class="doc doc-contents ">


        <p>A vertex object for reaction order polyhedra.
Each binding network has multiple vertices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>perm</code>
            </td>
            <td>
                  <code>int tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An integer tuple of length dim_d, indicating for each conserved quantity, 
which species is dominant.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bn</code>
            </td>
            <td>
                  <code>binding_network object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The binding network that this vertex belongs to.
Has l_mat (conservation law matrix) and n_mat (stoichiometry matrix).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_mat</code>
            </td>
            <td>
                  <code>numpy array, d-by-n</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>d x n matrix with exactly one nonzero entry in each row, 
of value 1. One-hot representation of perm.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p0_vec</code>
            </td>
            <td>
                  <code>numpy array, d-by-1</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector used in (logt, logk) = [p_mat n_mat]' logx + [p0_vec 0]'. 
Intercept relating log x to (logt, logk).
n_mat is that of the binding network.
p0_vec is all zeros if all entries of bn's l_mat are 0 and 1's.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m_mat</code>
            </td>
            <td>
                  <code>numpy array, n-by-n</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix formed by p_mat and n_mat stacked vertically. 
In other words, m_mat = [p_mat n_mat]'.
n_mat is that of the binding network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m0_vec</code>
            </td>
            <td>
                  <code>numpy array, n-by-1</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector used in (logt, logk) = m_mat logx + m0_vec.
m0_vec is the same as [p0_vec 0]', i.e., p0_vec vertically extended with r more zeros.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>orientation</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Take value in +1, 0, -1. Sign of determinant of [A' N'] matrix.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>h_mat</code>
            </td>
            <td>
                  <code>numpy array, n-by-n</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>n x n matrix corresponding to the log derivative of this vertex.
If finite (non-singular), then this is the log derivative.
If infinite (singular), then this is the direction that log derivative goes into.
At this vertex, we have relation logx = h_mat (logt, logk) + h0_vec.
Not always defined, computed and stored once log derivative is 
computed by calling self.vertex_ld_calc().</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>h0_vec</code>
            </td>
            <td>
                  <code>numpy array, n-by-1</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The intercept vector used in the following relation at this vertex:
logx = h_mat (logt, logk) + h0_vec.
Only defined for finite (non-singular) vertices.
Not always defined, computed and stored once log derivative is 
computed by calling self.vertex_ld_calc().</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_x</code>
            </td>
            <td>
                  <code>numpy array, shape (n_constraints, n_var</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix encoding feasibility condition of this vertex
in 'x' chart, c_mat_x * logx + c0_vec &gt; 0.
If the feasibility condition is considered "asymptotic", i.e., in positive
projective measure rather than Lebesgue measure (so a ray is an infinitesimal
of volume, not a point), then c0_vec is dropped.
Not always defined, computed and stored when used in feasibility tests.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_xak</code>
            </td>
            <td>
                  <code>numpy array, shape (n_constraints, n_var</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix encoding feasibility condition of this vertex
in 'xak' chart, c_mat_xak * (logxa, logk) + c0_vec &gt; 0.
If the feasibility condition is considered "asymptotic", i.e., in positive
projective measure rather than Lebesgue measure (so a ray is an infinitesimal
of volume, not a point), then c0_vec is dropped.
Not always defined, computed and stored when used in feasibility tests.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c0_vec</code>
            </td>
            <td>
                  <code>numpy vector, shape (n_constraints,</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy vector encoding a part of the feasibility condition of this vertex,
same for 'x' chart and 'xak' chart.
Not always defined, computed and stored when used in feasibility tests.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_tk</code>
            </td>
            <td>
                  <code>numpy array, shape (n_constraints, n_var</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix encoding feasibility condition of this vertex
in 'tk' chart, c_mat_tk * (logt, logk) + c0_vec_tk &gt; 0.
If the feasibility condition is considered "asymptotic", i.e., in positive
projective measure rather than Lebesgue measure (so a ray is an infinitesimal
of volume, not a point), then c0_vec_tk is dropped.
Only defined for finite (non-singular) vertices.
Not always defined, computed and stored when used in feasibility tests.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c0_vec_tk</code>
            </td>
            <td>
                  <code>numpy vector, shape (n_constraints,</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy vector encoding a part of the feasibility condition of this vertex
in the 'tk' chart.
Only defined for finite (non-singular) vertices.
Not always defined, computed and stored when used in feasibility tests.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>neighbors_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary for dom_regime neighbors of this dom_regime.
Has four keys: "finite", "infinite", "all", and "zero".
- "finite", "infinite", and "all" map to dictionaries with (perm, row_idx) tuple as keys 
  and the dom_regime object as values.
- "zero" maps to neighbors connected via dom_regimes that are zero rays in reaction orders 
  (or log derivative).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>neighbors_constrained_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary for ld_regime neighbors of this ld_regime that are feasible
under constraints applied to each dom_regime. 
Same keys as neighbors_dict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="k">class</span><span class="w"> </span><span class="nc">rop_vertex</span><span class="p">:</span>
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    A vertex object for reaction order polyhedra.</span>
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">    Each binding network has multiple vertices.</span>
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460"></a>
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    Args:</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        perm (int tuple): An integer tuple of length dim_d, indicating for each conserved quantity, </span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">            which species is dominant.</span>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        bn (binding_network object): The binding network that this vertex belongs to.</span>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">            Has l_mat (conservation law matrix) and n_mat (stoichiometry matrix).</span>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        p_mat (numpy array, d-by-n): d x n matrix with exactly one nonzero entry in each row, </span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">            of value 1. One-hot representation of perm.</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">        p0_vec (numpy array, d-by-1): Vector used in (logt, logk) = [p_mat n_mat]&#39; logx + [p0_vec 0]&#39;. </span>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">            Intercept relating log x to (logt, logk).</span>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">            n_mat is that of the binding network.</span>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">            p0_vec is all zeros if all entries of bn&#39;s l_mat are 0 and 1&#39;s.</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        m_mat (numpy array, n-by-n): Matrix formed by p_mat and n_mat stacked vertically. </span>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">            In other words, m_mat = [p_mat n_mat]&#39;.</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            n_mat is that of the binding network.</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        m0_vec (numpy array, n-by-1): Vector used in (logt, logk) = m_mat logx + m0_vec.</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">            m0_vec is the same as [p0_vec 0]&#39;, i.e., p0_vec vertically extended with r more zeros.</span>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        orientation (int): Take value in +1, 0, -1. Sign of determinant of [A&#39; N&#39;] matrix.</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        h_mat (numpy array, n-by-n): n x n matrix corresponding to the log derivative of this vertex.</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">            If finite (non-singular), then this is the log derivative.</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">            If infinite (singular), then this is the direction that log derivative goes into.</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">            At this vertex, we have relation logx = h_mat (logt, logk) + h0_vec.</span>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">            Not always defined, computed and stored once log derivative is </span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">            computed by calling self.vertex_ld_calc().</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        h0_vec (numpy array, n-by-1): The intercept vector used in the following relation at this vertex:</span>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">            logx = h_mat (logt, logk) + h0_vec.</span>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">            Only defined for finite (non-singular) vertices.</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">            Not always defined, computed and stored once log derivative is </span>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">            computed by calling self.vertex_ld_calc().</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">        c_mat_x (numpy array, shape (n_constraints, n_var)): Matrix encoding feasibility condition of this vertex</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">            in &#39;x&#39; chart, c_mat_x * logx + c0_vec &gt; 0.</span>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">            If the feasibility condition is considered &quot;asymptotic&quot;, i.e., in positive</span>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">            projective measure rather than Lebesgue measure (so a ray is an infinitesimal</span>
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">            of volume, not a point), then c0_vec is dropped.</span>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">            Not always defined, computed and stored when used in feasibility tests.</span>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        c_mat_xak (numpy array, shape (n_constraints, n_var)): Matrix encoding feasibility condition of this vertex</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">            in &#39;xak&#39; chart, c_mat_xak * (logxa, logk) + c0_vec &gt; 0.</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">            If the feasibility condition is considered &quot;asymptotic&quot;, i.e., in positive</span>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">            projective measure rather than Lebesgue measure (so a ray is an infinitesimal</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">            of volume, not a point), then c0_vec is dropped.</span>
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">            Not always defined, computed and stored when used in feasibility tests.</span>
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">        c0_vec (numpy vector, shape (n_constraints,)): Numpy vector encoding a part of the feasibility condition of this vertex,</span>
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">            same for &#39;x&#39; chart and &#39;xak&#39; chart.</span>
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">            Not always defined, computed and stored when used in feasibility tests.</span>
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        c_mat_tk (numpy array, shape (n_constraints, n_var)): Matrix encoding feasibility condition of this vertex</span>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">            in &#39;tk&#39; chart, c_mat_tk * (logt, logk) + c0_vec_tk &gt; 0.</span>
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">            If the feasibility condition is considered &quot;asymptotic&quot;, i.e., in positive</span>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">            projective measure rather than Lebesgue measure (so a ray is an infinitesimal</span>
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">            of volume, not a point), then c0_vec_tk is dropped.</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">            Only defined for finite (non-singular) vertices.</span>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">            Not always defined, computed and stored when used in feasibility tests.</span>
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        c0_vec_tk (numpy vector, shape (n_constraints,)): Numpy vector encoding a part of the feasibility condition of this vertex</span>
</span><span id="__span-0-512"><a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">            in the &#39;tk&#39; chart.</span>
</span><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">            Only defined for finite (non-singular) vertices.</span>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">            Not always defined, computed and stored when used in feasibility tests.</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        neighbors_dict (dict): The dictionary for dom_regime neighbors of this dom_regime.</span>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">            Has four keys: &quot;finite&quot;, &quot;infinite&quot;, &quot;all&quot;, and &quot;zero&quot;.</span>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            - &quot;finite&quot;, &quot;infinite&quot;, and &quot;all&quot; map to dictionaries with (perm, row_idx) tuple as keys </span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">              and the dom_regime object as values.</span>
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">            - &quot;zero&quot; maps to neighbors connected via dom_regimes that are zero rays in reaction orders </span>
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">              (or log derivative).</span>
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        neighbors_constrained_dict (dict): The dictionary for ld_regime neighbors of this ld_regime that are feasible</span>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">            under constraints applied to each dom_regime. </span>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            Same keys as neighbors_dict.</span>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">perm</span><span class="p">,</span><span class="n">bn</span><span class="p">):</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">    Initiates a ROP vertex.</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    Args:</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        perm (int tuple): An integer tuple of length dim_d, indicating for each conserved quantity, </span>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            which species is dominant.</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">        bn (binding_network object): The binding network that this vertex is a part of.</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            Used to get dimensions and stoichiometry matrix.</span>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="o">=</span><span class="n">perm</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">=</span><span class="n">bn</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="n">p_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">,</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span> <span class="c1"># p_mat is all 0 and 1</span>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="n">p0_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">)</span> <span class="c1"># the value of nonzero entries of l_mat chosen by p_mat in each row for this vertex</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">):</span>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a>      <span class="n">p_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a>      <span class="n">p0_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">l_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_mat</span><span class="o">=</span><span class="n">p_mat</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p0_vec</span><span class="o">=</span><span class="n">p0_vec</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p_mat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">n_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m0_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p0_vec</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_r</span><span class="p">)),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span><span class="p">))</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_ld_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="c1"># calculate log derivative matrix,</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="c1"># gives ray direction matrix if infinite vertex</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="n">dim_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="n">m_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c1"># if singular, get the ray direction</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a>      <span class="n">m_mult_left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">dim_n</span><span class="p">),</span><span class="n">m_mat</span><span class="p">)</span>
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556"></a>      <span class="n">m_mult_right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">m_mat</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557"></a>      <span class="n">temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span> <span class="p">(</span><span class="n">m_mult_left</span><span class="p">,</span><span class="n">m_mult_right</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-558"><a id="__codelineno-0-558" name="__codelineno-0-558"></a>      <span class="c1"># the following assertion test is not necessary if guaranteed to be rank 1 singularity.</span>
</span><span id="__span-0-559"><a id="__codelineno-0-559" name="__codelineno-0-559"></a>      <span class="c1"># assert temp.shape[1]-np.linalg.matrix_rank(temp)==1, &quot;the vertex is singular in more than one direction.&quot;</span>
</span><span id="__span-0-560"><a id="__codelineno-0-560" name="__codelineno-0-560"></a>      <span class="c1"># we assert that an infinite vertex cannot be singular in more than one direction</span>
</span><span id="__span-0-561"><a id="__codelineno-0-561" name="__codelineno-0-561"></a>      <span class="c1"># so the ray is always rank 1. We assume higher order rays are convex combinations of first order rays.</span>
</span><span id="__span-0-562"><a id="__codelineno-0-562" name="__codelineno-0-562"></a>      <span class="n">rslt</span><span class="o">=</span><span class="n">null_space</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</span><span id="__span-0-563"><a id="__codelineno-0-563" name="__codelineno-0-563"></a>      <span class="c1"># the following normalizes the entries to largest entry = 1.</span>
</span><span id="__span-0-564"><a id="__codelineno-0-564" name="__codelineno-0-564"></a>      <span class="n">h_mat_coarse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">rslt</span><span class="p">,(</span><span class="n">dim_n</span><span class="p">,</span><span class="n">dim_n</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span> <span class="c1">#order=&#39;F&#39; is earlier index changes first. here fortran</span>
</span><span id="__span-0-565"><a id="__codelineno-0-565" name="__codelineno-0-565"></a>      <span class="n">temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h_mat_coarse</span><span class="p">)</span>
</span><span id="__span-0-566"><a id="__codelineno-0-566" name="__codelineno-0-566"></a>      <span class="n">minfactor</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="n">temp</span><span class="o">&gt;</span><span class="mf">1e-7</span><span class="p">])</span>
</span><span id="__span-0-567"><a id="__codelineno-0-567" name="__codelineno-0-567"></a>      <span class="n">h_mat_coarse_int</span><span class="o">=</span><span class="n">h_mat_coarse</span><span class="o">/</span><span class="n">minfactor</span> <span class="c1">#all non-zero entries are now integers</span>
</span><span id="__span-0-568"><a id="__codelineno-0-568" name="__codelineno-0-568"></a>      <span class="n">h_mat_int</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">h_mat_coarse_int</span><span class="p">)</span>
</span><span id="__span-0-569"><a id="__codelineno-0-569" name="__codelineno-0-569"></a>      <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h_mat_int</span><span class="o">-</span><span class="n">h_mat_coarse_int</span><span class="p">))</span> <span class="o">&lt;</span><span class="mf">1e-3</span><span class="p">,</span> <span class="s1">&#39;rounding of h_mat for vertices caused large error.&#39;</span>
</span><span id="__span-0-570"><a id="__codelineno-0-570" name="__codelineno-0-570"></a>      <span class="n">h_mat</span><span class="o">=</span><span class="n">h_mat_int</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">h_mat_int</span><span class="p">)</span> <span class="c1"># normalize largest entry to 1.</span>
</span><span id="__span-0-571"><a id="__codelineno-0-571" name="__codelineno-0-571"></a>
</span><span id="__span-0-572"><a id="__codelineno-0-572" name="__codelineno-0-572"></a>      <span class="c1"># now we need to check the directionality. This utilizes neighbors</span>
</span><span id="__span-0-573"><a id="__codelineno-0-573" name="__codelineno-0-573"></a>      <span class="n">vv_nb</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-574"><a id="__codelineno-0-574" name="__codelineno-0-574"></a>      <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">vv_nb</span><span class="o">.</span><span class="n">h_mat</span><span class="o">+</span><span class="mf">1e5</span><span class="o">*</span><span class="n">h_mat</span><span class="p">))</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">orientation</span><span class="p">:</span>
</span><span id="__span-0-575"><a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="n">h_mat</span><span class="o">=-</span><span class="mi">1</span><span class="o">*</span><span class="n">h_mat</span>
</span><span id="__span-0-576"><a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">else</span><span class="p">:</span> <span class="c1"># if not singular, just invert the matrix.</span>
</span><span id="__span-0-577"><a id="__codelineno-0-577" name="__codelineno-0-577"></a>      <span class="n">h_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">m_mat</span><span class="p">)</span>
</span><span id="__span-0-578"><a id="__codelineno-0-578" name="__codelineno-0-578"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">h0_vec</span> <span class="o">=</span> <span class="o">-</span><span class="n">h_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m0_vec</span><span class="p">)</span> <span class="c1"># only non-singular vertices have h0_vec.</span>
</span><span id="__span-0-579"><a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">h_mat</span><span class="o">=</span><span class="n">h_mat</span>
</span><span id="__span-0-580"><a id="__codelineno-0-580" name="__codelineno-0-580"></a>
</span><span id="__span-0-581"><a id="__codelineno-0-581" name="__codelineno-0-581"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_c_mat_x_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582"></a>    <span class="c1"># Get feasibility condition for this vertex expressed in (x) chart.</span>
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583"></a>    <span class="c1"># c_mat*log(x) + c0_vec &gt; 0 is the validity condition, log is log10.</span>
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="n">l_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a>    <span class="n">j_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_mat</span><span class="p">,</span><span class="n">l_mat</span><span class="p">)</span>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="n">dim</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">j_list</span><span class="p">])</span>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="n">c_mat_x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a>    <span class="n">c0_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="n">dim_n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">):</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a>      <span class="n">j_i</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a>      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">j_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="n">c_mat_x</span><span class="p">[</span><span class="n">counter</span><span class="p">,</span><span class="n">j_i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="n">c_mat_x</span><span class="p">[</span><span class="n">counter</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">c0_vec</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">l_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j_i</span><span class="p">])</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">l_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span><span class="o">=</span><span class="n">c_mat_x</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span> <span class="o">=</span> <span class="n">c0_vec</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">j_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p_mat</span><span class="p">,</span><span class="n">l_mat</span><span class="p">):</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">    For p_mat and l_mat, find (column) indices that are nonzero in each row of</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">    l_mat but not nonzero in p_mat.</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">    Args:</span>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">        p_mat (numpy array): d-by-n matrix, each row has only one nonzero entry that is 1.</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        l_mat (numpy array): d-by-n matrix, binding network&#39;s conservation law matrix.</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        j_list (list of int): List of (column) indices that are nonzero in l_mat but zero in p_mat.</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a>    <span class="n">j_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="n">l_mat_masked</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l_mat</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">p_mat</span><span class="p">)</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a>      <span class="n">j_list</span><span class="o">+=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">l_mat_masked</span><span class="p">[</span><span class="n">i</span><span class="p">,:])[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="k">return</span> <span class="n">j_list</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_feasibility_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="p">[],</span><span class="n">positive_threshold</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span><span class="n">is_asymptotic</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    For given constraints, compute whether this vertex is feasible.</span>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">    Args:</span>
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">        chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">            Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        opt_constraints (list of cvxpy inequalities, optional): A list of optimization constraints specified in terms of inequalities</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">            relating cvxpy variables of the binding network.</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        positive_threshold (float, optional): The vertex itself has inequality conditions, of the form c_mat*x + c0_vec &gt; th,</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            where th is the positive threshold used here. Defaults to 1e-5.</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        is_asymptotic (bool, optional): Whether the inequalities of the vertex itself should be considered asymptotically</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">            or exactly. If asymptotically, then the inequality tested omits c0_vec,</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">            so it is c_mat*x &gt; th. is_asymptotic=True corresponds to inequality satisfied</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">            for the positive projective measure (where a ray is an infinitesimal of volume),</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            and is_asymptotic=False is Lebesgue measure (a point is an infinitesimal of volume).</span>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">        is_feasible (bool): Whether this vertex is feasible under the constraints.</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a>    <span class="c1"># first prepare the c_mat and c0_vec for the desired chart.</span>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a>    <span class="n">c_mat</span><span class="p">,</span><span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_check</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a>    <span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="n">opt_var</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">opt_var</span> <span class="c1">#opt_var came from the binding network.</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="k">if</span> <span class="n">is_asymptotic</span><span class="p">:</span> <span class="c1">#if asymptotic, c0_vec is zero.</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>      <span class="n">prob</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">opt_constraints</span><span class="o">+</span><span class="p">[</span><span class="n">c_mat</span> <span class="o">@</span> <span class="n">opt_var</span> <span class="o">&gt;=</span> <span class="n">positive_threshold</span><span class="p">])</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="k">else</span><span class="p">:</span> <span class="c1"># if not asymptotic, it is exact, so c0_vec is taken into account.</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a>      <span class="n">prob</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">opt_constraints</span><span class="o">+</span><span class="p">[</span><span class="n">c_mat</span> <span class="o">@</span> <span class="n">opt_var</span> <span class="o">+</span> <span class="n">c0_vec</span> <span class="o">&gt;=</span> <span class="n">positive_threshold</span><span class="p">])</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a>    <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a>    <span class="k">if</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="o">==</span><span class="s1">&#39;infeasible&#39;</span><span class="p">:</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a>      <span class="n">is_feasible</span><span class="o">=</span><span class="kc">False</span>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a>    <span class="k">return</span> <span class="n">is_feasible</span>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_find_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="c1"># Given a binding network with (already-computed) vertex dictionaries,</span>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a>    <span class="c1">#   compute this vertex&#39;s neighbors and store in self.neighbors,</span>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="c1">#   depending on whether it is finite or infinite.</span>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a>    <span class="c1"># Neighbor is defined as changing one row by moving the &quot;1&quot; to another place.</span>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a>    <span class="c1"># For chart &#39;x&#39;, neighbor is more nuanced.</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="c1">#   For example, (0,7,7) can have a neighbor (7,1,7) because it has </span>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a>    <span class="c1">#     neighbor (7,7,7), which is shared with (7,1,7).</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="c1">#   But we do not consider (7,7,7) as an &quot;infinite vertex&quot;,</span>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a>    <span class="c1">#     since &gt;1 order infinite vertices only matter as a </span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="c1">#     &quot;connecting region&quot;, and they are ignored in vertex construction. </span>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="c1">#   To include these cases, for an infinite vertex perm1, for a given candidate </span>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="c1">#     infinite neighbor perm 2, if difference is 2 then of course it&#39;s a neighbor,</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a>    <span class="c1">#     e.g. (5,5,2) and (5,5,3); if difference is more than 2, then switch the</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="c1">#     differing rows&#39; order and see whether now they match with difference in just one row.</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="c1">#   Since whenever this is the case, there is the regime (j,j,j,*)</span>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a>    <span class="n">neighbors_fin</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="n">neighbors_inf</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;finite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a>      <span class="c1"># temp=[not np.all(self.p_mat[i,:]==vv.p_mat[i,:]) for i in range(self.bn.dim_d)]</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a>      <span class="c1"># if np.sum(temp)==1: #the difference is just one row</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>      <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_mat</span><span class="o">-</span><span class="n">vv</span><span class="o">.</span><span class="n">p_mat</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span> <span class="c1">#difference is in just one row and it&#39;s -1, 1.</span>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">neighbors_fin</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vv</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a>    <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">vertex_dict</span><span class="p">[</span><span class="s1">&#39;infinite&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a>      <span class="c1"># temp=[not np.all(self.p_mat[i,:]==vv.p_mat[i,:]) for i in range(self.bn.dim_d)]</span>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a>      <span class="c1"># if np.sum(temp)==1: #the difference is just one row</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a>      <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_mat</span><span class="o">-</span><span class="n">vv</span><span class="o">.</span><span class="n">p_mat</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span> <span class="c1">#difference is in just one row and it&#39;s -1, 1.</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="n">neighbors_inf</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span><span class="o">=</span><span class="n">vv</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="c1"># if self.orientation==0:</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="n">neighbors_all</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">neighbors_fin</span><span class="p">,</span><span class="o">**</span><span class="n">neighbors_inf</span><span class="p">}</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">neighbors_fin</span><span class="p">,</span><span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">neighbors_inf</span><span class="p">,</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">neighbors_all</span><span class="p">}</span>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a>
</span><span id="__span-0-685"><a id="__codelineno-0-685" name="__codelineno-0-685"></a>
</span><span id="__span-0-686"><a id="__codelineno-0-686" name="__codelineno-0-686"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_update_constrained_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-687"><a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="c1"># Using vertices&#39; is_feasible tag to have updated neighbors under constraints.</span>
</span><span id="__span-0-688"><a id="__codelineno-0-688" name="__codelineno-0-688"></a>    <span class="c1"># The feasible neighbors of an infeasible neighbor becomes this vertex&#39;s neighbors</span>
</span><span id="__span-0-689"><a id="__codelineno-0-689" name="__codelineno-0-689"></a>    <span class="c1"># under constraints.</span>
</span><span id="__span-0-690"><a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="c1"># If an infeasible neighbor has infeasible neighbors as well, we need to look at</span>
</span><span id="__span-0-691"><a id="__codelineno-0-691" name="__codelineno-0-691"></a>    <span class="c1"># their feasible neighbors as neighbors under constraint as well.</span>
</span><span id="__span-0-692"><a id="__codelineno-0-692" name="__codelineno-0-692"></a>    <span class="c1"># So this uses recursion.</span>
</span><span id="__span-0-693"><a id="__codelineno-0-693" name="__codelineno-0-693"></a>    <span class="c1"># The resulting constrained neighbors is stored in self.neighbors_constrained_dict.</span>
</span><span id="__span-0-694"><a id="__codelineno-0-694" name="__codelineno-0-694"></a>
</span><span id="__span-0-695"><a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_infeasible_neighbor</span><span class="p">(</span><span class="n">neighbors_all</span><span class="p">,</span><span class="n">neighbors_feasible_all</span><span class="p">,</span><span class="n">visited</span><span class="p">):</span>
</span><span id="__span-0-696"><a id="__codelineno-0-696" name="__codelineno-0-696"></a>      <span class="n">infeasible_neighbors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-697"><a id="__codelineno-0-697" name="__codelineno-0-697"></a>        <span class="n">perm</span><span class="p">:</span> <span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">neighbors_all</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span>
</span><span id="__span-0-698"><a id="__codelineno-0-698" name="__codelineno-0-698"></a>      <span class="p">}</span>
</span><span id="__span-0-699"><a id="__codelineno-0-699" name="__codelineno-0-699"></a>      <span class="k">if</span> <span class="n">infeasible_neighbors</span><span class="p">:</span>  <span class="c1"># the dictionary is not empty</span>
</span><span id="__span-0-700"><a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">infeasible_neighbors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-701"><a id="__codelineno-0-701" name="__codelineno-0-701"></a>            <span class="k">if</span> <span class="n">perm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span><span id="__span-0-702"><a id="__codelineno-0-702" name="__codelineno-0-702"></a>                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
</span><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703"></a>                <span class="n">neighbors_feasible_all</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">vv</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">})</span>
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704"></a>                <span class="n">neighbors_feasible_all</span><span class="p">,</span> <span class="n">visited</span> <span class="o">=</span> <span class="n">extract_infeasible_neighbor</span><span class="p">(</span>
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705"></a>                  <span class="n">vv</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">],</span>
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706"></a>                  <span class="n">neighbors_feasible_all</span><span class="p">,</span>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707"></a>                  <span class="n">visited</span>
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708"></a>                <span class="p">)</span>
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709"></a>      <span class="k">return</span> <span class="n">neighbors_feasible_all</span><span class="p">,</span> <span class="n">visited</span>
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710"></a>
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="c1"># first, each neighbor that is feasible should be a neighbor under constraint.</span>
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="n">neighbors_feasible_all</span> <span class="o">=</span> <span class="p">{</span><span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">}</span>
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714"></a>
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="n">neighbors_feasible_all</span><span class="p">,</span><span class="n">visited</span> <span class="o">=</span> <span class="n">extract_infeasible_neighbor</span><span class="p">(</span>
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">],</span><span class="n">neighbors_feasible_all</span><span class="p">,</span><span class="n">visited</span>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="p">)</span>
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="c1"># Remove self from the neighbors&#39; dictionaries if present</span>
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="k">del</span> <span class="n">neighbors_feasible_all</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="p">]</span>
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="k">pass</span>
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="n">neighbors_feasible_inf</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">neighbors_feasible_all</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="mi">0</span>
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="p">}</span>
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="n">neighbors_feasible_fin</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="n">perm</span><span class="p">:</span><span class="n">vv</span> <span class="k">for</span> <span class="n">perm</span><span class="p">,</span><span class="n">vv</span> <span class="ow">in</span> <span class="n">neighbors_feasible_all</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">vv</span><span class="o">.</span><span class="n">orientation</span><span class="o">!=</span><span class="mi">0</span>
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="p">}</span>
</span><span id="__span-0-729"><a id="__codelineno-0-729" name="__codelineno-0-729"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbors_constrained_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;finite&#39;</span><span class="p">:</span><span class="n">neighbors_feasible_fin</span><span class="p">,</span>
</span><span id="__span-0-730"><a id="__codelineno-0-730" name="__codelineno-0-730"></a>                                  <span class="s1">&#39;infinite&#39;</span><span class="p">:</span><span class="n">neighbors_feasible_inf</span><span class="p">,</span>
</span><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731"></a>                                  <span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">neighbors_feasible_all</span><span class="p">}</span>
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732"></a>
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_c_mat_xak_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-734"><a id="__codelineno-0-734" name="__codelineno-0-734"></a>    <span class="c1"># get the C matrix but for log(xa,k) coordinate</span>
</span><span id="__span-0-735"><a id="__codelineno-0-735" name="__codelineno-0-735"></a>    <span class="c1"># store as self.c_mat_xak</span>
</span><span id="__span-0-736"><a id="__codelineno-0-736" name="__codelineno-0-736"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">c_mat_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span>
</span><span id="__span-0-737"><a id="__codelineno-0-737" name="__codelineno-0-737"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-738"><a id="__codelineno-0-738" name="__codelineno-0-738"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_x_calc</span><span class="p">()</span>
</span><span id="__span-0-739"><a id="__codelineno-0-739" name="__codelineno-0-739"></a>      <span class="n">c_mat_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span>
</span><span id="__span-0-740"><a id="__codelineno-0-740" name="__codelineno-0-740"></a>    <span class="k">try</span><span class="p">:</span> <span class="n">xak2x_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">xak2x_map</span>
</span><span id="__span-0-741"><a id="__codelineno-0-741" name="__codelineno-0-741"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-742"><a id="__codelineno-0-742" name="__codelineno-0-742"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">calc_xak2x_map</span><span class="p">()</span>
</span><span id="__span-0-743"><a id="__codelineno-0-743" name="__codelineno-0-743"></a>      <span class="n">xak2x_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">xak2x_map</span>
</span><span id="__span-0-744"><a id="__codelineno-0-744" name="__codelineno-0-744"></a>    <span class="n">c_mat_xak</span><span class="o">=</span><span class="n">c_mat_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">xak2x_map</span><span class="p">)</span>
</span><span id="__span-0-745"><a id="__codelineno-0-745" name="__codelineno-0-745"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_mat_xak</span><span class="o">=</span><span class="n">c_mat_xak</span>
</span><span id="__span-0-746"><a id="__codelineno-0-746" name="__codelineno-0-746"></a>
</span><span id="__span-0-747"><a id="__codelineno-0-747" name="__codelineno-0-747"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_c_mat_tk_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-748"><a id="__codelineno-0-748" name="__codelineno-0-748"></a>    <span class="c1"># get the C matrix but for log(t,k) coordinate</span>
</span><span id="__span-0-749"><a id="__codelineno-0-749" name="__codelineno-0-749"></a>    <span class="c1"># store as self.c_mat_tk</span>
</span><span id="__span-0-750"><a id="__codelineno-0-750" name="__codelineno-0-750"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;only finite vertices can have non-singular (t,k) chart&quot;</span>
</span><span id="__span-0-751"><a id="__codelineno-0-751" name="__codelineno-0-751"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-752"><a id="__codelineno-0-752" name="__codelineno-0-752"></a>      <span class="n">c_mat_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span>
</span><span id="__span-0-753"><a id="__codelineno-0-753" name="__codelineno-0-753"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="__span-0-754"><a id="__codelineno-0-754" name="__codelineno-0-754"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_x_calc</span><span class="p">()</span>
</span><span id="__span-0-755"><a id="__codelineno-0-755" name="__codelineno-0-755"></a>      <span class="n">c_mat_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span>
</span><span id="__span-0-756"><a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="c1"># The equivalence here is the following:</span>
</span><span id="__span-0-757"><a id="__codelineno-0-757" name="__codelineno-0-757"></a>    <span class="c1"># c_mat_tk @ log(t,k) + c0_vec_tk &gt;=0  &lt;=&gt;  c_mat_x @ logx + c0_vec &gt;=0</span>
</span><span id="__span-0-758"><a id="__codelineno-0-758" name="__codelineno-0-758"></a>    <span class="n">c_mat_tk</span><span class="o">=</span><span class="n">c_mat_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_mat</span><span class="p">)</span> <span class="c1">#because h_mat*log(t,k)=log(x)</span>
</span><span id="__span-0-759"><a id="__codelineno-0-759" name="__codelineno-0-759"></a>    <span class="n">c0_vec_tk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span> <span class="o">-</span> <span class="n">c_mat_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m0_vec</span><span class="p">))</span>
</span><span id="__span-0-760"><a id="__codelineno-0-760" name="__codelineno-0-760"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span><span class="o">=</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-761"><a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span><span class="o">=</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-762"><a id="__codelineno-0-762" name="__codelineno-0-762"></a>
</span><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">chart_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chart</span><span class="p">):</span>
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">    Prepare the c_mat and c0_vec for the desired chart.</span>
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766"></a>
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">    Args:</span>
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">        chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">            Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770"></a>
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">        c_mat (ndarray, shape (n_constraints, n_var)): Matrix used in this vertex&#39;s feasibility condition in the </span>
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">            desired chart, e.g., it is c_mat * x + c0_vec &gt; 0 in chart &#39;x&#39;.</span>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">        c0_vec (ndarray, shape (n_constraints,)): The vector used in this vertex&#39;s feasibility condition in the</span>
</span><span id="__span-0-775"><a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">            desired chart, e.g., it is c_mat * x + c0_vec &gt; 0 in chart &#39;x&#39;.</span>
</span><span id="__span-0-776"><a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777"></a>    <span class="k">if</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778"></a>      <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span>
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781"></a>      <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># if c_mat_x is not yet calculated</span>
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_x_calc</span><span class="p">()</span>
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span>
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span>
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;xak&#39;</span><span class="p">:</span>
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786"></a>      <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_xak</span>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span> <span class="c1">#c0_vec is the same for chart x and xak.</span>
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789"></a>      <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># if c_mat_xak is not yet calculated</span>
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_xak_calc</span><span class="p">()</span>
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791"></a>        <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_xak</span>
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span>
</span><span id="__span-0-793"><a id="__codelineno-0-793" name="__codelineno-0-793"></a>    <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;tk&#39;</span><span class="p">:</span>
</span><span id="__span-0-794"><a id="__codelineno-0-794" name="__codelineno-0-794"></a>      <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795"></a>        <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797"></a>      <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># if c_mat_xak is not yet calculated</span>
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_tk_calc</span><span class="p">()</span>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802"></a>      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;chart that is not one of x,xak or tk is not implemented yet&#39;</span><span class="p">)</span>
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="k">return</span> <span class="n">c_mat</span><span class="p">,</span><span class="n">c0_vec</span>
</span><span id="__span-0-804"><a id="__codelineno-0-804" name="__codelineno-0-804"></a>
</span><span id="__span-0-805"><a id="__codelineno-0-805" name="__codelineno-0-805"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_hull_of_validity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">    Compute the vertices of the validity region as a bounded convex hull.</span>
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808"></a>
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">    Args:</span>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">        chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">            Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">        margin (float, optional): The vertex&#39;s feasibility conditions are inequalities, </span>
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">            of the form c_mat*x + c0_vec &gt;= margin (e.g., in &#39;x&#39; chart),</span>
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">            Margin defaults to 0, and its values are in log10.</span>
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">            This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">            every variable. </span>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">            every variable. </span>
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        c_mat_extra (ndarray, shape (n_constraints, n_var)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">            in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        c0_vec_extra (numpy vector, shape (n_constraints,)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">            in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</span>
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826"></a>
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        points (ndarray): The points corresponding to vertices of the convex hull that is the </span>
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">            region of validity.</span>
</span><span id="__span-0-830"><a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">        feasible_point (ndarray vector): The point that is feasible in the interior of the convex hull.</span>
</span><span id="__span-0-831"><a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">        hs (scipy.spatial.HalfspaceIntersection): The half space intersection built from the feasibility inequalities.</span>
</span><span id="__span-0-832"><a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833"></a>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834"></a>    <span class="c1"># first check whether logmin and logmax are scalars or vectors.</span>
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835"></a>    <span class="k">try</span><span class="p">:</span> 
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836"></a>      <span class="nb">float</span><span class="p">(</span><span class="n">logmin</span><span class="p">)</span> <span class="c1"># if logmin and logmax are scalars</span>
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837"></a>      <span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">logmin</span><span class="p">,</span><span class="n">logmax</span><span class="p">]]),</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#bounding box to make polyhedra bounded</span>
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="c1"># if logmin and logmax are vectors</span>
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839"></a>      <span class="c1"># stack them horizontally as column vectors</span>
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840"></a>      <span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">logmin</span><span class="p">[:,</span><span class="kc">None</span><span class="p">],</span><span class="n">logmax</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]))</span>
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841"></a>
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842"></a>    <span class="n">c_mat</span><span class="p">,</span><span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_check</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843"></a>
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844"></a>    <span class="c1"># the inequality c_mat*var + c0_vec - margin &gt;= 0, becomes A*var + b &lt;=0</span>
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845"></a>    <span class="c1"># where A = -c_mat, and b = th - c0_vec.</span>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846"></a>    <span class="c1"># With extra constraints, margin is always 0 for extra constraints,</span>
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="c1"># so margin_full = vstack((margin,zeros)) where zeros is of length len(c0_vec_extra)</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">c_mat_extra</span><span class="p">):</span> <span class="c1"># if there are additional constraints</span>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a>      <span class="n">c_mat_full</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">c_mat</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="p">))</span>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a>      <span class="n">c0_vec_full</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">c0_vec</span><span class="p">,</span><span class="n">c0_vec_extra</span><span class="p">))</span>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a>      <span class="n">margin_vec_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">margin</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c0_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">c0_vec_extra</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a>    <span class="k">else</span><span class="p">:</span> <span class="c1"># there are no additional constraints</span>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a>      <span class="n">c_mat_full</span><span class="o">=</span><span class="n">c_mat</span> 
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a>      <span class="n">c0_vec_full</span> <span class="o">=</span> <span class="n">c0_vec</span>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a>      <span class="n">margin_vec_full</span> <span class="o">=</span> <span class="n">margin</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c0_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a>    <span class="n">A</span><span class="o">=-</span><span class="n">c_mat_full</span> <span class="c1"># negtive because the optimization code is for Ax+b&lt;=0, while our notation is c_mat*x+c0_vec &gt;=0.</span>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a>    <span class="n">b</span><span class="o">=</span><span class="n">margin_vec_full</span> <span class="o">-</span> <span class="n">c0_vec_full</span>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a>    <span class="n">points</span><span class="p">,</span> <span class="n">hull</span><span class="p">,</span> <span class="n">feasible_point</span><span class="p">,</span> <span class="n">hs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_convex_hull</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">bbox</span><span class="p">)</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a>    <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">hull</span><span class="p">,</span> <span class="n">feasible_point</span><span class="p">,</span><span class="n">hs</span>
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861"></a>
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">__feasible_point_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863"></a>    <span class="c1"># Finds the center of the largest sphere fitting in the convex hull of</span>
</span><span id="__span-0-864"><a id="__codelineno-0-864" name="__codelineno-0-864"></a>    <span class="c1">#   A x + b &lt;= 0.</span>
</span><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865"></a>    <span class="c1"># Use method in description of scipy.spatial.HalfspaceIntersection.</span>
</span><span id="__span-0-866"><a id="__codelineno-0-866" name="__codelineno-0-866"></a>    <span class="c1"># Based on Chebyshev center finding of Boyd&#39;s book 4.3.1</span>
</span><span id="__span-0-867"><a id="__codelineno-0-867" name="__codelineno-0-867"></a>    <span class="c1"># Needs to solve max y s.t. A x + y |A_i| + b &lt;= 0. A_i are rows of A,</span>
</span><span id="__span-0-868"><a id="__codelineno-0-868" name="__codelineno-0-868"></a>    <span class="c1">#   so |A_i| is the norm vector of rows of A.</span>
</span><span id="__span-0-869"><a id="__codelineno-0-869" name="__codelineno-0-869"></a>    <span class="c1"># We transform this inequality into min c*x, A_lp x &lt;= b_lp,</span>
</span><span id="__span-0-870"><a id="__codelineno-0-870" name="__codelineno-0-870"></a>    <span class="c1">#   standard form of a linear program,</span>
</span><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="c1">#   where c=(0,...,0,-1) so that c*x = x[-1] = y, and x[:-1] is x above,</span>
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="c1">#   A_lp = hstack(A,|A_i|). b_lp is the same as -b, but as a column vector.</span>
</span><span id="__span-0-873"><a id="__codelineno-0-873" name="__codelineno-0-873"></a>    <span class="n">norm_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Frobenius norm</span>
</span><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874"></a>    <span class="n">A_linprog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span> <span class="n">norm_vector</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]))</span> 
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875"></a>    <span class="n">b_linprog</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="c1"># this makes b into shape len(b)-by-1.</span>
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876"></a>    <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,))</span>
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877"></a>    <span class="n">c</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_linprog</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_linprog</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879"></a>    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">status</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span> <span class="nb">breakpoint</span><span class="p">()</span>
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880"></a>    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881"></a>
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">__add_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">bbox</span><span class="p">):</span>
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883"></a>    <span class="c1"># in case A x + b &lt;= 0 is not bounded, add a bounding box specified by bbox.</span>
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884"></a>    <span class="c1"># bbox is an array, n-by-2, the ith row is (min,max) of x_i.</span>
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885"></a>    <span class="c1"># Transform: bbox[i,0] is min, so x_i &gt;= bbox[i,0] becomes -x_i + bbox[i,0] &lt;=0.</span>
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886"></a>    <span class="c1">#   This is encoded in A&#39;s entry is -I, and b&#39;s entry is bbox[i,0].</span>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887"></a>    <span class="c1">#   Similarly for max, A&#39;s entry is +I, and b&#39;s entry is -bbox[i,1].</span>
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888"></a>    <span class="n">dim_n</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889"></a>    <span class="n">A_bounded</span><span class="o">=</span><span class="n">A</span>
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890"></a>    <span class="n">b_bounded</span><span class="o">=</span><span class="n">b</span>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim_n</span><span class="p">):</span>
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892"></a>      <span class="n">A_bounded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">A_bounded</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dim_n</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dim_n</span><span class="p">,</span><span class="n">i</span><span class="p">)))</span>
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893"></a>      <span class="n">b_bounded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">b_bounded</span><span class="p">,</span><span class="n">bbox</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">bbox</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="k">return</span> <span class="n">A_bounded</span><span class="p">,</span> <span class="n">b_bounded</span>   
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">__hs_intersection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">feasible_point</span><span class="p">):</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a>    <span class="c1"># HalfspaceIntersection take the convention halfspaces=[A;b]</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a>    <span class="c1">#   to indicate A x + b &lt;= 0.</span>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="n">halfspaces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]))</span>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a>    <span class="c1"># hs = HalfspaceIntersection(halfspaces, feasible_point,qhull_options=&#39;QJ&#39;) #QJ option to joggle to avoid non-full-dimensional constraints.</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="c1"># Qt option to triangulate all the time to avoid precision issues.</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a>    <span class="c1"># This is helpful to avoid problems since later on the &quot;ConvexHull&quot;</span>
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="c1">#   function uses this Qt option.</span>
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904"></a>    <span class="n">hs</span> <span class="o">=</span> <span class="n">HalfspaceIntersection</span><span class="p">(</span><span class="n">halfspaces</span><span class="p">,</span> <span class="n">feasible_point</span><span class="p">,</span><span class="n">qhull_options</span><span class="o">=</span><span class="s1">&#39;Qt&#39;</span><span class="p">)</span> 
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a>    <span class="k">return</span> <span class="n">hs</span>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">A_local</span><span class="p">,</span> <span class="n">b_local</span><span class="p">,</span> <span class="n">bbox</span><span class="p">):</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a>    <span class="c1"># Given A,b for halfspace intersection A x + b &lt;=0,</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a>    <span class="c1">#   and bounding box bbox,</span>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a>    <span class="c1">#   get the vertices of the convex hull that formed.</span>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="c1"># Modified from https://stackoverflow.com/questions/65343771/solve-linear-inequalities</span>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a>    <span class="n">A_bounded</span><span class="p">,</span> <span class="n">b_bounded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__add_bbox</span><span class="p">(</span><span class="n">A_local</span><span class="p">,</span> <span class="n">b_local</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a>    <span class="n">feasible_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__feasible_point_calc</span><span class="p">(</span><span class="n">A_bounded</span><span class="p">,</span> <span class="n">b_bounded</span><span class="p">)</span>
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915"></a>    <span class="n">hs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__hs_intersection</span><span class="p">(</span><span class="n">A_bounded</span><span class="p">,</span> <span class="n">b_bounded</span><span class="p">,</span> <span class="n">feasible_point</span><span class="p">)</span>
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="c1"># hs = hs_intersection(A, b, interior_point)</span>
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">intersections</span>
</span><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918"></a>    <span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">qhull_options</span><span class="o">=</span><span class="s1">&#39;Q12&#39;</span><span class="p">)</span> <span class="c1"># to allow wide facets and dulbridge... meaning what???</span>
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a>    <span class="k">return</span> <span class="n">points</span><span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">],</span><span class="n">feasible_point</span><span class="p">,</span> <span class="n">hs</span>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_hull_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    Sample points in the vertex&#39;s region of validity based on its hull of feasible regions.</span>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">    Extra conditions (linear) can be added as c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">    Args:</span>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        nsample (int): Number of points to be sampled.</span>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">        margin (float, optional): The vertex&#39;s feasibility conditions are inequalities, </span>
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            of the form c_mat*x + c0_vec &gt;= margin (e.g., in &#39;x&#39; chart),</span>
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            where margin is the margin used here. Defaults to 0.</span>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            every variable. </span>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            They could also be vectors of length dim_n.</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">        logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            every variable. </span>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">            They could also is vectors of length dim_n.</span>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">        c_mat_extra (ndarray, shape (n_constraints, n_var)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">            in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        c0_vec_extra (numpy vector, shape (n_constraints,)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">            in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">        sample (ndarray of shape nsample-by-dim_n): dim_n is number of species in the binding network.</span>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">            Sampled points satisfying the feasibility conditions of this vertex.</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            Each row (sample[i,:]) is a sampled point.</span>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="c1"># first compute the convex hull for this vertex&#39;s validity and get the vertex points.</span>
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952"></a>    <span class="n">points</span><span class="p">,</span><span class="n">hull</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_hull_of_validity</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span><span class="n">logmin</span><span class="o">=</span><span class="n">logmin</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="n">logmax</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="n">c_mat_extra</span><span class="p">,</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="n">c0_vec_extra</span><span class="p">)</span>
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="n">sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__dist_in_hull</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">points_are_vertices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="c1"># To sample a simplex in n-dim uniformly, take n uniform(0,1) random </span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="c1">#   variables and take difference after padding 0 at the beginning and</span>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a>    <span class="c1">#   1 at the end. This gives a vector of n-dim in the simplex, with</span>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="c1">#   a probability density that is uniform in the simplex.</span>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a>    <span class="c1">#   See https://cs.stackexchange.com/questions/3227/uniform-sampling-from-a-simplex</span>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a>    <span class="c1"># ncoeffs=points.shape[0]</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a>    <span class="c1"># temp=np.sort(np.random.rand(nsample,ncoeffs-1),axis=1)</span>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="c1"># coeffs=np.diff(temp,prepend=0,append=1,axis=1)</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a>    <span class="c1"># sample=coeffs@points # this has shape nsample-by-dim_n</span>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="k">return</span> <span class="n">sample</span>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">__dist_in_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">points</span><span class="p">,</span> <span class="n">nsample</span><span class="p">,</span> <span class="n">points_are_vertices</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">    Create uniform sample over convex hulls by Delaunay triangulation.</span>
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">    Adapted from https://stackoverflow.com/questions/59073952/how-to-get-uniformly-distributed-points-in-convex-hull</span>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">    Args:</span>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">        points (ndarray, shape (num_points, dim)): Points whose convex hull is to be sampled uniformly.</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">        nsample (int): Number of points to be sampled.</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">        points_are_vertices (bool, optional): If True, points are assumed to be vertices.</span>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">            If False, convex hull of points is first taken to find vertices.</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">            Defaults to False.</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        sample (ndarray, shape (nsample, dim)): Sampled points uniformly in convex hull of points.</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a>    <span class="n">dims</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a>    <span class="k">if</span> <span class="n">points_are_vertices</span><span class="p">:</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a>      <span class="n">hull</span><span class="o">=</span><span class="n">points</span> 
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a>    <span class="k">else</span><span class="p">:</span> 
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a>      <span class="n">hull</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">ConvexHull</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">qhull_options</span><span class="o">=</span><span class="s1">&#39;Q12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a>    <span class="nb">breakpoint</span><span class="p">()</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a>    <span class="n">deln</span> <span class="o">=</span> <span class="n">hull</span><span class="p">[</span><span class="n">Delaunay</span><span class="p">(</span><span class="n">hull</span><span class="p">,</span><span class="n">qhull_options</span><span class="o">=</span><span class="s1">&#39;Q12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">simplices</span><span class="p">]</span>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a>    <span class="n">vols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">deln</span><span class="p">[:,</span> <span class="p">:</span><span class="n">dims</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">deln</span><span class="p">[:,</span> <span class="n">dims</span><span class="p">:,</span> <span class="p">:]))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>    
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vols</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="n">nsample</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">vols</span> <span class="o">/</span> <span class="n">vols</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijk, ij -&gt; ik&#39;</span><span class="p">,</span> <span class="n">deln</span><span class="p">[</span><span class="n">sample</span><span class="p">],</span> <span class="n">dirichlet</span><span class="o">.</span><span class="n">rvs</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">dims</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="n">nsample</span><span class="p">))</span>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertex_print_validity_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">is_asymptotic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">    Print the expression for t=x, x(t,k) and inequalities for the region of validity </span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">    given a regime, using the labels of x, t, k.</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">    Args:</span>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">        is_asymptotic (bool, optional): If False, the inequalities are shown with intercept.</span>
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">            If True, the inequalities are shown without intercept.</span>
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">        None: Prints a lot of text.</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>      <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>      <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># if c_mat_xak is not yet calculated</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_tk_calc</span><span class="p">()</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>      <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>      <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>    <span class="n">h_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">h_mat</span>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>    <span class="n">h0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">h0_vec</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>    <span class="n">p0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p0_vec</span>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>    <span class="n">perm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">perm</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="n">x_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">x_sym</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>    <span class="n">tk_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">tk_sym</span>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;======This is vertex perm &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;======</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>    <span class="n">t2x_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">):</span>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>      <span class="n">p0</span><span class="o">=</span><span class="n">p0_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>      <span class="k">if</span> <span class="n">p0</span><span class="o">==</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">is_asymptotic</span><span class="p">:</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>        <span class="n">t2x_list</span><span class="o">+=</span><span class="p">[</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="n">x_sym</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="n">t2x_list</span><span class="o">+=</span><span class="p">[</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span> <span class="o">+</span> <span class="n">x_sym</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(1) t in x: t is dominated by... </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t2x_list</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="c1"># BELOW we obtain x&#39;s expression in terms of t,k by</span>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>    <span class="c1"># log(x) = h_mat * log(t,k) + h0_vec</span>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(2) x in tk: Vertex is singular, cannot express (x) in (t,k).&#39;</span><span class="p">)</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>      <span class="n">x2tk_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">):</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>        <span class="n">h_row</span><span class="o">=</span><span class="n">h_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="n">pos_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">h_row</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>        <span class="n">neg_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">h_row</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>        <span class="n">expr_pos</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">h_row</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="n">h_row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mf">1.0</span> <span class="k">else</span> <span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pos_idx</span><span class="p">])</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="n">expr_neg</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">h_row</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="o">-</span><span class="n">h_row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mf">1.0</span> <span class="k">else</span> <span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">neg_idx</span><span class="p">])</span>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>        <span class="k">if</span> <span class="n">neg_idx</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>          <span class="n">expr</span><span class="o">=</span><span class="n">expr_pos</span>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>          <span class="n">expr</span><span class="o">=</span><span class="n">expr_pos</span> <span class="o">+</span> <span class="s1">&#39; / &#39;</span> <span class="o">+</span> <span class="n">expr_neg</span>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="n">h0</span><span class="o">=</span><span class="n">h0_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>        <span class="k">if</span> <span class="n">h0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>          <span class="n">x2tk_list</span><span class="o">+=</span><span class="p">[</span><span class="n">x_sym</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span><span class="o">+</span> <span class="n">expr</span><span class="p">]</span>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>          <span class="n">x2tk_list</span><span class="o">+=</span><span class="p">[</span><span class="n">x_sym</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="n">expr</span> <span class="o">+</span> <span class="s1">&#39; / &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">h0</span><span class="p">)]</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(2) x in tk: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x2tk_list</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>    <span class="n">ineq_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>      <span class="n">c_row</span><span class="o">=</span><span class="n">c_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>      <span class="n">pos_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c_row</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>      <span class="n">neg_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c_row</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>      <span class="n">expr_pos</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c_row</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="n">c_row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mf">1.0</span> <span class="k">else</span> <span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pos_idx</span><span class="p">])</span>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>      <span class="n">expr_neg</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">c_row</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="o">-</span><span class="n">c_row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mf">1.0</span> <span class="k">else</span> <span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">neg_idx</span><span class="p">])</span>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>      <span class="n">c0</span><span class="o">=</span><span class="n">c0_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>      <span class="k">if</span> <span class="n">c0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>        <span class="n">ineq_list</span><span class="o">+=</span><span class="p">[</span><span class="n">expr_pos</span> <span class="o">+</span> <span class="s1">&#39; &gt; &#39;</span> <span class="o">+</span> <span class="n">expr_neg</span><span class="p">]</span>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>        <span class="n">ineq_list</span><span class="o">+=</span><span class="p">[</span><span class="n">expr_pos</span> <span class="o">+</span> <span class="s1">&#39; &gt; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">c0</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">expr_neg</span><span class="p">]</span>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(3) BELOW is constraints for regions of validity </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ineq_list</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_vertex.__dist_in_hull" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__dist_in_hull</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">nsample</span><span class="p">,</span> <span class="n">points_are_vertices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create uniform sample over convex hulls by Delaunay triangulation.
Adapted from https://stackoverflow.com/questions/59073952/how-to-get-uniformly-distributed-points-in-convex-hull</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>points</code>
            </td>
            <td>
                  <code>ndarray, shape (num_points, dim</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Points whose convex hull is to be sampled uniformly.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nsample</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points to be sampled.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>points_are_vertices</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, points are assumed to be vertices.
If False, convex hull of points is first taken to find vertices.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>sample</code></td>            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="shape">shape</span>(<span title="nsample">nsample</span>, <span title="dim">dim</span>))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sampled points uniformly in convex hull of points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="k">def</span><span class="w"> </span><span class="nf">__dist_in_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">points</span><span class="p">,</span> <span class="n">nsample</span><span class="p">,</span> <span class="n">points_are_vertices</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">  Create uniform sample over convex hulls by Delaunay triangulation.</span>
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">  Adapted from https://stackoverflow.com/questions/59073952/how-to-get-uniformly-distributed-points-in-convex-hull</span>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">  Args:</span>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">      points (ndarray, shape (num_points, dim)): Points whose convex hull is to be sampled uniformly.</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">      nsample (int): Number of points to be sampled.</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">      points_are_vertices (bool, optional): If True, points are assumed to be vertices.</span>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">          If False, convex hull of points is first taken to find vertices.</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">          Defaults to False.</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">      sample (ndarray, shape (nsample, dim)): Sampled points uniformly in convex hull of points.</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a>  <span class="n">dims</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a>  <span class="k">if</span> <span class="n">points_are_vertices</span><span class="p">:</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a>    <span class="n">hull</span><span class="o">=</span><span class="n">points</span> 
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a>  <span class="k">else</span><span class="p">:</span> 
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a>    <span class="n">hull</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">ConvexHull</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">qhull_options</span><span class="o">=</span><span class="s1">&#39;Q12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a>  <span class="nb">breakpoint</span><span class="p">()</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a>  <span class="n">deln</span> <span class="o">=</span> <span class="n">hull</span><span class="p">[</span><span class="n">Delaunay</span><span class="p">(</span><span class="n">hull</span><span class="p">,</span><span class="n">qhull_options</span><span class="o">=</span><span class="s1">&#39;Q12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">simplices</span><span class="p">]</span>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a>  <span class="n">vols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">deln</span><span class="p">[:,</span> <span class="p">:</span><span class="n">dims</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">deln</span><span class="p">[:,</span> <span class="n">dims</span><span class="p">:,</span> <span class="p">:]))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>    
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a>  <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vols</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="n">nsample</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">vols</span> <span class="o">/</span> <span class="n">vols</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a>  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijk, ij -&gt; ik&#39;</span><span class="p">,</span> <span class="n">deln</span><span class="p">[</span><span class="n">sample</span><span class="p">],</span> <span class="n">dirichlet</span><span class="o">.</span><span class="n">rvs</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">dims</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="n">nsample</span><span class="p">))</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_vertex.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span> <span class="n">bn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initiates a ROP vertex.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>perm</code>
            </td>
            <td>
                  <code>int tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An integer tuple of length dim_d, indicating for each conserved quantity, 
which species is dominant.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bn</code>
            </td>
            <td>
                  <code>binding_network object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The binding network that this vertex is a part of.
Used to get dimensions and stoichiometry matrix.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">perm</span><span class="p">,</span><span class="n">bn</span><span class="p">):</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">  Initiates a ROP vertex.</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">  Args:</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">      perm (int tuple): An integer tuple of length dim_d, indicating for each conserved quantity, </span>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">          which species is dominant.</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">      bn (binding_network object): The binding network that this vertex is a part of.</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">          Used to get dimensions and stoichiometry matrix.</span>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="o">=</span><span class="n">perm</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">=</span><span class="n">bn</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a>  <span class="n">p_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">,</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span> <span class="c1"># p_mat is all 0 and 1</span>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a>  <span class="n">p0_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">)</span> <span class="c1"># the value of nonzero entries of l_mat chosen by p_mat in each row for this vertex</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">):</span>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="n">p_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="n">p0_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">l_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">p_mat</span><span class="o">=</span><span class="n">p_mat</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">p0_vec</span><span class="o">=</span><span class="n">p0_vec</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p_mat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">n_mat</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">m0_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p0_vec</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_r</span><span class="p">)),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_mat</span><span class="p">))</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_vertex.chart_check" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chart_check</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Prepare the c_mat and c0_vec for the desired chart.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string indicating the chart that the opt_constraints are specified in.
Choices are 'x','xak', and 'tk'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>c_mat</code></td>            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="shape">shape</span>(<span title="n_constraints">n_constraints</span>, <span title="n_var">n_var</span>))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix used in this vertex's feasibility condition in the 
desired chart, e.g., it is c_mat * x + c0_vec &gt; 0 in chart 'x'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>c0_vec</code></td>            <td>
                  <code>(<span title="ndarray">ndarray</span>, <span title="shape">shape</span>(<span title="n_constraints">n_constraints</span>))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vector used in this vertex's feasibility condition in the
desired chart, e.g., it is c_mat * x + c0_vec &gt; 0 in chart 'x'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="k">def</span><span class="w"> </span><span class="nf">chart_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chart</span><span class="p">):</span>
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">  Prepare the c_mat and c0_vec for the desired chart.</span>
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766"></a>
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">  Args:</span>
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">      chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">          Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770"></a>
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">      c_mat (ndarray, shape (n_constraints, n_var)): Matrix used in this vertex&#39;s feasibility condition in the </span>
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">          desired chart, e.g., it is c_mat * x + c0_vec &gt; 0 in chart &#39;x&#39;.</span>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">      c0_vec (ndarray, shape (n_constraints,)): The vector used in this vertex&#39;s feasibility condition in the</span>
</span><span id="__span-0-775"><a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">          desired chart, e.g., it is c_mat * x + c0_vec &gt; 0 in chart &#39;x&#39;.</span>
</span><span id="__span-0-776"><a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777"></a>  <span class="k">if</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779"></a>      <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780"></a>      <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span>
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># if c_mat_x is not yet calculated</span>
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_x_calc</span><span class="p">()</span>
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783"></a>      <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_x</span>
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784"></a>      <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span>
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785"></a>  <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;xak&#39;</span><span class="p">:</span>
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787"></a>      <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_xak</span>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788"></a>      <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span> <span class="c1">#c0_vec is the same for chart x and xak.</span>
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># if c_mat_xak is not yet calculated</span>
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_xak_calc</span><span class="p">()</span>
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791"></a>      <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_xak</span>
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792"></a>      <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec</span>
</span><span id="__span-0-793"><a id="__codelineno-0-793" name="__codelineno-0-793"></a>  <span class="k">elif</span> <span class="n">chart</span><span class="o">==</span><span class="s1">&#39;tk&#39;</span><span class="p">:</span>
</span><span id="__span-0-794"><a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795"></a>      <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796"></a>      <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># if c_mat_xak is not yet calculated</span>
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798"></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_tk_calc</span><span class="p">()</span>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799"></a>      <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800"></a>      <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801"></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802"></a>    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;chart that is not one of x,xak or tk is not implemented yet&#39;</span><span class="p">)</span>
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803"></a>  <span class="k">return</span> <span class="n">c_mat</span><span class="p">,</span><span class="n">c0_vec</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_vertex.j_func" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">j_func</span><span class="p">(</span><span class="n">p_mat</span><span class="p">,</span> <span class="n">l_mat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>For p_mat and l_mat, find (column) indices that are nonzero in each row of
l_mat but not nonzero in p_mat.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>d-by-n matrix, each row has only one nonzero entry that is 1.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>l_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>d-by-n matrix, binding network's conservation law matrix.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>j_list</code></td>            <td>
                  <code>list of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (column) indices that are nonzero in l_mat but zero in p_mat.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="k">def</span><span class="w"> </span><span class="nf">j_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p_mat</span><span class="p">,</span><span class="n">l_mat</span><span class="p">):</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">  For p_mat and l_mat, find (column) indices that are nonzero in each row of</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">  l_mat but not nonzero in p_mat.</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">  Args:</span>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">      p_mat (numpy array): d-by-n matrix, each row has only one nonzero entry that is 1.</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">      l_mat (numpy array): d-by-n matrix, binding network&#39;s conservation law matrix.</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">      j_list (list of int): List of (column) indices that are nonzero in l_mat but zero in p_mat.</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a>  <span class="n">j_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>  <span class="n">l_mat_masked</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l_mat</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">p_mat</span><span class="p">)</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="n">j_list</span><span class="o">+=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">l_mat_masked</span><span class="p">[</span><span class="n">i</span><span class="p">,:])[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a>  <span class="k">return</span> <span class="n">j_list</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_vertex.vertex_feasibility_test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_feasibility_test</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">opt_constraints</span><span class="o">=</span><span class="p">[],</span> <span class="n">positive_threshold</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">is_asymptotic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>For given constraints, compute whether this vertex is feasible.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string indicating the chart that the opt_constraints are specified in.
Choices are 'x','xak', and 'tk'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opt_constraints</code>
            </td>
            <td>
                  <code>list of cvxpy inequalities</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of optimization constraints specified in terms of inequalities
relating cvxpy variables of the binding network.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>positive_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vertex itself has inequality conditions, of the form c_mat*x + c0_vec &gt; th,
where th is the positive threshold used here. Defaults to 1e-5.</p>
              </div>
            </td>
            <td>
                  <code>1e-05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_asymptotic</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the inequalities of the vertex itself should be considered asymptotically
or exactly. If asymptotically, then the inequality tested omits c0_vec,
so it is c_mat*x &gt; th. is_asymptotic=True corresponds to inequality satisfied
for the positive projective measure (where a ray is an infinitesimal of volume),
and is_asymptotic=False is Lebesgue measure (a point is an infinitesimal of volume).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>is_feasible</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether this vertex is feasible under the constraints.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="k">def</span><span class="w"> </span><span class="nf">vertex_feasibility_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">opt_constraints</span><span class="o">=</span><span class="p">[],</span><span class="n">positive_threshold</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span><span class="n">is_asymptotic</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">  For given constraints, compute whether this vertex is feasible.</span>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">  Args:</span>
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">      chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">          Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">      opt_constraints (list of cvxpy inequalities, optional): A list of optimization constraints specified in terms of inequalities</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">          relating cvxpy variables of the binding network.</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">      positive_threshold (float, optional): The vertex itself has inequality conditions, of the form c_mat*x + c0_vec &gt; th,</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">          where th is the positive threshold used here. Defaults to 1e-5.</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">      is_asymptotic (bool, optional): Whether the inequalities of the vertex itself should be considered asymptotically</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">          or exactly. If asymptotically, then the inequality tested omits c0_vec,</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">          so it is c_mat*x &gt; th. is_asymptotic=True corresponds to inequality satisfied</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">          for the positive projective measure (where a ray is an infinitesimal of volume),</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">          and is_asymptotic=False is Lebesgue measure (a point is an infinitesimal of volume).</span>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">      is_feasible (bool): Whether this vertex is feasible under the constraints.</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a>  <span class="c1"># first prepare the c_mat and c0_vec for the desired chart.</span>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a>  <span class="n">c_mat</span><span class="p">,</span><span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_check</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a>  <span class="n">is_feasible</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a>  <span class="n">opt_var</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">opt_var</span> <span class="c1">#opt_var came from the binding network.</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a>  <span class="k">if</span> <span class="n">is_asymptotic</span><span class="p">:</span> <span class="c1">#if asymptotic, c0_vec is zero.</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="n">prob</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">opt_constraints</span><span class="o">+</span><span class="p">[</span><span class="n">c_mat</span> <span class="o">@</span> <span class="n">opt_var</span> <span class="o">&gt;=</span> <span class="n">positive_threshold</span><span class="p">])</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a>  <span class="k">else</span><span class="p">:</span> <span class="c1"># if not asymptotic, it is exact, so c0_vec is taken into account.</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a>    <span class="n">prob</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">opt_constraints</span><span class="o">+</span><span class="p">[</span><span class="n">c_mat</span> <span class="o">@</span> <span class="n">opt_var</span> <span class="o">+</span> <span class="n">c0_vec</span> <span class="o">&gt;=</span> <span class="n">positive_threshold</span><span class="p">])</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a>  <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a>  <span class="k">if</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="o">==</span><span class="s1">&#39;infeasible&#39;</span><span class="p">:</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a>    <span class="n">is_feasible</span><span class="o">=</span><span class="kc">False</span>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a>  <span class="k">return</span> <span class="n">is_feasible</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_vertex.vertex_hull_of_validity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_hull_of_validity</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span> <span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the vertices of the validity region as a bounded convex hull.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string indicating the chart that the opt_constraints are specified in.
Choices are 'x','xak', and 'tk'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>margin</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vertex's feasibility conditions are inequalities, 
of the form c_mat*x + c0_vec &gt;= margin (e.g., in 'x' chart),
Margin defaults to 0, and its values are in log10.
This can be adjusted to be stronger/weaker requirements on dominance.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmin</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to 
every variable. 
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>-6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmax</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to 
every variable. 
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_extra</code>
            </td>
            <td>
                  <code>ndarray, shape (n_constraints, n_var</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra optimization constraints to be added to feasibility conditions,
in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c0_vec_extra</code>
            </td>
            <td>
                  <code>numpy vector, shape (n_constraints,</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra optimization constraints to be added to feasibility conditions,
in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>points</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The points corresponding to vertices of the convex hull that is the 
region of validity.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>feasible_point</code></td>            <td>
                  <code>ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The point that is feasible in the interior of the convex hull.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>hs</code></td>            <td>
                  <code><span title="scipy.spatial.HalfspaceIntersection">HalfspaceIntersection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The half space intersection built from the feasibility inequalities.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-805"><a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="k">def</span><span class="w"> </span><span class="nf">vertex_hull_of_validity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">  Compute the vertices of the validity region as a bounded convex hull.</span>
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808"></a>
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">  Args:</span>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">      chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">          Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">      margin (float, optional): The vertex&#39;s feasibility conditions are inequalities, </span>
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">          of the form c_mat*x + c0_vec &gt;= margin (e.g., in &#39;x&#39; chart),</span>
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">          Margin defaults to 0, and its values are in log10.</span>
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">          This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">      logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">          every variable. </span>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">      logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">          every variable. </span>
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">      c_mat_extra (ndarray, shape (n_constraints, n_var)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">          in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">      c0_vec_extra (numpy vector, shape (n_constraints,)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">          in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</span>
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826"></a>
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">      points (ndarray): The points corresponding to vertices of the convex hull that is the </span>
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">          region of validity.</span>
</span><span id="__span-0-830"><a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">      feasible_point (ndarray vector): The point that is feasible in the interior of the convex hull.</span>
</span><span id="__span-0-831"><a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">      hs (scipy.spatial.HalfspaceIntersection): The half space intersection built from the feasibility inequalities.</span>
</span><span id="__span-0-832"><a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833"></a>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834"></a>  <span class="c1"># first check whether logmin and logmax are scalars or vectors.</span>
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835"></a>  <span class="k">try</span><span class="p">:</span> 
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836"></a>    <span class="nb">float</span><span class="p">(</span><span class="n">logmin</span><span class="p">)</span> <span class="c1"># if logmin and logmax are scalars</span>
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">logmin</span><span class="p">,</span><span class="n">logmax</span><span class="p">]]),</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#bounding box to make polyhedra bounded</span>
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838"></a>  <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="c1"># if logmin and logmax are vectors</span>
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="c1"># stack them horizontally as column vectors</span>
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">logmin</span><span class="p">[:,</span><span class="kc">None</span><span class="p">],</span><span class="n">logmax</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]))</span>
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841"></a>
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842"></a>  <span class="n">c_mat</span><span class="p">,</span><span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_check</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843"></a>
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844"></a>  <span class="c1"># the inequality c_mat*var + c0_vec - margin &gt;= 0, becomes A*var + b &lt;=0</span>
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845"></a>  <span class="c1"># where A = -c_mat, and b = th - c0_vec.</span>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846"></a>  <span class="c1"># With extra constraints, margin is always 0 for extra constraints,</span>
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a>  <span class="c1"># so margin_full = vstack((margin,zeros)) where zeros is of length len(c0_vec_extra)</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a>  <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">c_mat_extra</span><span class="p">):</span> <span class="c1"># if there are additional constraints</span>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="n">c_mat_full</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">c_mat</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="p">))</span>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a>    <span class="n">c0_vec_full</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">c0_vec</span><span class="p">,</span><span class="n">c0_vec_extra</span><span class="p">))</span>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a>    <span class="n">margin_vec_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">margin</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c0_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">c0_vec_extra</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a>  <span class="k">else</span><span class="p">:</span> <span class="c1"># there are no additional constraints</span>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a>    <span class="n">c_mat_full</span><span class="o">=</span><span class="n">c_mat</span> 
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a>    <span class="n">c0_vec_full</span> <span class="o">=</span> <span class="n">c0_vec</span>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a>    <span class="n">margin_vec_full</span> <span class="o">=</span> <span class="n">margin</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c0_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a>  <span class="n">A</span><span class="o">=-</span><span class="n">c_mat_full</span> <span class="c1"># negtive because the optimization code is for Ax+b&lt;=0, while our notation is c_mat*x+c0_vec &gt;=0.</span>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a>  <span class="n">b</span><span class="o">=</span><span class="n">margin_vec_full</span> <span class="o">-</span> <span class="n">c0_vec_full</span>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a>  <span class="n">points</span><span class="p">,</span> <span class="n">hull</span><span class="p">,</span> <span class="n">feasible_point</span><span class="p">,</span> <span class="n">hs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_convex_hull</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">bbox</span><span class="p">)</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a>  <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">hull</span><span class="p">,</span> <span class="n">feasible_point</span><span class="p">,</span><span class="n">hs</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_vertex.vertex_hull_sampling" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_hull_sampling</span><span class="p">(</span><span class="n">nsample</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span> <span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sample points in the vertex's region of validity based on its hull of feasible regions.
Extra conditions (linear) can be added as c_mat_extra @ var + c0_vec_extra &gt;= 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nsample</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points to be sampled.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chart</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string indicating the chart that the opt_constraints are specified in.
Choices are 'x','xak', and 'tk'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>margin</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vertex's feasibility conditions are inequalities, 
of the form c_mat*x + c0_vec &gt;= margin (e.g., in 'x' chart),
where margin is the margin used here. Defaults to 0.
This can be adjusted to be stronger/weaker requirements on dominance.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmin</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to 
every variable. 
They could also be vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>-6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logmax</code>
            </td>
            <td>
                  <code>float or ndarray vector</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>logmin, logmax could be scalars, then it's the same value applied to 
every variable. 
They could also is vectors of length dim_n.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mat_extra</code>
            </td>
            <td>
                  <code>ndarray, shape (n_constraints, n_var</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra optimization constraints to be added to feasibility conditions,
in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c0_vec_extra</code>
            </td>
            <td>
                  <code>numpy vector, shape (n_constraints,</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra optimization constraints to be added to feasibility conditions,
in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>sample</code></td>            <td>
                  <code>ndarray of shape nsample-by-dim_n</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dim_n is number of species in the binding network.
Sampled points satisfying the feasibility conditions of this vertex.
Each row (sample[i,:]) is a sampled point.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="k">def</span><span class="w"> </span><span class="nf">vertex_hull_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">logmin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="p">[],</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">  Sample points in the vertex&#39;s region of validity based on its hull of feasible regions.</span>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">  Extra conditions (linear) can be added as c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">  Args:</span>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">      nsample (int): Number of points to be sampled.</span>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">      chart (str, optional): A string indicating the chart that the opt_constraints are specified in.</span>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">          Choices are &#39;x&#39;,&#39;xak&#39;, and &#39;tk&#39;.</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">      margin (float, optional): The vertex&#39;s feasibility conditions are inequalities, </span>
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">          of the form c_mat*x + c0_vec &gt;= margin (e.g., in &#39;x&#39; chart),</span>
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">          where margin is the margin used here. Defaults to 0.</span>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">          This can be adjusted to be stronger/weaker requirements on dominance.</span>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">      logmin (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">          every variable. </span>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">          They could also be vectors of length dim_n.</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">      logmax (float or ndarray vector): logmin, logmax could be scalars, then it&#39;s the same value applied to </span>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">          every variable. </span>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">          They could also is vectors of length dim_n.</span>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">      c_mat_extra (ndarray, shape (n_constraints, n_var)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">          in the form of c_mat_extra @ var + c0_vec_extra &gt;= 0.</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">      c0_vec_extra (numpy vector, shape (n_constraints,)): Extra optimization constraints to be added to feasibility conditions,</span>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">          in the form of c_mat_extra @ var + c0_vec_extra &gt;=0.</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">      sample (ndarray of shape nsample-by-dim_n): dim_n is number of species in the binding network.</span>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">          Sampled points satisfying the feasibility conditions of this vertex.</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">          Each row (sample[i,:]) is a sampled point.</span>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a>  <span class="c1"># first compute the convex hull for this vertex&#39;s validity and get the vertex points.</span>
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952"></a>  <span class="n">points</span><span class="p">,</span><span class="n">hull</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_hull_of_validity</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span><span class="n">logmin</span><span class="o">=</span><span class="n">logmin</span><span class="p">,</span><span class="n">logmax</span><span class="o">=</span><span class="n">logmax</span><span class="p">,</span><span class="n">c_mat_extra</span><span class="o">=</span><span class="n">c_mat_extra</span><span class="p">,</span><span class="n">c0_vec_extra</span><span class="o">=</span><span class="n">c0_vec_extra</span><span class="p">)</span>
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a>  <span class="n">sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__dist_in_hull</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">nsample</span><span class="p">,</span><span class="n">points_are_vertices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a>  <span class="c1"># To sample a simplex in n-dim uniformly, take n uniform(0,1) random </span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a>  <span class="c1">#   variables and take difference after padding 0 at the beginning and</span>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a>  <span class="c1">#   1 at the end. This gives a vector of n-dim in the simplex, with</span>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a>  <span class="c1">#   a probability density that is uniform in the simplex.</span>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a>  <span class="c1">#   See https://cs.stackexchange.com/questions/3227/uniform-sampling-from-a-simplex</span>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a>  <span class="c1"># ncoeffs=points.shape[0]</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a>  <span class="c1"># temp=np.sort(np.random.rand(nsample,ncoeffs-1),axis=1)</span>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a>  <span class="c1"># coeffs=np.diff(temp,prepend=0,append=1,axis=1)</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a>  <span class="c1"># sample=coeffs@points # this has shape nsample-by-dim_n</span>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a>  <span class="k">return</span> <span class="n">sample</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.binding_network.rop_vertex.vertex_print_validity_condition" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vertex_print_validity_condition</span><span class="p">(</span><span class="n">is_asymptotic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Print the expression for t=x, x(t,k) and inequalities for the region of validity 
given a regime, using the labels of x, t, k.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>is_asymptotic</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If False, the inequalities are shown with intercept.
If True, the inequalities are shown without intercept.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prints a lot of text.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/binding_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="k">def</span><span class="w"> </span><span class="nf">vertex_print_validity_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">is_asymptotic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">  Print the expression for t=x, x(t,k) and inequalities for the region of validity </span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">  given a regime, using the labels of x, t, k.</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">  Args:</span>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">      is_asymptotic (bool, optional): If False, the inequalities are shown with intercept.</span>
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">          If True, the inequalities are shown without intercept.</span>
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">  Returns:</span>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">      None: Prints a lot of text.</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>  <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>    <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>    <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>  <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="c1"># if c_mat_xak is not yet calculated</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_c_mat_tk_calc</span><span class="p">()</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>    <span class="n">c_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c_mat_tk</span>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>    <span class="n">c0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c0_vec_tk</span>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>  <span class="n">h_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">h_mat</span>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>  <span class="n">h0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">h0_vec</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>  <span class="n">p0_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p0_vec</span>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>  <span class="n">perm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">perm</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>  <span class="n">x_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">x_sym</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>  <span class="n">tk_sym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">tk_sym</span>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;======This is vertex perm &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;======</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>  <span class="n">t2x_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">):</span>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>    <span class="n">p0</span><span class="o">=</span><span class="n">p0_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>    <span class="k">if</span> <span class="n">p0</span><span class="o">==</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">is_asymptotic</span><span class="p">:</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>      <span class="n">t2x_list</span><span class="o">+=</span><span class="p">[</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="n">x_sym</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>      <span class="n">t2x_list</span><span class="o">+=</span><span class="p">[</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span> <span class="o">+</span> <span class="n">x_sym</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(1) t in x: t is dominated by... </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t2x_list</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>  <span class="c1"># BELOW we obtain x&#39;s expression in terms of t,k by</span>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>  <span class="c1"># log(x) = h_mat * log(t,k) + h0_vec</span>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(2) x in tk: Vertex is singular, cannot express (x) in (t,k).&#39;</span><span class="p">)</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>    <span class="n">x2tk_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">):</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>      <span class="n">h_row</span><span class="o">=</span><span class="n">h_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>      <span class="n">pos_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">h_row</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>      <span class="n">neg_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">h_row</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>      <span class="n">expr_pos</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">h_row</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="n">h_row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mf">1.0</span> <span class="k">else</span> <span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pos_idx</span><span class="p">])</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>      <span class="n">expr_neg</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">h_row</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="o">-</span><span class="n">h_row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mf">1.0</span> <span class="k">else</span> <span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">neg_idx</span><span class="p">])</span>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>      <span class="k">if</span> <span class="n">neg_idx</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="n">expr</span><span class="o">=</span><span class="n">expr_pos</span>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>        <span class="n">expr</span><span class="o">=</span><span class="n">expr_pos</span> <span class="o">+</span> <span class="s1">&#39; / &#39;</span> <span class="o">+</span> <span class="n">expr_neg</span>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>      <span class="n">h0</span><span class="o">=</span><span class="n">h0_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>      <span class="k">if</span> <span class="n">h0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>        <span class="n">x2tk_list</span><span class="o">+=</span><span class="p">[</span><span class="n">x_sym</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span><span class="o">+</span> <span class="n">expr</span><span class="p">]</span>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="n">x2tk_list</span><span class="o">+=</span><span class="p">[</span><span class="n">x_sym</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="n">expr</span> <span class="o">+</span> <span class="s1">&#39; / &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">h0</span><span class="p">)]</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(2) x in tk: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x2tk_list</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>  <span class="n">ineq_list</span><span class="o">=</span><span class="p">[]</span>
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="n">c_row</span><span class="o">=</span><span class="n">c_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>    <span class="n">pos_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c_row</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>    <span class="n">neg_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c_row</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>    <span class="n">expr_pos</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c_row</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="n">c_row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mf">1.0</span> <span class="k">else</span> <span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pos_idx</span><span class="p">])</span>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>    <span class="n">expr_neg</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">c_row</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">if</span> <span class="o">-</span><span class="n">c_row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mf">1.0</span> <span class="k">else</span> <span class="n">tk_sym</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">neg_idx</span><span class="p">])</span>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>    <span class="n">c0</span><span class="o">=</span><span class="n">c0_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">if</span> <span class="n">c0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>      <span class="n">ineq_list</span><span class="o">+=</span><span class="p">[</span><span class="n">expr_pos</span> <span class="o">+</span> <span class="s1">&#39; &gt; &#39;</span> <span class="o">+</span> <span class="n">expr_neg</span><span class="p">]</span>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>      <span class="n">ineq_list</span><span class="o">+=</span><span class="p">[</span><span class="n">expr_pos</span> <span class="o">+</span> <span class="s1">&#39; &gt; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">c0</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">expr_neg</span><span class="p">]</span>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(3) BELOW is constraints for regions of validity </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ineq_list</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h3 id="catalysis-networks">Catalysis Networks</h3>


<div class="doc doc-object doc-module">



<a id="bcn.catalysis_network"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="bcn.catalysis_network.binding_and_catalysis" class="doc doc-heading">
            <code>binding_and_catalysis</code>


</h2>


    <div class="doc doc-contents ">








              <details class="quote">
                <summary>Source code in <code>src/bcn/catalysis_network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">binding_and_catalysis</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bn</span><span class="p">,</span><span class="n">cn</span><span class="p">,</span><span class="n">kbind</span><span class="p">,</span><span class="n">kcat</span><span class="p">,</span><span class="n">total_const</span><span class="p">,</span><span class="n">total_const_idx</span><span class="p">,</span><span class="n">xcat_in_total_idx</span><span class="p">,</span><span class="n">cat_active_in_xbind_idx</span><span class="p">):</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Initiate a binding_and_catalysis object, which contains a binding network and a catalysis network, together with links between them.</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    On the catalysis time scale, the binding constants kbind don&#39;t change.</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29"></a>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Args:</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        bn (binding_network object): The binding network that specifies how the catalysis fluxes are regulated.</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            It defines the map from xcat (catalysis variables) to concentrations of catalytic active species responsible for the catalysis fluxes.</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            Flux v = kcat * cat_active.</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            It has to contain all the catalytic active species of the catalysis reactions, even if there are reactions that have constant rates. (That corresponds to a binding reaction that is just one atomic entry with constant total.)</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        cn (catalysis_network object): The catalysis network that specifies how the fluxes change molecular concentrations.</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        xcat_in_total_idx (tuple of integers): Indices for xcat as totals in the binding network bn. Length is &lt;= self.dim_ncat.</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            Length could be less than self.dim_ncat, since not necessarily all xcat are contained in totals.</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            The xcat contained in totals NEED TO COME FIRST in the ordering of xcat.</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            xcat = np.concatenate((total[xcat_in_total_idx], xcat[...])).</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        cat_active_in_xbind_idx (tuple of integers): Indices that the active species for the catalysis reactions correspond to in the xbind species in the binding network bn. Length is self.dim_mcat.</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">=</span><span class="n">bn</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">kbind</span><span class="o">=</span><span class="n">kbind</span> <span class="c1"># binding network&#39;s binding constants are fixed at the catalysis timescale</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">kcat</span><span class="o">=</span><span class="n">kcat</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logkbind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">kbind</span><span class="p">)</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_const</span><span class="o">=</span><span class="n">total_const</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logtotal_const</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">total_const</span><span class="p">)</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_const_idx</span><span class="o">=</span><span class="n">total_const_idx</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cn</span><span class="o">=</span><span class="n">cn</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">xcat_in_total_idx</span><span class="o">=</span><span class="n">xcat_in_total_idx</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cat_active_in_xbind_idx</span><span class="o">=</span><span class="n">cat_active_in_xbind_idx</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="c1"># # Extend cn.s_mat to shape bn.dim_d by cn.dim_mcat so that the dynamics for</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="c1"># #   every total in the binding networks is contained.</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="c1"># # These extra totals don&#39;t change, so their rows of s_mat are simply zeros.</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="c1"># self.s_mat_total=np.zeros((bn.dim_d,cn.dim_mcat))</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="c1"># self.s_mat_total[cn.xcat_in_total_idx,:]=cn.s_mat</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="c1"># MAYBE, no need to extend. Since all totals that are changed in the catalysis</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="c1">#   time scale are already contained in xcat. If they are not contained, then</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="c1">#   they don&#39;t change, so they can be plugged in as just a parameter.</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">dlogxcatdt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logxcat</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Calculate dlogxcat/dt for at a given logxcat point.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Args:</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        logxcat (numpy array): The vector of xcat in log10 indicating the current state of catalysis dynamics. Length is dim_ncat.</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            Entries of xcat corresponding to totals in the binding network need to come first.</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        a_mat (numpy array): Matrix defining totals in terms of xbind in the binding network. Shape is (bn.dim_d, bn.dim_n).</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            Correspond to conserved quantities at the binding timescale.</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            The default choice should be bn.l_mat.</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            Can be modified from bn.l_mat to describe restrictions or asymptotic limits of the system.</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">cn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cn</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">bn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">logtk</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">)</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">n_contained</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xcat_in_total_idx</span><span class="p">)</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">logtk</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xcat_in_total_idx</span><span class="p">]</span><span class="o">=</span><span class="n">logxcat</span><span class="p">[:</span><span class="n">n_contained</span><span class="p">]</span> <span class="c1"># totals come first in logtk</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="c1">#   and only n_contained number of xcat are contained in totals.</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="c1"># Then the last r are kbin.</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">logtk</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">total_const_idx</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logtotal_const</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="c1"># IS IT TRUE that all totals are contained in xcat? No. Some are constant...</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">logtk</span><span class="p">[</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">:]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logkbind</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">logxbind</span><span class="o">=</span><span class="n">bn</span><span class="o">.</span><span class="n">tk2x_num</span><span class="p">(</span><span class="n">logtk</span><span class="p">,</span> <span class="n">a_mat</span><span class="o">=</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="c1"># print(&#39;logxbind&#39;, logxbind)</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">vcat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kcat</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="mi">10</span><span class="o">**</span><span class="n">logxbind</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_active_in_xbind_idx</span><span class="p">]</span>  <span class="c1"># 2024/08/08 added transposition of kcat</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">vcat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">vcat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 2024/08/08 added</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">new_logxcat</span> <span class="o">=</span> <span class="p">(</span><span class="n">cn</span><span class="o">.</span><span class="n">s_mat</span><span class="nd">@vcat</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="n">logxcat</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># divide by xcat so that this kinetics of logxcat.</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">return</span> <span class="n">new_logxcat</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logxcat_init</span><span class="p">,</span><span class="n">t_init</span><span class="p">,</span><span class="n">t_end</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span><span class="n">get_logder_xbind</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1">#if a_mat is not specified, use l_mat by default.</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>      <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">func_int</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">dlogxcatdt</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">y0</span><span class="o">=</span><span class="n">logxcat_init</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t_init</span><span class="p">,</span><span class="n">t_end</span><span class="p">)</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">t_eval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_init</span><span class="p">,</span><span class="n">t_end</span><span class="p">,</span><span class="n">npts</span><span class="p">)</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">events</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>      <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># S in solution less than 1e-8 is not considable.</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">events</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">sol</span><span class="o">=</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">func_int</span><span class="p">,</span><span class="n">t_span</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">)</span>  <span class="c1"># BDF more suitalbe for stiff ODE</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">logxcat_traj</span><span class="o">=</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">T</span> <span class="c1"># transpose so time points come in the first dim.</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">if</span> <span class="n">get_logder_xbind</span><span class="p">:</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>      <span class="n">logder_traj</span><span class="p">,</span><span class="n">logxbind_traj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_logder_xbind_from_traj</span><span class="p">(</span><span class="n">logxcat_traj</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>      <span class="k">return</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">logxcat_traj</span><span class="p">,</span><span class="n">logxbind_traj</span><span class="p">,</span><span class="n">logder_traj</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>      <span class="k">return</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">logxcat_traj</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_logder_xbind_from_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logxcat_traj</span><span class="p">,</span><span class="n">a_mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a_mat</span><span class="p">):</span> <span class="c1">#if a_mat is not specified, use l_mat by default.</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>      <span class="n">a_mat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">.</span><span class="n">l_mat</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">cn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cn</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">bn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">npts</span><span class="o">=</span><span class="n">logxcat_traj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">logtk_traj</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npts</span><span class="p">,</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">))</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">n_contained</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xcat_in_total_idx</span><span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">logtk_traj</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">xcat_in_total_idx</span><span class="p">]</span><span class="o">=</span><span class="n">logxcat_traj</span><span class="p">[:,:</span><span class="n">n_contained</span><span class="p">]</span> <span class="c1"># totals come first in logtk</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">logtk_traj</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">total_const_idx</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logtotal_const</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">logtk_traj</span><span class="p">[:,</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">:]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logkbind</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">logder_traj</span><span class="p">,</span><span class="n">logxbind_traj</span><span class="o">=</span><span class="n">bn</span><span class="o">.</span><span class="n">logder_num</span><span class="p">(</span><span class="n">logtk_traj</span><span class="p">,</span><span class="n">chart</span><span class="o">=</span><span class="s1">&#39;tk&#39;</span><span class="p">)</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">return</span> <span class="n">logder_traj</span><span class="p">,</span><span class="n">logxbind_traj</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="bcn.catalysis_network.binding_and_catalysis.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">bn</span><span class="p">,</span> <span class="n">cn</span><span class="p">,</span> <span class="n">kbind</span><span class="p">,</span> <span class="n">kcat</span><span class="p">,</span> <span class="n">total_const</span><span class="p">,</span> <span class="n">total_const_idx</span><span class="p">,</span> <span class="n">xcat_in_total_idx</span><span class="p">,</span> <span class="n">cat_active_in_xbind_idx</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initiate a binding_and_catalysis object, which contains a binding network and a catalysis network, together with links between them.
On the catalysis time scale, the binding constants kbind don't change.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bn</code>
            </td>
            <td>
                  <code>binding_network object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The binding network that specifies how the catalysis fluxes are regulated.
It defines the map from xcat (catalysis variables) to concentrations of catalytic active species responsible for the catalysis fluxes.
Flux v = kcat * cat_active.
It has to contain all the catalytic active species of the catalysis reactions, even if there are reactions that have constant rates. (That corresponds to a binding reaction that is just one atomic entry with constant total.)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cn</code>
            </td>
            <td>
                  <code>catalysis_network object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The catalysis network that specifies how the fluxes change molecular concentrations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xcat_in_total_idx</code>
            </td>
            <td>
                  <code>tuple of integers</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indices for xcat as totals in the binding network bn. Length is &lt;= self.dim_ncat.
Length could be less than self.dim_ncat, since not necessarily all xcat are contained in totals.
The xcat contained in totals NEED TO COME FIRST in the ordering of xcat.
xcat = np.concatenate((total[xcat_in_total_idx], xcat[...])).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cat_active_in_xbind_idx</code>
            </td>
            <td>
                  <code>tuple of integers</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indices that the active species for the catalysis reactions correspond to in the xbind species in the binding network bn. Length is self.dim_mcat.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/catalysis_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bn</span><span class="p">,</span><span class="n">cn</span><span class="p">,</span><span class="n">kbind</span><span class="p">,</span><span class="n">kcat</span><span class="p">,</span><span class="n">total_const</span><span class="p">,</span><span class="n">total_const_idx</span><span class="p">,</span><span class="n">xcat_in_total_idx</span><span class="p">,</span><span class="n">cat_active_in_xbind_idx</span><span class="p">):</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">  Initiate a binding_and_catalysis object, which contains a binding network and a catalysis network, together with links between them.</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">  On the catalysis time scale, the binding constants kbind don&#39;t change.</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29"></a>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">  Args:</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">      bn (binding_network object): The binding network that specifies how the catalysis fluxes are regulated.</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">          It defines the map from xcat (catalysis variables) to concentrations of catalytic active species responsible for the catalysis fluxes.</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">          Flux v = kcat * cat_active.</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">          It has to contain all the catalytic active species of the catalysis reactions, even if there are reactions that have constant rates. (That corresponds to a binding reaction that is just one atomic entry with constant total.)</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">      cn (catalysis_network object): The catalysis network that specifies how the fluxes change molecular concentrations.</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">      xcat_in_total_idx (tuple of integers): Indices for xcat as totals in the binding network bn. Length is &lt;= self.dim_ncat.</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">          Length could be less than self.dim_ncat, since not necessarily all xcat are contained in totals.</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">          The xcat contained in totals NEED TO COME FIRST in the ordering of xcat.</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">          xcat = np.concatenate((total[xcat_in_total_idx], xcat[...])).</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">      cat_active_in_xbind_idx (tuple of integers): Indices that the active species for the catalysis reactions correspond to in the xbind species in the binding network bn. Length is self.dim_mcat.</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="o">=</span><span class="n">bn</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">kbind</span><span class="o">=</span><span class="n">kbind</span> <span class="c1"># binding network&#39;s binding constants are fixed at the catalysis timescale</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">kcat</span><span class="o">=</span><span class="n">kcat</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">logkbind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">kbind</span><span class="p">)</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">total_const</span><span class="o">=</span><span class="n">total_const</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">logtotal_const</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">total_const</span><span class="p">)</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">total_const_idx</span><span class="o">=</span><span class="n">total_const_idx</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">cn</span><span class="o">=</span><span class="n">cn</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">xcat_in_total_idx</span><span class="o">=</span><span class="n">xcat_in_total_idx</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">cat_active_in_xbind_idx</span><span class="o">=</span><span class="n">cat_active_in_xbind_idx</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bcn.catalysis_network.binding_and_catalysis.dlogxcatdt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dlogxcatdt</span><span class="p">(</span><span class="n">logxcat</span><span class="p">,</span> <span class="n">a_mat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate dlogxcat/dt for at a given logxcat point.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logxcat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vector of xcat in log10 indicating the current state of catalysis dynamics. Length is dim_ncat.
Entries of xcat corresponding to totals in the binding network need to come first.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix defining totals in terms of xbind in the binding network. Shape is (bn.dim_d, bn.dim_n).
Correspond to conserved quantities at the binding timescale.
The default choice should be bn.l_mat.
Can be modified from bn.l_mat to describe restrictions or asymptotic limits of the system.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/catalysis_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">def</span><span class="w"> </span><span class="nf">dlogxcatdt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">logxcat</span><span class="p">,</span><span class="n">a_mat</span><span class="p">):</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">  Calculate dlogxcat/dt for at a given logxcat point.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">  Args:</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">      logxcat (numpy array): The vector of xcat in log10 indicating the current state of catalysis dynamics. Length is dim_ncat.</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">          Entries of xcat corresponding to totals in the binding network need to come first.</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">      a_mat (numpy array): Matrix defining totals in terms of xbind in the binding network. Shape is (bn.dim_d, bn.dim_n).</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">          Correspond to conserved quantities at the binding timescale.</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">          The default choice should be bn.l_mat.</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">          Can be modified from bn.l_mat to describe restrictions or asymptotic limits of the system.</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>  <span class="n">cn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cn</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>  <span class="n">bn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>  <span class="n">logtk</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_n</span><span class="p">)</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>  <span class="n">n_contained</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xcat_in_total_idx</span><span class="p">)</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>  <span class="n">logtk</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">xcat_in_total_idx</span><span class="p">]</span><span class="o">=</span><span class="n">logxcat</span><span class="p">[:</span><span class="n">n_contained</span><span class="p">]</span> <span class="c1"># totals come first in logtk</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>  <span class="c1">#   and only n_contained number of xcat are contained in totals.</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>  <span class="c1"># Then the last r are kbin.</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a>  <span class="n">logtk</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">total_const_idx</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logtotal_const</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a>  <span class="c1"># IS IT TRUE that all totals are contained in xcat? No. Some are constant...</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>  <span class="n">logtk</span><span class="p">[</span><span class="n">bn</span><span class="o">.</span><span class="n">dim_d</span><span class="p">:]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logkbind</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>  <span class="n">logxbind</span><span class="o">=</span><span class="n">bn</span><span class="o">.</span><span class="n">tk2x_num</span><span class="p">(</span><span class="n">logtk</span><span class="p">,</span> <span class="n">a_mat</span><span class="o">=</span><span class="n">a_mat</span><span class="p">)</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>  <span class="c1"># print(&#39;logxbind&#39;, logxbind)</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>  <span class="n">vcat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kcat</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="mi">10</span><span class="o">**</span><span class="n">logxbind</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_active_in_xbind_idx</span><span class="p">]</span>  <span class="c1"># 2024/08/08 added transposition of kcat</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>  <span class="n">vcat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">vcat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 2024/08/08 added</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a>  <span class="n">new_logxcat</span> <span class="o">=</span> <span class="p">(</span><span class="n">cn</span><span class="o">.</span><span class="n">s_mat</span><span class="nd">@vcat</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="n">logxcat</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># divide by xcat so that this kinetics of logxcat.</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a>  <span class="k">return</span> <span class="n">new_logxcat</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="bcn.catalysis_network.catalysis_network" class="doc doc-heading">
            <code>catalysis_network</code>


</h2>


    <div class="doc doc-contents ">








              <details class="quote">
                <summary>Source code in <code>src/bcn/catalysis_network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">catalysis_network</span><span class="p">:</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a>            <span class="n">s_mat</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a>            <span class="n">xcat_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a>            <span class="n">vcat_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Initiate a catalysis_network object.</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Args:</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        s_mat (numpy array): The stoichiometry matrix defining the catalysis network. Shape is (n_cat, m_cat).</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            Not necessarily full rank.</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            n_cat is the number of rows, i.e. the number of variables for catalysis dynamics, same as length of xcat.</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">            m_cat is the number of columns, i.e. the number of catalysis reactions, same as length of kcat.</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        xcat_sym (numpy array of sympy symbols, optional): Symbols for xcat variables. Length n_cat.</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        vcat_sym (numpy array of sympy symbols, optional): Symbols for vcat variables, fluxes of catalysis reactions. Length m_cat.</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">s_mat</span><span class="o">=</span><span class="n">s_mat</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dim_ncat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_mcat</span><span class="o">=</span><span class="n">s_mat</span><span class="o">.</span><span class="n">shape</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="bcn.catalysis_network.catalysis_network.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">s_mat</span><span class="p">,</span> <span class="n">xcat_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">vcat_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initiate a catalysis_network object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>s_mat</code>
            </td>
            <td>
                  <code>numpy array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The stoichiometry matrix defining the catalysis network. Shape is (n_cat, m_cat).
Not necessarily full rank.
n_cat is the number of rows, i.e. the number of variables for catalysis dynamics, same as length of xcat.
m_cat is the number of columns, i.e. the number of catalysis reactions, same as length of kcat.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xcat_sym</code>
            </td>
            <td>
                  <code>numpy array of sympy symbols</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Symbols for xcat variables. Length n_cat.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vcat_sym</code>
            </td>
            <td>
                  <code>numpy array of sympy symbols</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Symbols for vcat variables, fluxes of catalysis reactions. Length m_cat.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([])</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/bcn/catalysis_network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a>          <span class="n">s_mat</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a>          <span class="n">xcat_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a>          <span class="n">vcat_sym</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">  Initiate a catalysis_network object.</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">  Args:</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">      s_mat (numpy array): The stoichiometry matrix defining the catalysis network. Shape is (n_cat, m_cat).</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">          Not necessarily full rank.</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">          n_cat is the number of rows, i.e. the number of variables for catalysis dynamics, same as length of xcat.</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">          m_cat is the number of columns, i.e. the number of catalysis reactions, same as length of kcat.</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">      xcat_sym (numpy array of sympy symbols, optional): Symbols for xcat variables. Length n_cat.</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">      vcat_sym (numpy array of sympy symbols, optional): Symbols for vcat variables, fluxes of catalysis reactions. Length m_cat.</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">s_mat</span><span class="o">=</span><span class="n">s_mat</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a>  <span class="bp">self</span><span class="o">.</span><span class="n">dim_ncat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_mcat</span><span class="o">=</span><span class="n">s_mat</span><span class="o">.</span><span class="n">shape</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>